// https://hydrogenaud.io/themes/default/portal.js elk_jquery_plugins.js script.js script_elk.js theme.js PersonalMessage.js suggest.js jquery.captcha.js jquery.sceditor.bbcode.min.js jquery.sceditor.elkarte.js post.js splittag.plugin.js undo.plugin.min.js dropAttachments.js
/* SCEditor v1.5.3 | (C) 2017, Sam Clarke | sceditor.com/license */

!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o=n(2),i=n(3),r=n(7),a=n(6);t.sceditor=o,o.commands=n(9),o.defaultOptions=n(10),o.RangeHelper=n(4),o.dom=n(5),o.ie=r.ie,o.ios=r.ios,o.isWysiwygSupported=r.isWysiwygSupported,o.regexEscape=a.regex,o.escapeEntities=a.entities,o.escapeUriScheme=a.uriScheme,o.PluginManager=i,o.plugins=i.plugins,t.fn.sceditor=function(e){var n,i,a=[];if((e=e||{}).runWithoutWysiwygSupport||r.isWysiwygSupported)return this.each(function(){n=this.jquery?this:t(this),i=n.data("sceditor"),n.parents(".sceditor-container").length>0||("state"===e?a.push(!!i):"instance"===e?a.push(i):i||new o(this,e))}),a.length?1===a.length?a[0]:t(a):this}}.call(t,n,t,e))&&(e.exports=o)},function(e,t){e.exports=jQuery},function(e,t,n){var o;void 0!==(o=function(e){"use strict";function t(e,t){var n;a.traverse(e,function(e){a.isInline(e,!0)?(n||(n=t[0].createElement("p"),e.insertBefore(n)),3===e.nodeType&&""===e.nodeValue||e.appendChild(n)):n=null},!1,!0)}var o=n(1),i=n(3),r=n(4),a=n(5),s=n(6),l=n(7),c=n(8),u=window,d=document,f=o(u),p=o(d),h=l.ie,m=h&&h<11,g=/^image\/(p?jpe?g|gif|png|bmp)$/i,v=function(e,n){var b,y,x,w,C,E,k,S,T,N,D,B,O,M,I,R,H,F,z,L,A,W,_,P,j,q,V,$,Q,U,Y,K,X,G,J,Z,ee,te,ne,oe,ie,re,ae,se,le,ce,ue,de,fe,pe,he,me,ge,ve,be,ye,xe,we,Ce,Ee,ke,Se,Te,Ne=this,De=e.get?e.get(0):e,Be=o(De),Oe=[],Me=[],Ie={},Re=[],He={};Ne.commands=o.extend(!0,{},n.commands||v.commands),Ne.opts=n=o.extend({},v.defaultOptions,n),q=function(){Be.data("sceditor",Ne),o.each(n,function(e,t){o.isPlainObject(t)&&(n[e]=o.extend(!0,{},t))}),n.locale&&"en"!==n.locale&&K(),b=o('<div class="sceditor-container" />').insertAfter(Be).css("z-index",n.zIndex),h&&b.addClass("ie ie"+h),L=!!Be.attr("required"),Be.prop("required",!1),Y(),ee(),X(),U(!!n.startInSourceMode),G(),J(),l.isWysiwygSupported||Ne.toggleSourceMode(),pe();var e=function(){f.off("load",e),n.autofocus&&be(),Te(),me(),de(),I.call("ready")};f.on("load",e),d.readyState&&"complete"===d.readyState&&e()},Y=function(){var e=n.plugins;e=e?e.toString().split(","):[],I=new i(Ne),o.each(e,function(e,t){I.register(o.trim(t))})},K=function(){var e;(O=v.locale[n.locale])||(e=n.locale.split("-"),O=v.locale[e[0]]),O&&O.dateFormat&&(n.dateFormat=O.dateFormat)},U=function(e){var t;k=o("<textarea></textarea>"),x=o('<iframe frameborder="0" allowfullscreen="true"></iframe>'),e?(b.addClass("sourceMode"),x.hide()):(b.addClass("wysiwygMode"),k.hide()),n.spellcheck||k.attr("spellcheck","false"),"https:"===u.location.protocol&&x.attr("src","javascript:false"),b.append(x).append(k),w=x[0],S=k[0],Ne.dimensions(n.width||Be.width(),n.height||Be.height()),(t=w.contentDocument).open(),t.write(c("html",{attrs:h?' class="ie ie'+h+'"':"",spellcheck:n.spellcheck?"":'spellcheck="false"',charset:n.charset,style:n.style})),t.close(),E=o(t),C=o(t.body),Ne.readOnly(!!n.readOnly),(l.ios||l.edge||h)&&(C.height("100%"),h||C.on("touchend",Ne.focus));var i=Be.attr("tabindex");k.attr("tabindex",i),x.attr("tabindex",i),M=new r(w.contentWindow),Ne.val(Be.hide().val());var a=n.placeholder||Be.attr("placeholder");a&&(k.placeholder=a,C.attr("placeholder",a))},G=function(){n.autoUpdate&&(C.on("blur",Se),k.on("blur",Se)),null===n.rtl&&(n.rtl="rtl"===k.css("direction")),Ne.rtl(!!n.rtl),n.autoExpand&&(C[0].addEventListener("load",Te,!0),E.on("input keyup",Te)),n.resizeEnabled&&Z(),b.attr("id",n.id),Ne.emoticons(n.emoticonsEnabled)},J=function(){var e="onselectionchange"in E?"selectionchange":"keyup focus blur contextmenu mouseup touchend click";p.click(ue),o(De.form).on("reset",ae).submit(Ne.updateOriginal),f.on("resize orientationChanged",de),C.keypress(re).keydown(oe).keydown(ie).keyup(me).blur(Ee).keyup(ke).on("paste",te).on("compositionstart compositionend",le).on(e,ge).on("keydown keyup keypress focus blur contextmenu",ce),n.emoticonsCompat&&u.getSelection&&C.keyup(xe),C.on("blur",function(){Ne.val()||C.addClass("placeholder")}),C.on("focus",function(){C.removeClass("placeholder")}),k.blur(Ee).keyup(ke).keydown(oe).on("compositionstart compositionend",le).on("keydown keyup keypress focus blur contextmenu",ce),E.mousedown(se).on(e,ge).on("beforedeactivate keyup mouseup",Q).keyup(me).focus(function(){N=null}),b.on("selectionchanged",ve).on("selectionchanged",pe).on("selectionchanged valuechanged nodechanged",ce)},X=function(){var e,t=Ne.commands,i=(n.toolbarExclude||"").split(","),r=n.toolbar.split("|");y=o('<div class="sceditor-toolbar" unselectable="on" />'),o.each(r,function(n,r){e=o('<div class="sceditor-group" />'),o.each(r.split(","),function(n,r){var a,s,l=t[r];!l||o.inArray(r,i)>-1||(s=l.shortcut,(a=c("toolbarButton",{name:r,dispName:Ne._(l.name||l.tooltip||r)},!0)).data("sceditor-txtmode",!!l.txtExec).data("sceditor-wysiwygmode",!!l.exec).toggleClass("disabled",!l.exec).on("mousedown",function(e){var t=o(this);return t.hasClass("disabled")||1!==e.which||$(t,l),pe(),!1}),l.tooltip&&a.attr("title",Ne._(l.tooltip)+(s?" ("+s+")":"")),s&&Ne.addShortcut(s,r),l.state?Me.push({name:r,state:l.state}):"string"==typeof l.exec&&Me.push({name:r,state:l.exec}),e.append(a),He[r]=a)}),e[0].firstChild&&y.append(e)}),o(n.toolbarContainer||b).append(y)},Z=function(){var e,t,i,r,a,s,l=o('<div class="sceditor-grip" />'),c=o('<div class="sceditor-resize-cover" />'),d="touchcancel touchend mouseup",f=0,m=0,g=0,v=0,y=0,x=0,w=b.width(),C=b.height(),E=!1,k=Ne.rtl();e=n.resizeMinHeight||C/1.5,t=n.resizeMaxHeight||2.5*C,i=n.resizeMinWidth||w/1.25,r=n.resizeMaxWidth||1.25*w,a=function(o){"touchmove"===o.type?(o=u.event,g=o.changedTouches[0].pageX,v=o.changedTouches[0].pageY):(g=o.pageX,v=o.pageY);var a=x+(v-m),s=k?y-(g-f):y+(g-f);r>0&&s>r&&(s=r),i>0&&s<i&&(s=i),n.resizeWidth||(s=!1),t>0&&a>t&&(a=t),e>0&&a<e&&(a=e),n.resizeHeight||(a=!1),(s||a)&&(Ne.dimensions(s,a),h<7&&b.height(a)),o.preventDefault()},s=function(e){E&&(E=!1,c.hide(),b.removeClass("resizing").height("auto"),p.off("touchmove mousemove",a),p.off(d,s),e.preventDefault())},b.append(l),b.append(c.hide()),l.on("touchstart mousedown",function(e){"touchstart"===e.type?(e=u.event,f=e.touches[0].pageX,m=e.touches[0].pageY):(f=e.pageX,m=e.pageY),y=b.width(),x=b.height(),E=!0,b.addClass("resizing"),c.show(),p.on("touchmove mousemove",a),p.on(d,s),h<7&&b.height(x),e.preventDefault()})},ee=function(){var e,t=n.emoticons,i=n.emoticonsRoot;o.isPlainObject(t)&&n.emoticonsEnabled&&o.each(t,function(n,r){o.each(r,function(o,r){i&&(r={url:i+(r.url||r),tooltip:r.tooltip||o},t[n][o]=r),(e=d.createElement("img")).src=r.url||r,Oe.push(e)})})},be=function(){var e,t,i=E[0],r=C[0],s=r.firstChild,l=!!n.autofocusEnd;if(b.is(":visible")){if(Ne.sourceMode())return t=l?S.value.length:0,void(S.setSelectionRange?S.setSelectionRange(t,t):((e=S.createTextRange()).moveEnd("character",t),e.collapse(!1),e.select()));if(a.removeWhiteSpace(r),l)for((s=r.lastChild)||(s=i.createElement("p"),C.append(s));s.lastChild;)s=s.lastChild,!m&&o(s).is("br")&&s.previousSibling&&(s=s.previousSibling);i.createRange?(e=i.createRange(),a.canHaveChildren(s)?e.selectNodeContents(s):(e.setStartBefore(s),l&&e.setStartAfter(s))):(e=r.createTextRange()).moveToElementText(3!==s.nodeType?s:s.parentNode),e.collapse(!l),M.selectRange(e),F=e,l&&(E.scrollTop(r.scrollHeight),C.scrollTop(r.scrollHeight)),Ne.focus()}},Ne.readOnly=function(e){return"boolean"!=typeof e?"readonly"===k.attr("readonly"):(C[0].contentEditable=!e,e?k.attr("readonly","readonly"):k.prop("readonly",!1),fe(e),Ne)},Ne.rtl=function(e){var t=e?"rtl":"ltr";return"boolean"!=typeof e?"rtl"===k.attr("dir"):(C.attr("dir",t),k.attr("dir",t),b.removeClass("rtl").removeClass("ltr").addClass(t),Ne)},fe=function(e){var t=Ne.inSourceMode()?"txtmode":"wysiwygmode";o.each(He,function(n,o){!0!==e&&o.data("sceditor-"+t)?o.removeClass("disabled"):o.addClass("disabled")})},Ne.width=function(e,t){return e||0===e?(Ne.dimensions(e,null,t),Ne):b.width()},Ne.dimensions=function(e,t,o){var i=h<8||d.documentMode<8?2:0;return e=!(!e&&0!==e)&&e,t=!(!t&&0!==t)&&t,!1===e&&!1===t?{width:Ne.width(),height:Ne.height()}:(void 0===x.data("outerWidthOffset")&&Ne.updateStyleCache(),!1!==e&&(!1!==o&&(n.width=e),!1===t&&(t=b.height(),o=!1),b.width(e),e&&e.toString().indexOf("%")>-1&&(e=b.width()),x.width(e-x.data("outerWidthOffset")),k.width(e-k.data("outerWidthOffset")),l.ios&&C&&C.width(e-x.data("outerWidthOffset")-(C.outerWidth(!0)-C.width()))),!1!==t&&(!1!==o&&(n.height=t),t&&t.toString().indexOf("%")>-1&&(t=b.height(t).height(),b.height("auto")),t-=n.toolbarContainer?0:y.outerHeight(!0),x.height(t-x.data("outerHeightOffset")),k.height(t-i-k.data("outerHeightOffset"))),Ne)},Ne.updateStyleCache=function(){x.data("outerWidthOffset",x.outerWidth(!0)-x.width()),k.data("outerWidthOffset",k.outerWidth(!0)-k.width()),x.data("outerHeightOffset",x.outerHeight(!0)-x.height()),k.data("outerHeightOffset",k.outerHeight(!0)-k.height())},Ne.height=function(e,t){return e||0===e?(Ne.dimensions(null,e,t),Ne):b.height()},Ne.maximize=function(e){return void 0===e?b.is(".sceditor-maximize"):((e=!!e)&&(P=f.scrollTop()),o("html, body").toggleClass("sceditor-maximize",e),b.toggleClass("sceditor-maximize",e),Ne.width(e?"100%":n.width,!1),Ne.height(e?"100%":n.height,!1),e||f.scrollTop(P),Te(),Ne)},Te=function(){n.autoExpand&&!_&&setTimeout(Ne.expandToContent,200)},Ne.expandToContent=function(e){if(!Ne.maximize()){if(_=!1,!W){var t=n.resizeMinHeight||n.height||Be.height();W={min:t,max:n.resizeMaxHeight||2*t}}var o=document.createRange();o.selectNodeContents(C[0]);var i=o.getBoundingClientRect(),r=E[0].documentElement.clientHeight,a=i.bottom-i.top,s=Ne.height()+(a-r);e||-1===W.max||(s=Math.min(s,W.max)),Ne.height(Math.ceil(Math.max(s,W.min)))}},Ne.destroy=function(){I&&(I.destroy(),M=null,N=null,I=null,T&&T.off().remove(),p.off("click",ue),f.off("resize orientationChanged",de),o(De.form).off("reset",ae).off("submit",Ne.updateOriginal),C.off(),E.off().find("*").remove(),k.off().remove(),y.remove(),b.off().find("*").off().remove(),b.remove(),Be.removeData("sceditor").removeData("sceditorbbcode").show(),L&&Be.attr("required","required"))},Ne.createDropDown=function(e,t,i,r){var a,s="sceditor-"+t,l=T&&T.is("."+s);Ne.closeDropDown(!0),l||(!1!==r&&o(i).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"),a={top:e.offset().top,left:e.offset().left,marginTop:e.outerHeight()},o.extend(a,n.dropDownCss),T=o('<div class="sceditor-dropdown '+s+'" />').css(a).append(i).appendTo(o("body")).on("click focusin",function(e){e.stopPropagation()}),setTimeout(function(){T&&T.find("input,textarea").first().focus()}))},ue=function(e){3!==e.which&&T&&(Se(),void 0===o(e.target).parent().data("sceditorCommand")&&Ne.closeDropDown())},te=function(e){var t=h||l.edge,n=C[0],o=e.originalEvent.clipboardData;if(o&&!t){var i={},r=o.types,a=o.items;e.preventDefault();for(var s=0;s<r.length;s++){if(window.FileReader&&a&&g.test(a[s].type))return function(e){var t=new FileReader;t.onload=function(e){ne({html:'<img src="'+e.target.result+'" />'})},t.readAsDataURL(e)}(o.items[s].getAsFile());i[r[s]]=o.getData(r[s])}i.text=i["text/plain"],i.html=i["text/html"],ne(i)}else if(!j){var c=n.scrollTop;for(M.saveRange(),j=document.createDocumentFragment();n.firstChild;)j.appendChild(n.firstChild);setTimeout(function(){var e=n.innerHTML;n.innerHTML="",n.appendChild(j),n.scrollTop=c,j=!1,M.restoreRange(),ne({html:e})},0)}},ne=function(e){var t=E[0].createElement("div");I.call("pasteRaw",e),e.html?(t.innerHTML=e.html,a.fixNesting(t)):t.innerHTML=s.entities(e.text||"");var n={val:t.innerHTML};I.hasHandler("toSource")&&(C.append(t),n.val=I.callOnlyFirst("toSource",n.val,o(t)),o(t).remove()),I.call("paste",n),I.hasHandler("toWysiwyg")&&(n.val=I.callOnlyFirst("toWysiwyg",n.val,!0)),I.call("pasteHtml",n),Ne.wysiwygEditorInsertHtml(n.val,null,!0)},Ne.closeDropDown=function(e){T&&(T.off().remove(),T=null),!0===e&&Ne.focus()},Ne.wysiwygEditorInsertHtml=function(e,t,n){var i,r,s,l=x.height();Ne.focus(),(n||!o(H).is("code")&&0===o(H).parents("code").length)&&(M.insertHTML(e,t),M.saveRange(),V(C[0]),i=C.find("#sceditor-end-marker").show(),r=C.scrollTop()||E.scrollTop(),s=a.getOffset(i[0]).top+1.5*i.outerHeight(!0)-l,i.hide(),(s>r||s+l<r)&&(C.scrollTop(s),E.scrollTop(s)),Ce(!1),M.restoreRange(),me())},Ne.wysiwygEditorInsertText=function(e,t){Ne.wysiwygEditorInsertHtml(s.entities(e),s.entities(t))},Ne.insertText=function(e,t){return Ne.inSourceMode()?Ne.sourceEditorInsertText(e,t):Ne.wysiwygEditorInsertText(e,t),Ne},Ne.sourceEditorInsertText=function(e,t){var n,o,i,r=S.selectionStart,a=S.selectionEnd;o=S.scrollTop,S.focus(),void 0!==r?(i=S.value,t&&(e+=i.substring(r,a)+t),S.value=i.substring(0,r)+e+i.substring(a,i.length),S.selectionStart=r+e.length-(t?t.length:0),S.selectionEnd=S.selectionStart):(n=d.selection.createRange(),t&&(e+=n.text+t),n.text=e,t&&n.moveEnd("character",0-t.length),n.moveStart("character",n.End-n.Start),n.select()),S.scrollTop=o,S.focus(),Ce()},Ne.getRangeHelper=function(){return M},Ne.sourceEditorCaret=function(e){var t={};return S.focus(),e?(S.selectionStart=e.start,S.selectionEnd=e.end):(t.start=S.selectionStart,t.end=S.selectionEnd),e?this:t},Ne.val=function(e,t){return"string"!=typeof e?Ne.inSourceMode()?Ne.getSourceEditorValue(!1):Ne.getWysiwygEditorValue(t):(Ne.inSourceMode()?Ne.setSourceEditorValue(e):(!1!==t&&I.hasHandler("toWysiwyg")&&(e=I.callOnlyFirst("toWysiwyg",e)),Ne.setWysiwygEditorValue(e)),Ne)},Ne.insert=function(e,t,n,i,r){if(Ne.inSourceMode())return Ne.sourceEditorInsertText(e,t),Ne;if(t){var a=M.selectedHtml(),s=o("<div>").appendTo(o("body")).hide().html(a);!1!==n&&I.hasHandler("toSource")&&(a=I.callOnlyFirst("toSource",a,s)),s.remove(),e+=a+t}return!1!==n&&I.hasHandler("toWysiwyg")&&(e=I.callOnlyFirst("toWysiwyg",e,!0)),!1!==n&&!0===r&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),Ne.wysiwygEditorInsertHtml(e),Ne},Ne.getWysiwygEditorValue=function(e){var t,n=o("<div>",E[0]).append(o(C[0].childNodes).clone()).appendTo(C);return a.fixNesting(n[0]),t=n.html(),!1!==e&&I.hasHandler("toSource")&&(t=I.callOnlyFirst("toSource",t,n)),n.remove(),t},Ne.getBody=function(){return C},Ne.getContentAreaContainer=function(){return x},Ne.getSourceEditorValue=function(e){var t=k.val();return!1!==e&&I.hasHandler("toWysiwyg")&&(t=I.callOnlyFirst("toWysiwyg",t)),t},Ne.setWysiwygEditorValue=function(e){e||(e="<p>"+(h?"":"<br />")+"</p>"),C[0].innerHTML=e,V(C[0]),me(),Ce(),Te()},Ne.setSourceEditorValue=function(e){k.val(e),Ce()},Ne.updateOriginal=function(){Be.val(Ne.val())},V=function(e){if(n.emoticonsEnabled&&!o(e).parents("code").length){var t=e.ownerDocument,i=[],r={},l=o.extend({},n.emoticons.more,n.emoticons.dropdown,n.emoticons.hidden);o.each(l,function(e){n.emoticonsCompat&&(r[e]=new RegExp("(>|^|\\s| | | | |&nbsp;)"+s.regex(e)+"($|<|\\s| | | | |&nbsp;)")),i.push(e)}),i.sort(function(e,t){return e.length-t.length});var u=function(e){for(e=e.firstChild;e;){var s,d,f,p,h,m,g,v=e.parentNode,b=e.nodeValue;if(3!==e.nodeType)o(e).is("code")||u(e);else if(b)for(h=i.length;h--;)d=i[h],(g=n.emoticonsCompat?b.search(r[d]):b.indexOf(d))>-1&&(m=e.nextSibling,f=l[d],s=b.substr(g).split(d),b=b.substr(0,g)+s.shift(),e.nodeValue=b,p=a.parseHTML(c("emoticon",{key:d,url:f.url||f,tooltip:f.tooltip||d}),t),v.insertBefore(p[0],m),v.insertBefore(t.createTextNode(s.join(d)),m));e=e.nextSibling}};u(e),n.emoticonsCompat&&(Re=C.find("img[data-sceditor-emoticon]"))}},Ne.inSourceMode=function(){return b.hasClass("sourceMode")},Ne.sourceMode=function(e){var t=Ne.inSourceMode();return"boolean"!=typeof e?t:((t&&!e||!t&&e)&&Ne.toggleSourceMode(),Ne)},Ne.toggleSourceMode=function(){var e=Ne.inSourceMode();!l.isWysiwygSupported&&e||(e||(M.saveRange(),M.clear()),Ne.blur(),e?Ne.setWysiwygEditorValue(Ne.getSourceEditorValue()):Ne.setSourceEditorValue(Ne.getWysiwygEditorValue()),N=null,k.toggle(),x.toggle(),b.toggleClass("wysiwygMode",e).toggleClass("sourceMode",!e),fe(),pe())},he=function(){return S.focus(),void 0!==S.selectionStart?S.value.substring(S.selectionStart,S.selectionEnd):d.selection.createRange().text},$=function(e,t){Ne.inSourceMode()?t.txtExec&&(o.isArray(t.txtExec)?Ne.sourceEditorInsertText.apply(Ne,t.txtExec):t.txtExec.call(Ne,e,he())):t.exec&&(o.isFunction(t.exec)?t.exec.call(Ne,e):Ne.execCommand(t.exec,t.hasOwnProperty("execParam")?t.execParam:null))},Q=function(){h&&(N=M.selectedRange())},Ne.execCommand=function(e,t){var n=!1,i=Ne.commands[e],r=o(M.parentNode());if(Ne.focus(),!r.is("code")&&0===r.parents("code").length){try{n=E[0].execCommand(e,!1,t)}catch(e){}!n&&i&&i.errorMessage&&alert(Ne._(i.errorMessage)),pe()}},ge=function(){function e(){if(M&&!M.compare(F)){if((F=M.cloneSelected())&&F.collapsed){var e=F.startContainer,n=F.startOffset;for(n&&3!==e.nodeType&&(e=e.childNodes[n]);e&&e.parentNode!==C;)e=e.parentNode;e&&a.isInline(e,!0)&&(M.saveRange(),t(C,E),M.restoreRange())}b.trigger(o.Event("selectionchanged"))}z=!1}z||(z=!0,"onselectionchange"in E?e():setTimeout(e,100))},ve=function(){var e,t=M.parentNode();R!==t&&(e=R,R=t,H=M.getFirstBlockParent(t),b.trigger(o.Event("nodechanged",{oldNode:e,newNode:R})))},Ne.currentNode=function(){return R},Ne.currentBlockNode=function(){return H},pe=function(e){var t,n,o=E[0],i=Ne.sourceMode();if(Ne.readOnly())y.find("active").removeClass("active");else{i||(n=e?e.newNode:M.parentNode(),t=M.getFirstBlockParent(n));for(var r=0;r<Me.length;r++){var a=0,s=He[Me[r].name],l=Me[r].state,c=i&&!s.data("sceditor-txtmode")||!i&&!s.data("sceditor-wysiwygmode");if("string"==typeof l){if(!i)try{(a=o.queryCommandEnabled(l)?0:-1)>-1&&(a=o.queryCommandState(l)?1:0)}catch(e){}}else c||(a=l.call(Ne,n,t));s.toggleClass("disabled",c||a<0).toggleClass("active",a>0)}}},re=function(e){if(!e.originalEvent.defaultPrevented&&(Ne.closeDropDown(),13===e.which)){var t=o(H);if(t.length&&!t.is("li,ul,ol")){N=null;var n=E[0].createElement("br");if(M.insertNode(n),!m){var i=n.parentNode,r=i.lastChild;r&&3===r.nodeType&&""===r.nodeValue&&(i.removeChild(r),r=i.lastChild),!a.isInline(i,!0)&&r===n&&a.isInline(n.previousSibling)&&M.insertHTML("<br>")}e.preventDefault()}}},me=function(){var e,t=C[0];a.rTraverse(t,function(n){if(e=n.nodeName.toLowerCase(),1===n.nodeType&&!/inline/.test(a.getStyle(n,"display"))&&o(n).hasClass("sceditor-nlf")&&a.hasStyling(n)){var i=E[0].createElement("p");return i.className="sceditor-nlf",i.innerHTML=m?"":"<br />",t.appendChild(i),!1}if(3===n.nodeType&&!/^\s*$/.test(n.nodeValue)||"br"===e)return!1})},ae=function(){Ne.val(Be.val())},se=function(){Ne.closeDropDown(),N=null},de=function(){var e=n.height,t=n.width;Ne.maximize()?Ne.dimensions("100%","100%",!1):(e&&e.toString().indexOf("%")>-1||t&&t.toString().indexOf("%")>-1)&&Ne.dimensions(t,e)},Ne._=function(){var e=arguments;return O&&O[e[0]]&&(e[0]=O[e[0]]),e[0].replace(/\{(\d+)\}/g,function(t,n){return void 0!==e[n-0+1]?e[n-0+1]:"{"+n+"}"})},ce=function(e){I.call(e.type+"Event",e,Ne);var t=e.target===S?"scesrc":"scewys",n=o.Event(e);n.type=t+e.type,b.trigger(n,Ne)},Ne.bind=function(e,t,n,i){for(var r=(e=e.split(" ")).length;r--;)o.isFunction(t)&&(n||b.on("scewys"+e[r],t),i||b.on("scesrc"+e[r],t),"valuechanged"===e[r]&&(Ce.hasHandler=!0));return Ne},Ne.unbind=function(e,t,n,i){for(var r=(e=e.split(" ")).length;r--;)o.isFunction(t)&&(n||b.off("scewys"+e[r],t),i||b.off("scesrc"+e[r],t));return Ne},Ne.blur=function(e,t,n){return o.isFunction(e)?Ne.bind("blur",e,t,n):Ne.sourceMode()?k.blur():C.blur(),Ne},Ne.focus=function(e,t,n){if(o.isFunction(e))Ne.bind("focus",e,t,n);else if(Ne.inSourceMode())S.focus();else{var i,r=M.selectedRange();F||be(),!m&&r&&1===r.endOffset&&r.collapsed&&(i=r.endContainer)&&1===i.childNodes.length&&o(i.firstChild).is("br")&&(r.setStartBefore(i.firstChild),r.collapse(!0),M.selectRange(r)),w.contentWindow.focus(),C[0].focus(),N&&(M.selectRange(N),N=null)}return pe(),Ne},Ne.keyDown=function(e,t,n){return Ne.bind("keydown",e,t,n)},Ne.keyPress=function(e,t,n){return Ne.bind("keypress",e,t,n)},Ne.keyUp=function(e,t,n){return Ne.bind("keyup",e,t,n)},Ne.nodeChanged=function(e){return Ne.bind("nodechanged",e,!1,!0)},Ne.selectionChanged=function(e){return Ne.bind("selectionchanged",e,!1,!0)},Ne.valueChanged=function(e,t,n){return Ne.bind("valuechanged",e,t,n)},ye=function(e){var t,i=0,r=Ne.emoticonsCache,a=String.fromCharCode(e.which);if(!o(H).is("code")&&!o(H).parents("code").length)return r||(r=[],o.each(o.extend({},n.emoticons.more,n.emoticons.dropdown,n.emoticons.hidden),function(e,t){r[i++]=[e,c("emoticon",{key:e,url:t.url||t,tooltip:t.tooltip||e})]}),r.sort(function(e,t){return e[0].length-t[0].length}),Ne.emoticonsCache=r,Ne.longestEmoticonCode=r[r.length-1][0].length),t=M.replaceKeyword(Ne.emoticonsCache,!0,!0,Ne.longestEmoticonCode,n.emoticonsCompat,a),t&&n.emoticonsCompat?(Re=C.find("img[data-sceditor-emoticon]"),/^\s$/.test(a)):!t},xe=function(){if(Re.length){var e,t,n,i,r,a,s=Ne.currentBlockNode(),l=!1,c=/[^\s\xA0\u2002\u2003\u2009\u00a0]+/;Re=o.map(Re,function(u){return u&&u.parentNode?o.contains(s,u)?(e=u.previousSibling,t=u.nextSibling,null===(r=e.nodeValue)&&(r=e.innerText||""),e&&c.test(e.nodeValue.slice(-1))||t&&c.test((t.nodeValue||"")[0])?(n=u.parentNode,i=M.cloneSelected(),a=i.startContainer,r+=o(u).data("sceditor-emoticon"),a===t?l=r.length+i.startOffset:a===s&&s.childNodes[i.startOffset]===t?l=r.length:a===e&&(l=i.startOffset),t&&3===t.nodeType||(t=n.insertBefore(n.ownerDocument.createTextNode(""),t)),t.insertData(0,r),n.removeChild(e),n.removeChild(u),!1!==l&&(i.setStart(t,l),i.collapse(!0),M.selectRange(i)),null):u):u:null})}},Ne.emoticons=function(e){return e||!1===e?(n.emoticonsEnabled=e,e?(C.keypress(ye),Ne.sourceMode()||(M.saveRange(),V(C[0]),Re=C.find("img[data-sceditor-emoticon]"),Ce(!1),M.restoreRange())):(C.find("img[data-sceditor-emoticon]").replaceWith(function(){return o(this).data("sceditor-emoticon")}),Re=[],C.off("keypress",ye),Ce()),Ne):n.emoticonsEnabled},Ne.css=function(e){return A||(A=o('<style id="#inline" />',E[0]).appendTo(E.find("head"))[0]),"string"!=typeof e?A.styleSheet?A.styleSheet.cssText:A.innerHTML:(A.styleSheet?A.styleSheet.cssText=e:A.innerHTML=e,Ne)},oe=function(e){var t=[],n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},o={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},r=e.which,a=o[r]||String.fromCharCode(r).toLowerCase();if((e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&(t.push("shift"),i[r]?a=i[r]:n[a]&&(a=n[a])),a&&(r<16||r>18)&&t.push(a),t=t.join("+"),Ie[t])return Ie[t].call(Ne)},Ne.addShortcut=function(e,t){return e=e.toLowerCase(),Ie[e]="string"==typeof t?function(){return $(He[t],Ne.commands[t]),!1}:t,Ne},Ne.removeShortcut=function(e){return delete Ie[e.toLowerCase()],Ne},ie=function(e){var t,i,r,a,s;if(!n.disableBlockRemove&&8===e.which&&(a=M.selectedRange())&&(u.getSelection?(t=a.startContainer,i=a.startOffset):(t=a.parentElement(),(r=E[0].selection.createRange()).moveToElementText(t),r.setEndPoint("EndToStart",a),i=r.text.length),0===i&&(s=we()))){for(;t!==s;){for(;t.previousSibling;)if(3!==(t=t.previousSibling).nodeType||t.nodeValue)return;if(!(t=t.parentNode))return}if(s&&!o(s).is("body"))return Ne.clearBlockFormatting(s),!1}},we=function(){for(var e=H;!a.hasStyling(e)||a.isInline(e,!0);)if(!(e=e.parentNode)||o(e).is("body"))return;return e},Ne.clearBlockFormatting=function(e){return!(e=e||we())||o(e).is("body")?Ne:(M.saveRange(),e.className="",N=null,o(e).attr("style",""),o(e).is("p,div,td")||a.convertElement(e,"p"),M.restoreRange(),Ne)},Ce=function(e){if(I&&(I.hasHandler("valuechangedEvent")||Ce.hasHandler)){var t,n=Ne.sourceMode(),i=!n&&M.hasSelection();D=!1,e=!1!==e&&!E[0].getElementById("sceditor-start-marker"),B&&(clearTimeout(B),B=!1),i&&e&&M.saveRange(),(t=n?k.val():C.html())!==Ce.lastVal&&(Ce.lastVal=t,b.trigger(o.Event("valuechanged",{rawValue:n?Ne.val():t}))),i&&e&&M.removeMarkers()}},Ee=function(){B&&Ce()},ke=function(e){var t=e.which,n=ke.lastChar,o=13===n||32===n,i=8===n||46===n;ke.lastChar=t,D||(13===t||32===t?o?ke.triggerNext=!0:Ce():8===t||46===t?i?ke.triggerNext=!0:Ce():ke.triggerNext&&(Ce(),ke.triggerNext=!1),B&&clearTimeout(B),B=setTimeout(function(){D||Ce()},1500))},le=function(e){(D=/start/i.test(e.type))||Ce()},Se=function(){Ne.updateOriginal()},q()};return v.locale={},v.command={get:function(e){return v.commands[e]||null},set:function(e,t){return!(!e||!t)&&(t=o.extend(v.commands[e]||{},t),t.remove=function(){v.command.remove(e)},v.commands[e]=t,this)},remove:function(e){return v.commands[e]&&delete v.commands[e],this}},v}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(){"use strict";var e={},t=function(t){var n=this,o=[],i=function(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)},r=function(e,n){e=[].slice.call(e);var r,a,s=i(e.shift());for(r=0;r<o.length;r++)if(s in o[r]&&(a=o[r][s].apply(t,e),n))return a};n.call=function(){r(arguments,!1)},n.callOnlyFirst=function(){return r(arguments,!0)},n.hasHandler=function(e){var t=o.length;for(e=i(e);t--;)if(e in o[t])return!0;return!1},n.exists=function(t){return t in e&&"function"==typeof(t=e[t])&&"object"==typeof t.prototype},n.isRegistered=function(t){if(n.exists(t))for(var i=o.length;i--;)if(o[i]instanceof e[t])return!0;return!1},n.register=function(i){return!(!n.exists(i)||n.isRegistered(i)||(i=new e[i],o.push(i),"init"in i&&i.init.call(t),0))},n.deregister=function(i){var r,a=o.length,s=!1;if(!n.isRegistered(i))return s;for(;a--;)o[a]instanceof e[i]&&(s=!0,"destroy"in(r=o.splice(a,1)[0])&&r.destroy.call(t));return s},n.destroy=function(){for(var e=o.length;e--;)"destroy"in o[e]&&o[e].destroy.call(t);o=[],t=null}};return t.plugins=e,t}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o=n(5),i=n(6),r=n(7).ie,a=r&&r<11,s=function(e,t,n){var o,i,r,a,s,l="",c=e.startContainer,u=e.startOffset;for(c&&3!==c.nodeType&&(c=c.childNodes[u],u=0),r=a=u;n>l.length&&c&&3===c.nodeType;)o=c.nodeValue,i=n-l.length,s&&(a=o.length,r=0),s=c,t?(u=r=Math.max(a-i,0),l=o.substr(r,a-r)+l,c=s.previousSibling):(u=r+(a=Math.min(i,o.length)),l+=o.substr(r,a),c=s.nextSibling);return{node:s||c,offset:u,text:l}};return function(e,n){var r,l,c=n||e.contentDocument||e.document,u="sceditor-start-marker",d="sceditor-end-marker",f=this;f.insertHTML=function(e,t){var n,o;if(!f.selectedRange())return!1;for(t&&(e+=f.selectedHtml()+t),o=c.createElement("p"),n=c.createDocumentFragment(),o.innerHTML=e;o.firstChild;)n.appendChild(o.firstChild);f.insertNode(n)},l=function(e,n,i){var a,s,l=c.createElement("div"),p=t(l);if("string"==typeof e?(n&&(e+=f.selectedHtml()+n),p.html(e)):(p.append(e),n&&p.append(f.selectedRange().extractContents()).append(n)),a=l.lastChild){for(;!o.isInline(a.lastChild,!0);)a=a.lastChild;return o.canHaveChildren(a)&&(s=t(a),a.lastChild||s.append("​")),f.removeMarkers(),(s||p).append(r(u)).append(r(d)),i?p.html():t(c.createDocumentFragment()).append(p.contents())[0]}},f.insertNode=function(e,t){var n=l(e,t),i=f.selectedRange(),r=i.commonAncestorContainer;if(!n)return!1;i.deleteContents(),r&&3!==r.nodeType&&!o.canHaveChildren(r)?r.parentNode.insertBefore(n,r):i.insertNode(n),f.restoreRange()},f.cloneSelected=function(){var e=f.selectedRange();if(e)return e.cloneRange()},f.selectedRange=function(){var t,n,o=e.getSelection();if(o){if(o.getRangeAt&&o.rangeCount<=0){for(n=c.body;n.firstChild;)n=n.firstChild;(t=c.createRange()).setStartBefore(n),o.addRange(t)}return o.rangeCount>0&&(t=o.getRangeAt(0)),t}},f.hasSelection=function(){var t=e.getSelection();return t&&t.rangeCount>0},f.selectedHtml=function(){var e,t=f.selectedRange();return t?((e=c.createElement("p")).appendChild(t.cloneContents()),e.innerHTML):""},f.parentNode=function(){var e=f.selectedRange();if(e)return e.parentElement?e.parentElement():e.commonAncestorContainer},f.getFirstBlockParent=function(e){var t=function(e){return o.isInline(e,!0)?(e=e?e.parentNode:null,e?t(e):e):e};return t(e||f.parentNode())},f.insertNodeAt=function(e,t){var n=f.selectedRange(),o=f.cloneSelected();if(!o)return!1;o.collapse(e),o.insertNode(t),f.selectRange(n)},r=function(e){f.removeMarker(e);var t=c.createElement("span");return t.id=e,t.style.lineHeight="0",t.style.display="none",t.className="sceditor-selection sceditor-ignore",t.innerHTML=" ",t},f.insertMarkers=function(){var e=f.selectedRange();f.insertNodeAt(!0,r(u)),e&&e.collapsed?t(f.getMarker(u)).after(r(d)):f.insertNodeAt(!1,r(d))},f.getMarker=function(e){return c.getElementById(e)},f.removeMarker=function(e){var t=f.getMarker(e);t&&t.parentNode.removeChild(t)},f.removeMarkers=function(){f.removeMarker(u),f.removeMarker(d)},f.saveRange=function(){f.insertMarkers()},f.selectRange=function(n){var i,r=e.getSelection(),s=n.endContainer;if(!a&&n.collapsed&&s&&!o.isInline(s,!0)){for(i=s.lastChild;i&&t(i).is(".sceditor-ignore");)i=i.previousSibling;if(t(i).is("br")){var l=c.createRange();l.setEndAfter(i),l.collapse(!1),f.compare(n,l)&&(n.setStartBefore(i),n.collapse(!0))}}r&&(f.clear(),r.addRange(n))},f.restoreRange=function(){var e,t=f.selectedRange(),n=f.getMarker(u),o=f.getMarker(d);if(!n||!o||!t)return!1;e=n.nextSibling===o,(t=c.createRange()).setStartBefore(n),t.setEndAfter(o),e&&t.collapse(!0),f.selectRange(t),f.removeMarkers()},f.selectOuterText=function(e,t){var n,o,i=f.cloneSelected();if(!i)return!1;i.collapse(!1),n=s(i,!0,e),o=s(i,!1,t),i.setStart(n.node,n.offset),i.setEnd(o.node,o.offset),f.selectRange(i)},f.getOuterText=function(e,t){var n=f.cloneSelected();return n?(n.collapse(!e),s(n,e,t).text):""},f.replaceKeyword=function(e,t,n,o,r,a){n||e.sort(function(e,t){return e[0].length-t[0].length});var s,l,c,u,d,p,h,m,g=e.length,v=r?1:0,b=o||e[g-1][0].length;for(r&&b++,a=a||"",d=(s=f.getOuterText(!0,b)).length,s+=a,t&&(s+=f.getOuterText(!1,b));g--;)if(h=e[g][0],m=h.length,u=Math.max(0,d-m-v),c=-1,r?(l=s.substr(u).match(new RegExp("(^|[\\s    ])"+i.regex(h)+"(^|[\\s    ])")))&&(c=l.index+u+l[1].length):c=s.indexOf(h,u),c>-1&&c<=d&&c+m+v>=d)return p=d-c,f.selectOuterText(p,m-p-(/^\S/.test(a)?1:0)),f.insertHTML(e[g][1]),!0;return!1},f.compare=function(e,t){return t||(t=f.selectedRange()),e&&t?0===e.compareBoundaryPoints(Range.END_TO_END,t)&&0===e.compareBoundaryPoints(Range.START_TO_START,t):!e&&!t},f.clear=function(){var t=e.getSelection();t&&(t.removeAllRanges?t.removeAllRanges():t.empty&&t.empty())}}}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o={},i={traverse:function(e,t,n,o,r){if(e)for(e=r?e.lastChild:e.firstChild;e;){var a=r?e.previousSibling:e.nextSibling;if(!n&&!1===t(e)||!o&&!1===i.traverse(e,t,n,o,r)||n&&!1===t(e))return!1;e=a}},rTraverse:function(e,t,n,o){this.traverse(e,t,n,o,!0)},parseHTML:function(e,n){var o=[],i=(n||document).createElement("div");return i.innerHTML=e,t.merge(o,i.childNodes),o},hasStyling:function(e){var n=t(e);return e&&(!n.is("p,div")||e.className||n.attr("style")||!t.isEmptyObject(n.data()))},convertElement:function(e,t){for(var n,o,i=e.attributes,r=i.length,a=e.ownerDocument.createElement(t);r--;){o=i[r];try{a.setAttribute(o.name,o.value)}catch(e){}}for(;n=e.firstChild;)a.appendChild(n);return e.parentNode.replaceChild(a,e),a},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",canHaveChildren:function(e){return!!/11?|9/.test(e.nodeType)&&"|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf("|"+e.nodeName.toLowerCase()+"|")<0},isInline:function(e,t){var n,o=(e||{}).nodeType||3;return 1!==o?3===o:(n=e.tagName.toLowerCase(),"code"===n?!t:i.blockLevelList.indexOf("|"+n+"|")<0)},copyCSS:function(e,t){t.style.cssText=e.style.cssText+t.style.cssText},fixNesting:function(e){var n=function(e){for(;i.isInline(e.parentNode,!0);)e=e.parentNode;return e};i.traverse(e,function(e){var o=!i.isInline(e,!0),r=t(e);if(o&&i.isInline(e.parentNode,!0)){var a=n(e),s=a.parentNode,l=i.extractContents(a,e),c=e;i.copyCSS(a,c),s.insertBefore(l,a),s.insertBefore(c,a)}if(o&&r.is("ul,ol")&&r.parent().is("ul,ol")){var u=r.prev("li");u.length?u.append(r):r.wrap("<li />")}})},findCommonAncestor:function(e,n){return t(e).parents().has(t(n)).first()},getSibling:function(e,t){return e?(t?e.previousSibling:e.nextSibling)||i.getSibling(e.parentNode,t):null},removeWhiteSpace:function(e,n){for(var o,r,a,s,l,c,u,d,f=i.getSibling,p=i.isInline,h=e.firstChild;h;){if(u=h.nextSibling,o=h.nodeValue,1===(r=h.nodeType)&&h.firstChild&&(c=t(h).css("whiteSpace"),/pre(\-wrap)?$/i.test(c)||i.removeWhiteSpace(h,/line$/i.test(c))),3===r){for(a=f(h),s=f(h,!0),d=!1;t(s).hasClass("sceditor-ignore");)s=f(s,!0);if(p(h)&&s){for(l=s;l.lastChild;)l=l.lastChild;d=3===l.nodeType?/[\t\n\r ]$/.test(l.nodeValue):!p(l)}o=o.replace(/\u200B/g,""),s&&p(s)&&!d||(o=o.replace(n?/^[\t ]+/:/^[\t\n\r ]+/,"")),a&&p(a)||(o=o.replace(n?/[\t ]+$/:/[\t\n\r ]+$/,"")),o.length?h.nodeValue=o.replace(n?/[\t ]+/g:/[\t\n\r ]+/g," "):e.removeChild(h)}h=u}},extractContents:function(e,n){var o,r=i.findCommonAncestor(e,n).get(0),a=!1,s=!1;return(o=function(r){var l,c=e.ownerDocument.createDocumentFragment();return i.traverse(r,function(i){if(s||i===n)return s=!0,!1;i===e&&(a=!0),t.contains(i,e)||a&&t.contains(i,n)?((l=i.cloneNode(!1)).appendChild(o(i)),c.appendChild(l)):a&&!t.contains(c,i)&&c.appendChild(i)},!1),c})(r)},getOffset:function(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},getStyle:function(e,n){var i,r,a,s=e.style;if(!s)return"";if(o[n]||(o[n]=t.camelCase(n)),n=o[n],a=s[n],"textAlign"===n){if(i=t(e),r=s.direction,a=a||i.css(n),i.parent().css(n)===a||"block"!==i.css("display")||i.is("hr")||i.is("th"))return"";if(/right/i.test(a)&&"rtl"===r||/left/i.test(a)&&"ltr"===r)return""}return a},hasStyle:function(e,n,o){var r=i.getStyle(e,n);return!!r&&(!o||r===o||t.isArray(o)&&t.inArray(r,o)>-1)}};return i}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e,t){"use strict";var n=/^(https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(\/\/)|data:image\/(png|bmp|gif|p?jpe?g);/i;t.regex=function(e){return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},t.entities=function(e,t){if(!e)return e;var n={"&":"&amp;","<":"&lt;",">":"&gt;","  ":"&nbsp; ","\r\n":"<br />","\r":"<br />","\n":"<br />"};return!1!==t&&(n['"']="&#34;",n["'"]="&#39;",n["`"]="&#96;"),e=e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g,function(e){return n[e]||e})},t.uriScheme=function(e){var t,o=/^[^\/]*:/i,i=window.location;return e&&o.test(e)&&!n.test(e)?((t=i.pathname.split("/")).pop(),i.protocol+"//"+i.host+t.join("/")+"/"+e):e}}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e,t){"use strict";var o=n(1),i=navigator.userAgent;t.ie=function(){var e=3,t=document,n=t.createElement("div"),o=n.getElementsByTagName("i");do{n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(o[0]);return t.documentMode&&t.all&&window.atob&&(e=10),4===e&&t.documentMode&&(e=11),e>4?e:void 0}(),t.edge="-ms-ime-align"in document.documentElement.style,t.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(i),t.isWysiwygSupported=function(){var e,n,r=o('<p contenteditable="true">')[0].contentEditable;return void 0!==r&&"inherit"!==r&&(n=/Opera Mobi|Opera Mini/i.test(i),/Android/i.test(i)&&(n=!0,/Safari/.test(i)&&(n=!(e=/Safari\/(\d+)/.exec(i))||!e[1]||e[1]<534)),/ Silk\//i.test(i)&&(n=!(e=/AppleWebKit\/(\d+)/.exec(i))||!e[1]||e[1]<534),t.ios&&(n=/OS [0-4](_\d)+ like Mac/i.test(i)),/Firefox/i.test(i)&&(n=!1),/OneBrowser/i.test(i)&&(n=!1),"UCWEB"===navigator.vendor&&(n=!1),t.ie<9&&(n=!0),!n)}()}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o={html:'<!DOCTYPE html><html{attrs}><head><style>.ie * {min-height: auto !important} .ie table td {height:15px} @supports (-ms-ime-align:auto) { * { min-height: auto !important; } }</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}><p></p></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" placeholder="https://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" placeholder="https://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" placeholder="https://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" frameborder="0" allowfullscreensrc="https://www.youtube.com/embed/{id}?wmode=opaque&start={time}" data-youtube-id="{id}"></iframe>'};return function(e,n,i){var r=o[e];return t.each(n,function(e,t){r=r.replace(new RegExp("\\{"+e+"\\}","g"),t)}),i&&(r=t(r)),r}}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";function t(e){if("mozHidden"in document)for(var t,n=e.getBody()[0];n;){if((t=n).firstChild)t=t.firstChild;else{for(;t&&!t.nextSibling;)t=t.parentNode;t&&(t=t.nextSibling)}3===n.nodeType&&/[\n\r\t]+/.test(n.nodeValue)&&(/^pre/.test(o(n.parentNode).css("white-space"))||o(n).remove()),n=t}}var o=n(1),i=n(7).ie,r=n(8),a=i&&i<11,s={bold:{exec:"bold",tooltip:"Bold",shortcut:"Ctrl+B"},italic:{exec:"italic",tooltip:"Italic",shortcut:"Ctrl+I"},underline:{exec:"underline",tooltip:"Underline",shortcut:"Ctrl+U"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(e,t,n){for(var i=0,a=e.opts.fonts.split(","),s=o("<div />"),l=function(){return n(o(this).data("font")),e.closeDropDown(!0),!1};i<a.length;i++)s.append(r("fontOpt",{font:a[i]},!0).click(l));e.createDropDown(t,"font-picker",s)},exec:function(e){var t=this;s.font._dropDown(t,e,function(e){t.execCommand("fontname",e)})},tooltip:"Font Name"},size:{_dropDown:function(e,t,n){for(var i=o("<div />"),a=function(t){n(o(this).data("size")),e.closeDropDown(!0),t.preventDefault()},s=1;s<=7;s++)i.append(r("sizeOpt",{size:s},!0).click(a));e.createDropDown(t,"fontsize-picker",i)},exec:function(e){var t=this;s.size._dropDown(t,e,function(e){t.execCommand("fontsize",e)})},tooltip:"Font Size"},color:{_dropDown:function(e,t,n){var i=o("<div />"),r="",a=s.color;a._htmlCache||(e.opts.colors.split("|").forEach(function(e){r+='<div class="sceditor-color-column">',e.split(",").forEach(function(e){r+='<a href="#" class="sceditor-color-option" style="background-color: '+e+'" data-color="'+e+'"></a>'}),r+="</div>"}),a._htmlCache=r),i.html(a._htmlCache).find("a").click(function(t){n(o(this).attr("data-color")),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"color-picker",i)},exec:function(e){var t=this;s.color._dropDown(t,e,function(e){t.execCommand("forecolor",e)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n,o=this;(n=r("pastetext",{label:o._("Paste your text inside the following box:"),insert:o._("Insert")},!0)).find(".button").click(function(e){(t=n.find("#txt").val())&&o.wysiwygEditorInsertText(t),o.closeDropDown(!0),e.preventDefault()}),o.createDropDown(e,"pastetext",n)},tooltip:"Paste Text"},bulletlist:{exec:function(){t(this),this.execCommand("insertunorderedlist")},tooltip:"Bullet list"},orderedlist:{exec:function(){t(this),this.execCommand("insertorderedlist")},tooltip:"Numbered list"},indent:{state:function(e,t){var n,i,r,a=o(t),s=a.parents("ul,ol,menu"),l=s.first();if(s.length>1||l.children().length>1)return 0;if(a.is("ul,ol,menu")){if(n=this.getRangeHelper().selectedRange(),!(window.Range&&n instanceof Range))return a.is("li,ul,ol,menu")?0:-1;if(i=n.startContainer.parentNode,r=n.endContainer.parentNode,i!==i.parentNode.firstElementChild||o(r).is("li")&&r!==r.parentNode.lastElementChild)return 0}return-1},exec:function(){var e=this,t=o(e.getRangeHelper().getFirstBlockParent());e.focus(),t.parents("ul,ol,menu")&&e.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(e,t){return o(t).is("ul,ol,menu")||o(t).parents("ul,ol,menu").length>0?0:-1},exec:function(){var e=this;o(e.getRangeHelper().getFirstBlockParent()).parents("ul,ol,menu")&&e.execCommand("outdent")},tooltip:"Remove one indent"},table:{exec:function(e){var t=this,n=r("table",{rows:t._("Rows:"),cols:t._("Cols:"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o,i,r=n.find("#rows").val()-0,s=n.find("#cols").val()-0,l="<table>";if(!(r<1||s<1)){for(o=0;o<r;o++){for(l+="<tr>",i=0;i<s;i++)l+="<td>"+(a?"":"<br />")+"</td>";l+="</tr>"}l+="</table>",t.wysiwygEditorInsertHtml(l),t.closeDropDown(!0),e.preventDefault()}}),t.createDropDown(e,"inserttable",n)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>",(a?"":"<br />")+"</code>")},tooltip:"Code"},image:{_dropDown:function(e,t,n){var o=r("image",{url:e._("URL:"),width:e._("Width (optional):"),height:e._("Height (optional):"),insert:e._("Insert")},!0),i=o.find("#image");o.find(".button").click(function(t){i.val()&&n(i.val(),o.find("#width").val(),o.find("#height").val()),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertimage",o)},exec:function(e){var t=this;s.image._dropDown(t,e,function(e,n,o){var i="";n&&(i+=' width="'+n+'"'),o&&(i+=' height="'+o+'"'),t.wysiwygEditorInsertHtml("<img"+i+' src="'+e+'" />')})},tooltip:"Insert an image"},email:{_dropDown:function(e,t,n){function o(t){a.val()&&n(a.val(),i.find("#des").val()),e.closeDropDown(!0),t.preventDefault()}var i=r("email",{label:e._("E-mail:"),desc:e._("Description (optional):"),insert:e._("Insert")},!0),a=i.find("#email");i.find(".button").click(o),a.add(i.find("#des")).keypress(function(e){13===e.which&&a.val()&&o(e)}),e.createDropDown(t,"insertemail",i)},exec:function(e){var t=this;s.email._dropDown(t,e,function(e,n){t.focus(),!t.getRangeHelper().selectedHtml()||n?t.wysiwygEditorInsertHtml('<a href="mailto:'+e+'">'+(n||e)+"</a>"):t.execCommand("createlink","mailto:"+e)})},tooltip:"Insert an email"},link:{_dropDown:function(e,t,n){function o(t){a.val()&&n(a.val(),i.find("#des").val()),e.closeDropDown(!0),t.preventDefault()}var i=r("link",{url:e._("URL:"),desc:e._("Description (optional):"),ins:e._("Insert")},!0),a=i.find("#link");i.find(".button").click(o),a.add(i.find("#des")).keypress(function(e){13===e.which&&a.val()&&o(e)}),e.createDropDown(t,"insertlink",i)},exec:function(e){var t=this;s.link._dropDown(t,e,function(e,n){t.focus(),!t.getRangeHelper().selectedHtml()||n?(n=n||e,t.wysiwygEditorInsertHtml('<a href="'+e+'">'+n+"</a>")):t.execCommand("createlink",e)})},tooltip:"Insert a link"},unlink:{state:function(){var e=o(this.currentNode());return e.is("a")||e.parents("a").length>0?0:-1},exec:function(){var e=o(this.currentNode()),t=e.is("a")?e:e.parents("a").first();t.length&&t.replaceWith(t.contents())},tooltip:"Unlink"},quote:{exec:function(e,t,n){var o="<blockquote>",i="</blockquote>";t?(o=o+(n=n?"<cite>"+n+"</cite>":"")+t+i,i=null):""===this.getRangeHelper().selectedHtml()&&(i=(a?"":"<br />")+i),this.wysiwygEditorInsertHtml(o,i)},tooltip:"Insert a Quote"},emoticon:{exec:function(e){var t=this,n=function(i){var r,a=t.opts.emoticonsCompat,s=t.getRangeHelper(),l=a&&" "!==s.getOuterText(!0,1)?" ":"",c=a&&" "!==s.getOuterText(!1,1)?" ":"",u=o("<div />"),d=o("<div />").appendTo(u),f=0,p=o.extend({},t.opts.emoticons.dropdown,i?t.opts.emoticons.more:{});return o.each(p,function(){f++}),f=Math.sqrt(f),o.each(p,function(e,n){d.append(o("<img />").attr({src:n.url||n,alt:e,title:n.tooltip||e}).click(function(){return t.insert(l+o(this).attr("alt")+c,null,!1).closeDropDown(!0),!1})),d.children().length>=f&&(d=o("<div />").appendTo(u))}),!i&&t.opts.emoticons.more&&(r=o('<a class="sceditor-more">'+t._("More")+"</a>").click(function(){return t.createDropDown(e,"more-emoticons",n(!0)),!1}),u.append(r)),u};t.createDropDown(e,"emoticons",n(!1))},txtExec:function(e){s.emoticon.exec.call(this,e)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(e,t,n){var i=r("youtubeMenu",{label:e._("Video URL:"),insert:e._("Insert")},!0);i.find(".button").click(function(t){var r=i.find(i,"#link").val(),a=r.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),s=r.match(/[&|?](?:star)?t=((\d+[hms]?){1,3})/),l=0;s&&o.each(s[1].split(/[hms]/),function(e,t){""!==t&&(l=60*l+Number(t))}),a&&/^[a-zA-Z0-9_\-]{11}$/.test(a[1])&&n(a[1],l),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertlink",i)},exec:function(e){var t=this;s.youtube._dropDown(t,e,function(e){t.wysiwygEditorInsertHtml(r("youtube",{id:e}))})},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t=new Date,n=t.getYear(),o=t.getMonth()+1,i=t.getDate();return n<2e3&&(n=1900+n),o<10&&(o="0"+o),i<10&&(i="0"+i),e.opts.dateFormat.replace(/year/i,n).replace(/month/i,o).replace(/day/i,i)},exec:function(){this.insertText(s.date._date(this))},txtExec:function(){this.insertText(s.date._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),o<10&&(o="0"+o),t+":"+n+":"+o},exec:function(){this.insertText(s.time._time())},txtExec:function(){this.insertText(s.time._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var e=this,t=e.getRangeHelper().getFirstBlockParent(),n=o(t);e.focus(),(t&&!n.is("body")||(e.execCommand("formatBlock","p"),t=e.getRangeHelper().getFirstBlockParent(),n=o(t),t&&!n.is("body")))&&("ltr"===n.css("direction")?n.css("direction",""):n.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var e=this,t=e.getRangeHelper().getFirstBlockParent(),n=o(t);e.focus(),(t&&!n.is("body")||(e.execCommand("formatBlock","p"),t=e.getRangeHelper().getFirstBlockParent(),n=o(t),t&&!n.is("body")))&&("rtl"===n.css("direction")?n.css("direction",""):n.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize",shortcut:"Ctrl+Shift+M"},source:{state:function(){return this.sourceMode()},exec:function(){this.toggleSourceMode()},txtExec:function(){this.toggleSourceMode()},tooltip:"View source",shortcut:"Ctrl+Shift+S"},ignore:{}};return s}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";return{toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:"#000,#44B8FF,#1E92F7,#0074D9,#005DC2,#00369B,#b3d5f4|#444,#C3FFFF,#9DF9FF,#7FDBFF,#68C4E8,#419DC1,#d9f4ff|#666,#72FF84,#4CEA5E,#2ECC40,#17B529,#008E02,#c0f0c6|#888,#FFFF44,#FFFA1E,#FFDC00,#E8C500,#C19E00,#fff5b3|#aaa,#FFC95F,#FFA339,#FF851B,#E86E04,#C14700,#ffdbbb|#ccc,#FF857A,#FF5F54,#FF4136,#E82A1F,#C10300,#ffc6c3|#eee,#FF56FF,#FF30DC,#F012BE,#D900A7,#B20080,#fbb8ec|#fff,#F551FF,#CF2BE7,#B10DC9,#9A00B2,#9A00B2,#e8b6ef",locale:n(1)("html").attr("lang")||"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,startInSourceMode:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}}}.call(t,n,t,e))&&(e.exports=o)}]),function(e,t,n){"use strict";var o=e.sceditor,i=o.plugins,r=o.escapeEntities,a=o.escapeUriScheme,s=o.ie,l=s&&s<11,c=o.command.get,u={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(e){var t=this;c("font")._dropDown(t,e,function(e){t.insertText("[font="+e+"]","[/font]")})}},size:{txtExec:function(e){var t=this;c("size")._dropDown(t,e,function(e){t.insertText("[size="+e+"]","[/size]")})}},color:{txtExec:function(e){var t=this;c("color")._dropDown(t,e,function(e){t.insertText("[color="+e+"]","[/color]")})}},bulletlist:{txtExec:function(t,n){var o="";e.each(n.split(/\r?\n/),function(){o+=(o?"\n":"")+"[li]"+this+"[/li]"}),this.insertText("[ul]\n"+o+"\n[/ul]")}},orderedlist:{txtExec:function(t,n){var o="";e.each(n.split(/\r?\n/),function(){o+=(o?"\n":"")+"[li]"+this+"[/li]"}),i.bbcode.bbcode.get(""),this.insertText("[ol]\n"+o+"\n[/ol]")}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(e){var t=this;c("image")._dropDown(t,e,function(e,n,o){var i="";n&&(i+=" width="+n),o&&(i+=" height="+o),t.insertText("[img"+i+"]"+e+"[/img]")})}},email:{txtExec:function(e,t){var n=this;c("email")._dropDown(n,e,function(e,o){n.insertText("[email="+e+"]"+(o||t||e)+"[/email]")})}},link:{txtExec:function(e,t){var n=this;c("link")._dropDown(n,e,function(e,o){n.insertText("[url="+e+"]"+(o||t||e)+"[/url]")})}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(e){var t=this;c("youtube")._dropDown(t,e,function(e){t.insertText("[youtube]"+e+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}},d=function(e){return e?e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):e},f=function(){var e=arguments;return e[0].replace(/\{(\d+)\}/g,function(t,n){return void 0!==e[n-0+1]?e[n-0+1]:"{"+n+"}"})},p={OPEN:"open",CONTENT:"content",NEWLINE:"newline",CLOSE:"close"},h=function(t,n,o,i,r,a){var s=this;s.type=t,s.name=n,s.val=o,s.attrs=e.extend({},i),s.children=r||[],s.closing=a||null};h.prototype={clone:function(){var e=this;return new h(e.type,e.name,e.val,e.attrs,[],e.closing?e.closing.clone():null)},splitAt:function(e){var t,n=this,o=n.clone(),i=n.children.indexOf(e);return i>-1&&(t=n.children.length-i,o.children=n.children.splice(i,t)),o}};var m=function(t){if(!(this instanceof m))return new m(t);var n,o,a,s,c,u,f,g,v,b,y,x,w,C,E=this;n=function(){E.bbcodes=i.bbcode.bbcodes,E.opts=e.extend({},m.defaults,t)},E.tokenize=function(e){var t,n,i,r=[],a=[{type:p.CLOSE,regex:/^\[\/[^\[\]]+\]/},{type:p.OPEN,regex:/^\[[^\[\]]+\]/},{type:p.NEWLINE,regex:/^(\r\n|\r|\n)/},{type:p.CONTENT,regex:/^([^\[\r\n]+|\[)/}];a.reverse();e:for(;e.length;){for(i=a.length;i--;)if(n=a[i].type,(t=e.match(a[i].regex))&&t[0]){r.push(o(n,t[0])),e=e.substr(t[0].length);continue e}e.length&&r.push(o(p.CONTENT,e)),e=""}return r},o=function(t,n){var o,r,s,l=/\[([^\]\s=]+)(?:([^\]]+))?\]/,c=/\[\/([^\[\]]+)\]/;return t===p.OPEN&&(o=n.match(l))&&(s=w(o[1]),o[2]&&(o[2]=e.trim(o[2]))&&(r=a(o[2]))),t===p.CLOSE&&(o=n.match(c))&&(s=w(o[1])),t===p.NEWLINE&&(s="#newline"),s&&(t!==p.OPEN&&t!==p.CLOSE||i.bbcode.bbcodes[s])||(t=p.CONTENT,s="#"),new h(t,s,n,r)},a=function(e){var t,n=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,o={};if("="===e.charAt(0)&&e.indexOf("=",1)<0)o.defaultattr=d(e.substr(1));else for("="===e.charAt(0)&&(e="defaultattr"+e);t=n.exec(e);)o[w(t[1])]=d(t[3])||t[4];return o},E.parse=function(e,t){var n=s(E.tokenize(e)),o=E.opts;return o.fixInvalidNesting&&u(n),c(n,null,t),o.removeEmptyTags&&g(n),n},y=function(e,t,n){for(var o=n.length;o--;)if(n[o].type===t&&n[o].name===e)return!0;return!1},f=function(t,n){var o=(t?E.bbcodes[t.name]:{}).allowedChildren;return!E.opts.fixInvalidChildren||!o||e.inArray(n.name||"#",o)>-1},s=function(t){for(var n,o,i,r,a,s,l=[],c=[],u=[],d=function(){return C(u)},h=function(e){d()?d().children.push(e):c.push(e)},m=function(t){return d()&&(o=E.bbcodes[d().name])&&o.closedBy&&e.inArray(t,o.closedBy)>-1};n=t.shift();)switch(s=t[0],f(d(),n)||n.type===p.CLOSE&&d()&&n.name===d().name||(n.name="#",n.type=p.CONTENT),n.type){case p.OPEN:m(n.name)&&u.pop(),h(n),(o=E.bbcodes[n.name])&&!o.isSelfClosing&&(o.closedBy||y(n.name,p.CLOSE,t))?u.push(n):o&&o.isSelfClosing||(n.type=p.CONTENT);break;case p.CLOSE:if(d()&&n.name!==d().name&&m("/"+n.name)&&u.pop(),d()&&n.name===d().name)d().closing=n,u.pop();else if(y(n.name,p.OPEN,u)){for(;i=u.pop();){if(i.name===n.name){i.closing=n;break}r=i.clone(),l.length>1&&r.children.push(C(l)),l.push(r)}for(s&&s.type===p.NEWLINE&&(o=E.bbcodes[n.name])&&!1===o.isInline&&(h(s),t.shift()),h(C(l)),a=l.length;a--;)u.push(l[a]);l.length=0}else n.type=p.CONTENT,h(n);break;case p.NEWLINE:d()&&s&&m((s.type===p.CLOSE?"/":"")+s.name)&&(s.type===p.CLOSE&&s.name===d().name||((o=E.bbcodes[d().name])&&o.breakAfter?u.pop():o&&!1===o.isInline&&E.opts.breakAfterBlock&&!1!==o.breakAfter&&u.pop())),h(n);break;default:h(n)}return c},c=function(e,t,n){var o,i,r,a,s,l,u,d,f=e.length;t&&(a=E.bbcodes[t.name]);for(var h=f;h--;)if(o=e[h])if(o.type===p.NEWLINE){if(i=h>0?e[h-1]:null,r=h<f-1?e[h+1]:null,d=!1,!n&&a&&!0!==a.isSelfClosing&&(i?l||r||(!1===a.isInline&&E.opts.breakEndBlock&&!1!==a.breakEnd&&(d=!0),a.breakEnd&&(d=!0),l=d):(!1===a.isInline&&E.opts.breakStartBlock&&!1!==a.breakStart&&(d=!0),a.breakStart&&(d=!0))),i&&i.type===p.OPEN&&(s=E.bbcodes[i.name])&&(n?!1===s.isInline&&(d=!0):(!1===s.isInline&&E.opts.breakAfterBlock&&!1!==s.breakAfter&&(d=!0),s.breakAfter&&(d=!0))),!n&&!u&&r&&r.type===p.OPEN&&(s=E.bbcodes[r.name])&&(!1===s.isInline&&E.opts.breakBeforeBlock&&!1!==s.breakBefore&&(d=!0),s.breakBefore&&(d=!0),u=d,d)){e.splice(h,1);continue}d&&e.splice(h,1),u=!1}else o.type===p.OPEN&&c(o.children,o,n)},u=function(t,n,o,i){var r,a,s,l,c,d,h=function(e){var t=E.bbcodes[e.name];return!t||!1!==t.isInline};for(n=n||[],i=i||t,a=0;a<t.length;a++)if((r=t[a])&&r.type===p.OPEN){if(o&&!h(r)){if(s=C(n),d=s.splitAt(r),c=n.length>1?n[n.length-2].children:i,f(r,s)){var m=s.clone();m.children=r.children,r.children=[m]}if((l=e.inArray(s,c))>-1){d.children.splice(0,1),c.splice(l+1,0,r,d);var g=d.children[0];return void(g&&g.type===p.NEWLINE&&(h(r)||(d.children.splice(0,1),c.splice(l+2,0,g))))}}n.push(r),u(r.children,n,o||h(r),i),n.pop(r)}},g=function(t){for(var n,o,i=t.length;i--;)(n=t[i])&&n.type===p.OPEN&&(o=E.bbcodes[n.name],g(n.children),function(e){for(var t=e.length;t--;){var n=e[t].type;if(n===p.OPEN||n===p.CLOSE)return!1;if(n===p.CONTENT&&/\S|\u00A0/.test(e[t].val))return!1}return!0}(n.children)&&o&&!o.isSelfClosing&&!o.allowsEmpty&&t.splice.apply(t,e.merge([i,1],n.children)))},E.toHTML=function(e,t){return v(E.parse(e,t),!0)},v=function(t,n){var o,a,s,c,u,d,f,h,m=[];for(f=function(e){return!1!==(!e||(void 0!==e.isHtmlInline?e.isHtmlInline:e.isInline))};t.length>0;)if(o=t.shift()){if(o.type===p.OPEN)h=o.children[o.children.length-1]||{},a=E.bbcodes[o.name],u=n&&f(a),s=v(o.children,!1),a&&a.html?(f(a)||!f(E.bbcodes[h.name])||a.isPreFormatted||a.skipLastLineBreak||l||(s+="<br />"),e.isFunction(a.html)?c=a.html.call(E,o,o.attrs,s):(o.attrs[0]=s,c=i.bbcode.formatBBCodeString(a.html,o.attrs))):c=o.val+s+(o.closing?o.closing.val:"");else{if(o.type===p.NEWLINE){if(!n){m.push("<br />");continue}d||m.push("<div>"),l||m.push("<br />"),t.length||m.push("<br />"),m.push("</div>\n"),d=!1;continue}u=n,c=r(o.val,!0)}u&&!d?(m.push("<div>"),d=!0):!u&&d&&(m.push("</div>\n"),d=!1),m.push(c)}return d&&m.push("</div>\n"),m.join("")},E.toBBCode=function(e,t){return b(E.parse(e,t))},b=function(e){for(var t,n,o,i,r,a,s,l,c,u,d=[];e.length>0;)if(t=e.shift())if(o=E.bbcodes[t.name],i=!(!o||!1!==o.isInline),r=o&&o.isSelfClosing,s=i&&E.opts.breakBeforeBlock&&!1!==o.breakBefore||o&&o.breakBefore,l=i&&!r&&E.opts.breakStartBlock&&!1!==o.breakStart||o&&o.breakStart,c=i&&E.opts.breakEndBlock&&!1!==o.breakEnd||o&&o.breakEnd,u=i&&E.opts.breakAfterBlock&&!1!==o.breakAfter||o&&o.breakAfter,a=(o?o.quoteType:null)||E.opts.quoteType||m.QuoteType.auto,o||t.type!==p.OPEN)if(t.type===p.OPEN){if(s&&d.push("\n"),d.push("["+t.name),t.attrs){t.attrs.defaultattr&&(d.push("=",x(t.attrs.defaultattr,a,"defaultattr")),delete t.attrs.defaultattr);for(n in t.attrs)t.attrs.hasOwnProperty(n)&&d.push(" ",n,"=",x(t.attrs[n],a,n))}d.push("]"),l&&d.push("\n"),t.children&&d.push(b(t.children)),r||o.excludeClosing||(c&&d.push("\n"),d.push("[/"+t.name+"]")),u&&d.push("\n"),t.closing&&r&&d.push(t.closing.val)}else d.push(t.val);else d.push(t.val),t.children&&d.push(b(t.children)),t.closing&&d.push(t.closing.val);return d.join("")},x=function(t,n,o){var i=m.QuoteType,r=/\s|=/.test(t);return e.isFunction(n)?n(t,o):n===i.never||n===i.auto&&!r?t:'"'+t.replace("\\","\\\\").replace('"','\\"')+'"'},C=function(e){return e.length?e[e.length-1]:null},w=function(e){return e.toLowerCase()},n()};m.QuoteType={always:1,never:2,auto:3},m.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:m.QuoteType.auto},e.sceditorBBCodePlugin=i.bbcode=function(){var t,r,a,s,c=this;c.bbcodes=i.bbcode.bbcodes,c.stripQuotes=d;var p={},h={},g={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]};c.init=function(){c.opts=this.opts,t(),this.commands=e.extend(!0,{},u,this.commands),this.toBBCode=c.signalToSource,this.fromBBCode=c.signalToWysiwyg},t=function(){e.each(c.bbcodes,function(t){var n,o=c.bbcodes[t].tags,i=c.bbcodes[t].styles;o&&e.each(o,function(e,o){n=!1===c.bbcodes[t].isInline,p[e]=p[e]||{},p[e][n]=p[e][n]||{},p[e][n][t]=o}),i&&e.each(i,function(e,o){n=!1===c.bbcodes[t].isInline,h[n]=h[n]||{},h[n][e]=h[n][e]||{},h[n][e][t]=o})})},r=function(t,n,i){var r,a,s=o.dom.getStyle;return i=!!i,h[i]?(e.each(h[i],function(o,i){(r=s(t[0],o))&&s(t.parent()[0],o)!==r&&e.each(i,function(o,i){(!i||e.inArray(r.toString(),i)>-1)&&(a=c.bbcodes[o].format,n=e.isFunction(a)?a.call(c,t,n):f(a,n))})}),n):n},a=function(t,n,i){var r,a,s=t[0],u=s.nodeName.toLowerCase();i=!!i,p[u]&&p[u][i]&&e.each(p[u][i],function(o,i){i&&(r=!1,e.each(i,function(n,o){if(t.attr(n)&&!(o&&e.inArray(t.attr(n),o)<0))return r=!0,!1}),!r)||(a=c.bbcodes[o].format,n=e.isFunction(a)?a.call(c,t,n):f(a,n))});var d=o.dom.isInline;if(i&&(!d(s,!0)||"br"===u)){for(var h,m,g=s.previousSibling;g&&1===g.nodeType&&!e(g).is("br")&&d(g,!0)&&!g.firstChild;)g=g.previousSibling;do{h=(m=s.parentNode).lastChild===s,s=m}while(m&&h&&d(m,!0));(!h||"li"===u||"br"===u&&l)&&(n+="\n"),"br"!==u&&g&&!e(g).is("br")&&d(g,!0)&&(n="\n"+n)}return n},c.signalToSource=function(t,i){var r,a,s=new m(c.opts.parserOptions);return i||(i="string"==typeof t?r=e("<div />").css("visibility","hidden").appendTo(n.body).html(t):e(t)),i&&i.jquery?(o.dom.removeWhiteSpace(i[0]),e(".sceditor-ignore",i).remove(),a=c.elementToBbcode(i),r&&r.remove(),a=s.toBBCode(a,!0),c.opts.bbcodeTrim&&(a=e.trim(a)),a):""},c.elementToBbcode=function(t){var n=function(t,i){var s="";return o.dom.traverse(t,function(t){var o=e(t),c="",u=t.nodeType,d=t.nodeName.toLowerCase(),f=g[d],p=t.firstChild,h=!0;if("object"==typeof i&&(h=e.inArray(d,i)>-1,o.is("img")&&o.data("sceditor-emoticon")&&(h=!0),h||(f=i)),3===u||1===u)if(1===u){if(o.hasClass("sceditor-nlf")&&(!p||!l&&1===t.childNodes.length&&/br/i.test(p.nodeName)))return;"iframe"!==d&&(c=n(t,f)),h?("code"!==d&&(c=r(o,c),c=a(o,c),c=r(o,c,!0)),s+=a(o,c,!0)):s+=c}else s+=t.nodeValue},!1,!0),s};return n(t[0])},c.signalToWysiwyg=function(t,n){var o=new m(c.opts.parserOptions).toHTML(c.opts.bbcodeTrim?e.trim(t):t);return n?s(o):o},s=function(t){var i,r,a,s=e("<div />").hide().appendTo(n.body),c=s[0];return a=function(t,i){if(!o.dom.hasStyling(t)){if(l||1!==t.childNodes.length||!e(t.firstChild).is("br"))for(;r=t.firstChild;)c.insertBefore(r,t);if(i){var a=c.lastChild;t!==a&&e(a).is("div")&&t.nextSibling===a&&c.insertBefore(n.createElement("br"),t)}c.removeChild(t)}},c.innerHTML=t.replace(/<\/div>\n/g,"</div>"),(i=c.firstChild)&&e(i).is("div")&&a(i,!0),(i=c.lastChild)&&e(i).is("div")&&a(i),c=c.innerHTML,s.remove(),c}},i.bbcode.formatBBCodeString=function(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){var o=!0;return"!"===n.charAt(0)&&(o=!1,n=n.substring(1)),"0"===n&&(o=!1),void 0===t[n]?e:o?r(t[n],!0):t[n]})};var g=function(e){return e=parseInt(e,10),isNaN(e)?"00":(e=Math.max(0,Math.min(e,255)).toString(16),e.length<2?"0"+e:e)},v=function(e){var t;return e=e||"#000",(t=e.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+g(t[1])+g(t[2]-0)+g(t[3]-0):(t=e.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:e},b={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:m.QuoteType.never,format:function(e,t){var n;return e.is("font")&&(n=e.attr("face"))||(n=e.css("font-family")),"[font="+d(n)+"]"+t+"[/font]"},html:'<font face="{defaultattr}">{0}</font>'},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=e.attr("size"),o=2;return n||(n=e.css("fontSize")),n.indexOf("px")>-1?((n=n.replace("px","")-0)<12&&(o=1),n>15&&(o=3),n>17&&(o=4),n>23&&(o=5),n>31&&(o=6),n>47&&(o=7)):o=n,"[size="+o+"]"+t+"[/size]"},html:'<font size="{defaultattr}">{!0}</font>'},color:{tags:{font:{color:null}},styles:{color:null},quoteType:m.QuoteType.never,format:function(e,t){var n;return e.is("font")&&(n=e.attr("color"))||(n=e[0].style.color||e.css("color")),"[color="+v(n)+"]"+t+"[/color]"},html:function(e,t,n){return'<font color="'+r(v(t.defaultattr),!0)+'">'+n+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(e,t){return e.data("sceditor-emoticon")+t},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},allowedChildren:["#"],quoteType:m.QuoteType.never,format:function(e,t){var n,o,i="",r=e[0],a=function(e){return r.style?r.style[e]:null};return e.attr("data-sceditor-emoticon")?t:(n=e.attr("width")||a("width"),o=e.attr("height")||a("height"),(r.complete&&(n||o)||n&&o)&&(i="="+e.width()+"x"+e.height()),"[img"+i+"]"+e.attr("src")+"[/img]")},html:function(e,t,n){var o,i,s,l="";return o=t.width,i=t.height,t.defaultattr&&(o=(s=t.defaultattr.split(/x/i))[0],i=2===s.length?s[1]:s[0]),void 0!==o&&(l+=' width="'+r(o,!0)+'"'),void 0!==i&&(l+=' height="'+r(i,!0)+'"'),"<img"+l+' src="'+a(n)+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:m.QuoteType.never,format:function(e,t){var n=e.attr("href");return"mailto:"===n.substr(0,7)?'[email="'+n.substr(7)+'"]'+t+"[/email]":"[url="+n+"]"+t+"[/url]"},html:function(e,t,n){return t.defaultattr=r(t.defaultattr,!0)||n,'<a href="'+a(t.defaultattr)+'">'+n+"</a>"}},email:{quoteType:m.QuoteType.never,html:function(e,t,n){return'<a href="mailto:'+(r(t.defaultattr,!0)||n)+'">'+n+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:m.QuoteType.never,format:function(t,n){var o="",i=e(t),r=i.children("cite").first();return(1===r.length||i.data("author"))&&(o=r.text()||i.data("author"),i.data("author",o),r.remove(),n=this.elementToBbcode(e(t)),o="="+o.replace(/(^\s+|\s+$)/g,""),i.prepend(r)),"[quote"+o+"]"+n+"[/quote]"},html:function(e,t,n){return t.defaultattr&&(n="<cite>"+r(t.defaultattr)+"</cite>"+n),"<blockquote>"+n+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(e,t){return e=e.attr("data-youtube-id"),e?"[youtube]"+e+"[/youtube]":t},html:'<iframe width="560" height="315" frameborder="0" src="https://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}};i.bbcode.bbcode={get:function(e){return b[e]||null},set:function(t,n){return!(!t||!n)&&(n=e.extend(b[t]||{},n),n.remove=function(){delete b[t]},b[t]=n,this)},rename:function(e,t){return e in b&&(b[t]=b[e],delete b[e],this)},remove:function(e){return e in b&&delete b[e],this}},e.fn.sceditorBBCodePlugin=function(t){return t=t||{},e.isPlainObject(t)&&(t.plugins=(t.plugins||"")+"bbcode"),this.sceditor(t)},i.bbcode.normaliseColour=v,i.bbcode.formatString=f,i.bbcode.stripQuotes=d,i.bbcode.bbcodes=b,o.BBCodeParser=m}(jQuery,window,document);
/* SCEditor v1.5.3 | (C) 2017, Sam Clarke | sceditor.com/license */

!function(e){"use strict";e.sceditor.plugins.undo=function(){var e,t,o=this,r=0,n=50,u=-1,c=[],a=!1,d=function(o){a=!0,t=o.value,e.sourceMode(o.sourceMode),e.val(o.value,!1),e.focus(),o.sourceMode?e.sourceEditorCaret(o.caret):e.getRangeHelper().restoreRange(),a=!1},s=function(e,t){var o,r,n,u,c=e.length,a=t.length,d=Math.max(c,a);for(o=0;o<d&&e.charAt(o)===t.charAt(o);o++);for(n=c<a?a-c:0,u=a<c?c-a:0,r=d-1;r>=0&&e.charAt(r-n)===t.charAt(r-u);r--);return r-o+1},i=function(e,t){for(;t<c.length-1;)c.pop();c.push(e),u=t+1};o.init=function(){n=(e=this).undoLimit||n,e.addShortcut("ctrl+z",o.undo),e.addShortcut("ctrl+shift+z",o.redo),e.addShortcut("ctrl+y",o.redo),e.commands.undo||(e.commands.undo={txtExec:o.undo,exec:o.undo,tooltip:"Undo"},e.commands.redo={txtExec:o.redo,exec:o.redo,tooltip:"Redo"})},o.undo=function(){var t=e.val(null,!1);return-1!==u&&(u===c.length-1&&(i({caret:e.sourceEditorCaret(),sourceMode:e.sourceMode(),value:t},u),u-=1),u-=1,d(c[u]),!1)},o.redo=function(){return u!==c.length-1&&(u+=1,d(c[u]),!1)},o.signalReady=function(){var o,r=e.val(null,!1);o=""===r?{end:0,start:0}:this.sourceEditorCaret(),t=r,i({caret:o,sourceMode:this.sourceMode(),value:r},u)},o.signalValuechangedEvent=function(o){var d=o.rawValue;n>0&&c.length>n&&c.shift(),!a&&t&&t!==d&&((r+=s(t,d))<20||r<50&&!/\s$/g.test(o.rawValue)||(i({caret:e.sourceEditorCaret(),sourceMode:e.sourceMode(),value:d},u),r=0,t=d))}}}(jQuery);
/*
 2015-2017 SimplePortal Team
 @license BSD 3-clause
 @version 1.0.0 RC1
*/
function sp_collapseBlock(a){$("#sp_block_"+a).slideToggle(300).promise().done(function(){var b=!1;$("#sp_block_"+a).is(":visible")&&(b=!0);0===elk_member_id?document.cookie="sp_block_"+a+"="+(b?0:1):elk_setThemeOption("sp_block_"+a,b?0:1,null,null);$("#sp_collapse_"+a).attr("class",b?"collapse":"expand")})}
function sp_collapseSide(a){var b=[,"sp_left",,,"sp_right"];mode=""===document.getElementById(b[a]).style.display?0:1;0===elk_member_id?document.cookie=b[a]+"="+(mode?0:1):elk_setThemeOption(b[a],mode?0:1,null,null);document.getElementById("sp_collapse_side"+a).className=mode?"dot collapse":"dot expand";$("#"+b[a]).toggle(400)}
function sp_collapse_object(a,b){var c=""===document.getElementById("sp_object_"+a).style.display?0:1;$("#sp_object_"+a).toggle(300);if("undefined"===typeof b||!0===b)document.getElementById("sp_collapse_"+a).src=elk_images_url+(c?"/collapse.png":"/expand.png")}
function sp_image_resize(){for(var a=document.getElementsByTagName("img"),b=0;b<a.length;b++)if("bbc_img sp_article"===a[b].className){var c=new Image;c.src=a[b].src;300<c.width?(a[b].height=300*c.height/c.width,a[b].width=300):(a[b].width=c.width,a[b].height=c.height)}"undefined"!==typeof window_oldSPImageOnload&&window_oldSPImageOnload&&(window_oldSPImageOnload(),window_oldSPImageOnload=null)}
function sp_submit_shout(a,b,c){if(window.XMLHttpRequest){shoutbox_indicator(a,!0);var d=document.getElementById("new_shout_"+a).value.replace(/&#/g,"&#38;#").php_urlencode();sendXMLDocument(elk_prepareScriptUrl(sp_script_url)+"action=shoutbox;xml","shoutbox_id="+a+"&shout="+d+"&"+b+"="+c,onShoutReceived);document.getElementById("new_shout_"+a).value="";return!1}}
function sp_delete_shout(a,b,c,d){if(window.XMLHttpRequest)return shoutbox_indicator(a,!0),sendXMLDocument(elk_prepareScriptUrl(sp_script_url)+"action=shoutbox;xml","shoutbox_id="+a+"&delete="+b+"&"+c+"="+d,onShoutReceived),!1}function sp_refresh_shout(a,b){if(window.XMLHttpRequest)return shoutbox_indicator(a,!0),getXMLDocument(elk_prepareScriptUrl(sp_script_url)+"action=shoutbox;shoutbox_id="+a+";time="+b+";xml",onShoutReceived),!1}
function onShoutReceived(a){var b="";var c=a.getElementsByTagName("elk")[0].getElementsByTagName("shoutbox")[0].childNodes[0].nodeValue;if("1"===a.getElementsByTagName("elk")[0].getElementsByTagName("updated")[0].childNodes[0].nodeValue){shouts=a.getElementsByTagName("elk")[0].getElementsByTagName("shout");var d=a.getElementsByTagName("elk")[0].getElementsByTagName("error")[0].childNodes[0].nodeValue;var e=a.getElementsByTagName("elk")[0].getElementsByTagName("warning")[0].childNodes[0].nodeValue;
var g=a.getElementsByTagName("elk")[0].getElementsByTagName("reverse")[0].childNodes[0].nodeValue;"0"!==e&&(b+='<li class="shoutbox_warning smalltext">'+e+"</li>");if("0"!==d)document.getElementById("shouts_"+c).innerHTML=b+'<li class="smalltext">'+d+"</li>";else{for(var f=0;f<shouts.length;f++){var h=a.getElementsByTagName("elk")[0].getElementsByTagName("shout")[f];h.getElementsByTagName("id");d=h.getElementsByTagName("author")[0].childNodes[0].nodeValue;e=h.getElementsByTagName("time")[0].childNodes[0].nodeValue;
h.getElementsByTagName("timeclean");var k=h.getElementsByTagName("delete")[0].childNodes[0].nodeValue;var l=h.getElementsByTagName("content")[0].childNodes[0].nodeValue;h=h.getElementsByTagName("is_me")[0].childNodes[0].nodeValue;b+="<li>"+("0"===h?"<strong>"+d+":</strong> ":"")+l+"<br />"+(0!==k?'<span class="shoutbox_delete">'+k+"</span>":"")+'<span class="smalltext shoutbox_time">'+e+"</span></li>"}document.getElementById("shouts_"+c).innerHTML=b;"0"!==g?document.getElementById("shouts_"+c).scrollTop=
document.getElementById("shouts_"+c).scrollHeight:document.getElementById("shouts_"+c).scrollTop=0}}shoutbox_indicator(c,!1);return!1}function shoutbox_indicator(a,b){document.getElementById("shoutbox_load_"+a).style.display=b?"":"none"}function sp_catch_enter(a){if(window.event)var b=window.event.keyCode;else a&&(b=a.which);if(13===b)return!0}
function sp_show_ignored_shout(a){document.getElementById("ignored_shout_"+a).style.display="";document.getElementById("ignored_shout_link_"+a).style.display="none"}function sp_show_history_ignored_shout(a){document.getElementById("history_ignored_shout_"+a).style.display="";document.getElementById("history_ignored_shout_link_"+a).style.display="none"}
function sp_showMoreSmileys(a,b,c,d,e,g){if("undefined"!==typeof this.oSmileyPopupWindow&&"closed"in this.oSmileyPopupWindow&&!this.oSmileyPopupWindow.closed)this.oSmileyPopupWindow.focus();else{if("undefined"===typeof f){var f="";for(i=0;i<sp_smileys.length;i++)sp_smileys[i][2]=sp_smileys[i][2].replace(/"/g,"&quot;"),sp_smileys[i][0]=sp_smileys[i][0].replace(/"/g,"&quot;"),f+='<a href="javascript:void(0);" onclick="window.opener.replaceText(\' '+sp_smileys[i][0].php_addslashes()+"', window.opener.document.getElementById('new_shout_"+
a+'\')); window.focus(); return false;"><img src="'+g+"/"+sp_smileys[i][1]+'" id="sml_'+sp_smileys[i][1]+'" alt="'+sp_smileys[i][2]+'" title="'+sp_smileys[i][2]+'" style="padding: 4px;" border="0" /></a> '}this.oSmileyPopupWindow=window.open("","add_smileys","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=480,height=220,resizable=yes");this.oSmileyPopupWindow.document.open("text/html","replace");this.oSmileyPopupWindow.document.write(sp_moreSmileysTemplate.easyReplace({smileyRows:f}));
this.oSmileyPopupWindow.document.close()}}
function sp_update_editor(a,b){var c=$("textarea"),d=c.sceditor("instance"),e="";"bbc"===a&&"undefined"===typeof d?(e="html"===b?c.html().php_unhtmlspecialchars():"[code]"+c.val().replace(/\n/g,"<br >")+"[/code]",elk_editor(),d=c.sceditor("instance"),d.sourceMode(!1),d.setWysiwygEditorValue(e),d.sourceMode(!0)):"bbc"!==a&&"undefined"!==typeof d&&""!==b?("html"===a?""!==d.getSourceEditorValue()&&(e=d.getWysiwygEditorValue(!1),e=e.replace(/<span .*>\s?<\/span>/g,"").replace(/<br( \\)?>/g,"\n")):e=d.getSourceEditorValue(!1).replace(/<br( \\)?>/g,
"\n").php_unhtmlspecialchars().replace("[code]","").replace("[/code]",""),d.destroy(),$("textarea").val(e)):"bbc"!==a&&"undefined"!==typeof d&&("html"===a&&d.updateOriginal(),d.destroy())}function sp_editor_change_type(a){var b;$("#"+a).on("focus",function(){b=this.value}).change(function(){sp_update_editor(this.value,b);b=this.value})}function sp_theme_select(a){a=a.options[a.selectedIndex].value;document.getElementById("sp_ts_thumb").src=sp_ts_thumbs[a]}
function sp_collapseCalendar(a){new_day="sp_calendar_"+a;if(new_day===current_day)return!1;document.getElementById(current_day).style.display="none";document.getElementById(new_day).style.display="";current_day=new_day}function sp_collapseObject(a){var b=document.getElementById("sp_object_"+a).style.display;b=""===b|"block"===b?!1:!0;$("#sp_object_"+a).slideToggle(300);document.getElementById("sp_collapse_"+a).src=elk_images_url+(b?"/selected.png":"/selected_open.png")}
function check_style_options(){var a=document.getElementById("no_title").checked,b=document.getElementById("no_body").checked;document.getElementById("title_default_class").disabled=a;document.getElementById("title_custom_class").disabled=a;document.getElementById("title_custom_style").disabled=a;document.getElementById("body_default_class").disabled=b;document.getElementById("body_custom_class").disabled=b;document.getElementById("body_custom_style").disabled=b}
function sp_surroundText(a,b,c){if("caretPos"in c&&"createTextRange"in c){var d=c.caretPos,e=d.text.length;d.text=" "===d.text.charAt(d.text.length-1)?a+d.text+b+" ":a+d.text+b;0===e?(d.moveStart("character",-b.length),d.moveEnd("character",-b.length),d.select()):c.focus(d)}else if("selectionStart"in c){d=c.value.substr(0,c.selectionStart);e=c.value.substr(c.selectionStart,c.selectionEnd-c.selectionStart);var g=c.value.substr(c.selectionEnd),f=c.selectionStart,h=c.scrollTop;c.value=d+a+e+b+g;c.setSelectionRange&&
(0===e.length?c.setSelectionRange(f+a.length,f+a.length):c.setSelectionRange(f,f+a.length+e.length+b.length),c.focus());c.scrollTop=h}else c.value+=a+b,c.focus(c.value.length-1)};/*
 ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 @version 1.1

 This file contains javascript plugins for use with jquery
 hoverIntent v1.9.0 // 2014.08.11 // jQuery v1.9.1+
 http://cherne.net/brian/resources/jquery.hoverIntent.html

 You may use hoverIntent under the terms of the MIT license. Basically that
 means you are free to use hoverIntent as long as this header is left intact.
 Copyright 2007, 2014 Brian Cherne
 Superclick v1.0.0 - jQuery menu widget
 Copyright (c) 2013 Joel Birch

 Dual licensed under the MIT and GPL licenses:
 http://www.opensource.org/licenses/mit-license.php
 http://www.gnu.org/licenses/gpl.html
 @name      ElkArte news fader
 @copyright ElkArte Forum contributors
 @license   MIT http://www.opensource.org/licenses/mit-license.php
*/
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):jQuery&&!jQuery.fn.hoverIntent&&a(jQuery)})(function(a){var b={interval:100,sensitivity:6,timeout:0},c=0,d,e,g=function(a){d=a.pageX;e=a.pageY},f=function(a,b,c,m){if(Math.sqrt((c.pX-d)*(c.pX-d)+(c.pY-e)*(c.pY-e))<m.sensitivity)return b.off("mousemove.hoverIntent"+c.namespace,g),delete c.timeoutId,c.isActive=!0,delete c.pX,delete c.pY,m.over.apply(b[0],[a]);c.pX=d;c.pY=e;c.timeoutId=setTimeout(function(){f(a,b,c,m)},m.interval)};
a.fn.hoverIntent=function(d,e,l){var h=c++,k=a.extend({},b);k=a.isPlainObject(d)?a.extend(k,d):a.isFunction(e)?a.extend(k,{over:d,out:e,selector:l}):a.extend(k,{over:d,out:d,selector:e});d=function(b){var c=a.extend({},b),d=a(this),e=d.data("hoverIntent");e||d.data("hoverIntent",e={});var t=e[h];t||(e[h]=t={id:h});t.timeoutId&&(t.timeoutId=clearTimeout(t.timeoutId));e=t.namespace=".hoverIntent"+h;"mouseenter"===b.type?t.isActive||(t.pX=c.pageX,t.pY=c.pageY,d.on("mousemove.hoverIntent"+e,g),t.timeoutId=
setTimeout(function(){f(c,d,t,k)},k.interval)):t.isActive&&(d.off("mousemove.hoverIntent"+e,g),t.timeoutId=setTimeout(function(){var a=t,b=k.out;delete d.data("hoverIntent")[a.id];b.apply(d[0],[c])},k.timeout))};return this.on({"mouseenter.hoverIntent":d,"mouseleave.hoverIntent":d},k.selector)}});
(function(a,b){var c=function(){(function(){a(window).on("load",function(){a("body").children().on("click.superfish",function(){a(".sf-js-enabled").superfish("hide","true")})})})();var c=function(){var b=/^(?![\w\W]*Windows Phone)[\w\W]*(iPhone|iPad|iPod)/i.test(navigator.userAgent);if(b)a("html").css("cursor","pointer").on("click",a.noop);return b}(),e=function(){var a=document.documentElement.style;return"behavior"in a&&"fill"in a&&/iemobile/i.test(navigator.userAgent)}(),g=!!b.PointerEvent,f=function(a,
b,c){var d="sf-js-enabled";b.cssArrows&&(d+=" sf-arrows");a[c?"addClass":"removeClass"](d)},h=function(b,c){return b.find("li."+c.pathClass).slice(0,c.pathLevels).addClass(c.hoverClass+" sf-breadcrumb").filter(function(){return a(this).children(c.popUpSelector).hide().show().length}).removeClass(c.pathClass)},k=function(a,b){var c=b?"addClass":"removeClass";a.children("a")[c]("sf-with-ul")},l=function(a){var b=a.css("ms-touch-action"),c=a.css("touch-action");c="pan-y"===(c||b)?"auto":"pan-y";a.css({"ms-touch-action":c,
"touch-action":c})},m=function(a){return a.closest(".sf-js-enabled").data("sfOptions")},q=function(){var b=a(this),c=m(b);clearTimeout(c.sfTimer);b.siblings().superfish("hide").end().superfish("show")},n=function(b){b.retainPath=-1<a.inArray(this[0],b.$path);this.superfish("hide");this.parents("."+b.hoverClass).length||(b.onIdle.call(this.closest(".sf-js-enabled")),b.$path.length&&a.proxy(q,b.$path)())},p=function(){var b=a(this),d=m(b);c?a.proxy(n,b,d)():(clearTimeout(d.sfTimer),d.sfTimer=setTimeout(a.proxy(n,
b,d),d.delay))},u=function(b){var c=a(this),d=m(c),e=c.siblings(b.data.popUpSelector);if(!1===d.onHandleTouch.call(e))return this;0<e.length&&e.is(":hidden")&&(c.one("click.superfish",!1),"MSPointerDown"===b.type||"pointerdown"===b.type?c.trigger("focus"):a.proxy(q,c.parent("li"))())};return{hide:function(b){if(this.length){var c=m(this);if(!c)return this;var d=!0===c.retainPath?c.$path:"";d=this.find("li."+c.hoverClass).add(this).not(d).removeClass(c.hoverClass).children(c.popUpSelector);var e=c.speedOut;
b&&(d.show(),e=0);c.retainPath=!1;if(!1===c.onBeforeHide.call(d))return this;d.stop(!0,!0).animate(c.animationOut,e,function(){var b=a(this);c.onHide.call(b)})}return this},show:function(){var a=m(this);if(!a)return this;var b=this.addClass(a.hoverClass).children(a.popUpSelector);if(!1===a.onBeforeShow.call(b))return this;b.stop(!0,!0).animate(a.animation,a.speed,function(){a.onShow.call(b)});return this},destroy:function(){return this.each(function(){var b=a(this),c=b.data("sfOptions");if(!c)return!1;
var d=b.find(c.popUpSelector).parent("li");clearTimeout(c.sfTimer);f(b,c);k(d);l(b);b.off(".superfish").off(".hoverIntent");d.children(c.popUpSelector).attr("style",function(a,b){return b.replace(/display[^;]+;?/g,"")});c.$path.removeClass(c.hoverClass+" sf-breadcrumb").addClass(c.pathClass);b.find("."+c.hoverClass).removeClass(c.hoverClass);c.onDestroy.call(b);b.removeData("sfOptions")})},init:function(b){return this.each(function(){var d=a(this);if(d.data("sfOptions"))return!1;var n=a.extend({},
a.fn.superfish.defaults,b),m=d.find(n.popUpSelector).parent("li");n.$path=h(d,n);d.data("sfOptions",n);f(d,n,!0);k(m,!0);l(d);var r="li:has("+n.popUpSelector+")";if(a.fn.hoverIntent&&!n.disableHI)d.hoverIntent(q,p,r);else d.on("mouseenter.superfish",r,q).on("mouseleave.superfish",r,p);r="MSPointerDown.superfish";g&&(r="pointerdown.superfish");c||(r+=" touchend.superfish");e&&(r+=" mousedown.superfish");d.on("focusin.superfish","li",q).on("focusout.superfish","li",p).on(r,"a",n,u);m.not(".sf-breadcrumb").superfish("hide",
!0);n.onInit.call(this)})}}}();a.fn.superfish=function(b,e){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof b&&b?a.error("Method "+b+" does not exist on jQuery.fn.superfish"):c.init.apply(this,arguments)};a.fn.superfish.defaults={popUpSelector:"ul,.sf-mega",hoverClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:!0,disableHI:!1,onInit:a.noop,onBeforeShow:a.noop,
onShow:a.noop,onBeforeHide:a.noop,onHide:a.noop,onIdle:a.noop,onDestroy:a.noop,onHandleTouch:a.noop}})(jQuery,window);
(function(a,b){var c=function(){(function(){a(b).on("load",function(){a("body").children().on("click.superclick",function(){a(".sf-js-enabled").superclick("reset")})})})();var c=function(a,b){var c="sf-js-enabled";b.cssArrows&&(c+=" sf-arrows");a.toggleClass(c)},e=function(b,c){return b.find("li."+c.pathClass).slice(0,c.pathLevels).addClass(c.activeClass+" sf-breadcrumb").filter(function(){return a(this).children(c.popUpSelector).hide().show().length}).removeClass(c.pathClass)},g=function(a){var b=
a.css("ms-touch-action"),c=a.css("touch-action");c="pan-y"===(c||b)?"auto":"pan-y";a.css({"ms-touch-action":c,"touch-action":c})},f=function(b){var c=a(this),d=c.siblings(b.data.popUpSelector);if(d.length)return b=!d.is(":hidden"),d=d.is(":hidden")?k:l,a.proxy(d,c.parent("li"))(),!!b},h=function(b){var c=a(this),d=c.siblings(b.data.popUpSelector);b=b.currentTarget.href;if(1===d.length&&b)return d.not(":hidden")&&a.proxy(l,c.parent("li"))(),window.location=b,!1},k=function(){var b=a(this);q(b);b.siblings().superclick("hide").end().superclick("show")},
l=function(){var b=a(this),c=q(b);a.proxy(m,b,c)()},m=function(b){b.retainPath=-1<a.inArray(this[0],b.$path);this.superclick("hide");this.parents("."+b.activeClass).length||(b.onIdle.call(this.closest(".sf-js-enabled")),b.$path.length&&a.proxy(k,b.$path)())},q=function(a){return a.closest(".sf-js-enabled").data("sf-options")};return{hide:function(b){if(this.length){var c=q(this);if(!c)return this;var d=!0===c.retainPath?c.$path:"";d=this.find("li."+c.activeClass).add(this).not(d).removeClass(c.activeClass).children(c.popUpSelector);
var e=c.speedOut;b&&(d.show(),e=0);c.retainPath=!1;c.onBeforeHide.call(d);d.stop(!0,!0).animate(c.animationOut,e,function(){var b=a(this);c.onHide.call(b)})}return this},show:function(){var a=q(this);if(!a)return this;var b=this.addClass(a.activeClass).children(a.popUpSelector);a.onBeforeShow.call(b);b.stop(!0,!0).animate(a.animation,a.speed,function(){a.onShow.call(b)});return this},destroy:function(){return this.each(function(){var b=a(this),d=b.data("sf-options");if(!d)return!1;var e=b.find(d.popUpSelector).parent("li");
c(b,d);e.children("a").toggleClass("sf-with-ul");g(b);b.off(".superclick");e.children(d.popUpSelector).attr("style",function(a,b){return b.replace(/display[^;]+;?/g,"")});d.$path.removeClass(d.activeClass+" sf-breadcrumb").addClass(d.pathClass);b.find("."+d.activeClass).removeClass(d.activeClass);d.onDestroy.call(b);b.removeData("sf-options")})},reset:function(){return this.each(function(){var b=a(this),c=q(b);a(b.find("."+c.activeClass).toArray().reverse()).children("a").trigger("click")})},init:function(b){return this.each(function(){var d=
a(this);if(d.data("sf-options"))return!1;var k=a.extend({},a.fn.superclick.defaults,b),l=d.find(k.popUpSelector).parent("li");k.$path=e(d,k);d.data("sf-options",k);c(d,k);l.children("a").toggleClass("sf-with-ul");g(d);d.on("click.superclick","a",k,f);l.on("dblclick.superclick","a",k,h);l.not(".sf-breadcrumb").superclick("hide",!0);k.onInit.call(this)})}}}();a.fn.superclick=function(b,e){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof b&&b?a.error("Method "+b+
" does not exist on jQuery.fn.superclick"):c.init.apply(this,arguments)};a.fn.superclick.defaults={popUpSelector:"ul,.sf-mega",activeClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:!0,onInit:a.noop,onBeforeShow:a.noop,onShow:a.noop,onBeforeHide:a.noop,onHide:a.noop,onIdle:a.noop,onDestroy:a.noop}})(jQuery,window);
(function(a){a.fn.Elk_NewsFader=function(b){var c={iFadeDelay:5E3,iFadeSpeed:1E3},d=0,e=a(this).find("li");1<e.length&&(a.extend(c,b),e.hide(),e.eq(0).fadeIn(c.iFadeSpeed),setInterval(function(){a(e[d]).fadeOut(c.iFadeSpeed,function(){d++;d==e.length&&(d=0);a(e[d]).fadeIn(c.iFadeSpeed)})},c.iFadeSpeed+c.iFadeDelay));return this}})(jQuery);/*
 @name      ElkArte Forum
 @copyright ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 This file contains code covered by:
 copyright:	2011 Simple Machines (http://www.simplemachines.org)
 license:		BSD, See included LICENSE.TXT for terms and conditions.

 @version 1.1
*/
var elk_formSubmitted=!1,lastKeepAliveCheck=(new Date).getTime(),ajax_indicator_ele=null,ua=navigator.userAgent.toLowerCase(),is_opera=!!window.opera,is_ff="undefined"!==typeof InstallTrigger||(-1!==ua.indexOf("iceweasel")||-1!==ua.indexOf("icecat")||-1!==ua.indexOf("shiretoko")||-1!==ua.indexOf("minefield"))&&!is_opera,is_safari=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),is_chrome=!!window.chrome,is_ie=!!document.documentMode,is_webkit=-1!==ua.indexOf("applewebkit");
is_osx=0<=navigator.platform.toUpperCase().indexOf("MAC");is_mobile=-1!==navigator.userAgent.indexOf("Mobi");is_touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;"getElementsByClassName"in document||(document.getElementsByClassName=function(a){return $("."+a)});
function getXMLDocument(a,b){var c=new XMLHttpRequest,d="undefined"!==typeof b,e=this;d&&(c.onreadystatechange=function(){4===c.readyState&&(null!==c.responseXML&&200===c.status?b.call(e,c.responseXML):b.call(e,!1))});c.open("GET",a,d);c.send(null);return c}
function sendXMLDocument(a,b,c){var d=new window.XMLHttpRequest,e=this;"undefined"!==typeof c&&(d.onreadystatechange=function(){4===d.readyState&&(null!==d.responseXML&&200===d.status?c.call(e,d.responseXML):c.call(e,!1))});d.open("POST",a,!0);"setRequestHeader"in d&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(b);return!0}String.prototype.php_strtr=function(a,b){return this.replace(new RegExp("["+a+"]","g"),function(c){return b.charAt(a.indexOf(c))})};
String.prototype.php_strtolower=function(){return"boolean"===typeof elk_iso_case_folding&&!0===elk_iso_case_folding?this.php_strtr("ABCDEFGHIJKLMNOPQRSTUVWXYZ\u008a\u008c\u008e\u009f\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\u00d0\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6\u00d7\u00d8\u00d9\u00da\u00db\u00dc\u00dd\u00de","abcdefghijklmnopqrstuvwxyz\u009a\u009c\u009e\u00ff\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u00e7\u00e8\u00e9\u00ea\u00eb\u00ec\u00ed\u00ee\u00ef\u00f0\u00f1\u00f2\u00f3\u00f4\u00f5\u00f6\u00f7\u00f8\u00f9\u00fa\u00fb\u00fc\u00fd\u00fe"):
this.php_strtr("ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")};String.prototype.php_urlencode=function(){return encodeURIComponent(this).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")};String.prototype.php_htmlspecialchars=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};
String.prototype.php_unhtmlspecialchars=function(){return this.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};String.prototype.php_addslashes=function(){return this.replace(/\\/g,"\\\\").replace(/'/g,"\\'")};String.prototype._replaceEntities=function(a,b,c){return String.fromCharCode(parseInt(c))};String.prototype.removeEntities=function(){return this.replace(/&(amp;)?#(\d+);/g,this._replaceEntities)};
String.prototype.easyReplace=function(a){var b=this;for(c in a){var c=c.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");b=b.replace(new RegExp("%"+c+"%","g"),a[c])}return b};function php_str_repeat(a,b){return 1>b?"":a+php_str_repeat(a,b-1)}
function reqWin(a,b,c,d){b&&.8*self.screen.availWidth<b||c&&.8*self.screen.availHeight<c?(d=!1,b=Math.min(b,.8*self.screen.availWidth),c=Math.min(c,.8*self.screen.availHeight)):d="boolean"===typeof d&&!0===d;window.open(a,"requested_popup","toolbar=no,location=no,status=no,menubar=no,scrollbars="+(d?"no":"yes")+",width="+(b?b:480)+",height="+(c?c:220)+",resizable=no");return!1}
function reqOverlayDiv(a,b,c){b="string"===typeof b?b:help_popup_heading_text;b=new smc_Popup({heading:b,content:'<div class="centertext"><i class="icon icon-spin icon-big i-spinner"></i></div>',icon:"string"===typeof c?c:"i-help"});var d=$("#"+b.popup_id).find(".popup_content");$.ajax({url:a,type:"GET",dataType:"html"}).done(function(a,b,c){a=$('<div id="temp_help">').html(a).find('a[href$="self.close();"]').hide().prev("br").hide().parent().html();d.html(a)}).fail(function(a,b,c){d.html(b)});return!1}
function smc_Popup(a){this.opt=a;this.popup_id=this.opt.custom_id?this.opt.custom_id:"elk_popup";this.show()}
smc_Popup.prototype.show=function(){var a="popup_window "+(this.opt.custom_class?this.opt.custom_class:"content"),b=this.opt.icon?'<i class="icon '+this.opt.icon+' icon-top"></i> ':"";$("body").append('<div id="'+this.popup_id+'" class="popup_container"><div class="'+a+'" style="max-height: none;"><h3 class="popup_heading"><a href="javascript:void(0);" class="hide_popup icon i-close" title="Close"></a>'+b+this.opt.heading+'</h3><div class="popup_content">'+this.opt.content+"</div></div></div>");this.popup_body=
$("#"+this.popup_id).children(".popup_window");this.popup_body.parent().fadeIn(300);this.popup_body.addClass("in");var c=this;$(document).mouseup(function(a){0===$("#"+c.popup_id).has(a.target).length&&c.hide()}).keyup(function(a){27===a.keyCode&&c.hide()});$("#"+this.popup_id).find(".hide_popup").on("click",function(){return c.hide()});return!1};smc_Popup.prototype.hide=function(){$("#"+this.popup_id).fadeOut(300,function(){$(this).remove()});return!1};
function replaceText(a,b){if("selectionStart"in b){var c=b.value.substr(0,b.selectionStart),d=b.value.substr(b.selectionEnd),e=b.scrollTop,g=0;b.value=c+a+d;b.setSelectionRange&&(b.focus(),is_opera&&null!==a.match(/\n/g)&&(g=a.match(/\n/g).length),b.setSelectionRange(c.length+a.length+g,c.length+a.length+g));b.scrollTop=e}else b.value+=a,b.focus(b.value.length-1)}
function isEmptyText(a){for(a="string"===typeof a?a:a.value;0<a.length&&(" "===a.charAt(0)||"\t"===a.charAt(0));)a=a.substring(1,a.length);for(;0<a.length&&(" "===a.charAt(a.length-1)||"\t"===a.charAt(a.length-1));)a=a.substring(0,a.length-1);return""===a}function submitonce(a){elk_formSubmitted=!0}
function submitThisOnce(a,b){var c=("form"in a?a.form:a).getElementsByTagName("textarea");b="undefined"==typeof b?!0:b;for(var d=0,e=c.length;d<e;d++)c[d].readOnly=b;window.setTimeout(function(){submitThisOnce(a,!1)},1E3);return!elk_formSubmitted}function setInnerHTML(a,b){a&&(a.innerHTML=b)}function getInnerHTML(a){if(a)return a.innerHTML}
function setOuterHTML(a,b){if("outerHTML"in a)a.outerHTML=b;else{var c=document.createRange();c.setStartBefore(a);a.parentNode.replaceChild(c.createContextualFragment(b),a)}}function in_array(a,b){for(var c in b)if(b[c]==a)return!0;return!1}function array_search(a,b){for(var c in b)if(b[c]==a)return c;return null}function selectRadioByName(a,b){if(!("length"in a))return a.checked=!0;for(var c=0,d=a.length;c<d;c++)if(a[c].value===b)return a[c].checked=!0;return!1}
function selectAllRadio(a,b,c,d){for(a=0;a<b.length;a++)void 0!==b[a].name&&b[a].name.substr(0,c.length)==c&&b[a].value==d&&(b[a].checked=!0)}function invertAll(a,b,c,d){for(var e=0;e<b.length;e++)"name"in b[e]&&("string"!==typeof c||b[e].name.substr(0,c.length)===c||b[e].id.substr(0,c.length)===c)&&(!b[e].disabled||"boolean"===typeof d&&d)&&(b[e].checked=a.checked)}
function elk_sessionKeepAlive(){var a=(new Date).getTime();elk_scripturl&&9E5<a-lastKeepAliveCheck&&((new Image).src=elk_prepareScriptUrl(elk_scripturl)+"action=keepalive;time="+a,lastKeepAliveCheck=a);window.setTimeout(function(){elk_sessionKeepAlive()},12E5)}window.setTimeout(function(){elk_sessionKeepAlive()},12E5);
function elk_setThemeOption(a,b,c,d){if(null===d||"undefined"===typeof d)d="";(new Image).src=elk_prepareScriptUrl(elk_scripturl)+"action=jsoption;var="+a+";val="+b+";"+elk_session_var+"="+elk_session_id+d+(null===c?"":"&th="+c)+";time="+(new Date).getTime()}
function hashLoginPassword(a,b,c){"undefined"!==typeof hex_sha256&&-1===a.user.value.indexOf("@")&&(a.passwrd.autocomplete="off",a.hash_passwrd.value=hex_sha256(a.user.value.php_strtolower()+a.passwrd.value),"old_hash_passwrd"in a&&"undefined"!==typeof hex_sha1&&(a.old_hash_passwrd.value=hex_sha1(hex_sha1(a.user.value.php_strtolower()+a.passwrd.value)+b+("undefined"===typeof c?"":c))),a.passwrd.value=a.passwrd.value.replace(/./g,"*"))}
function hashAdminPassword(a,b,c,d){"undefined"!==typeof hex_sha256&&(a.admin_hash_pass.value=hex_sha256(b.php_strtolower()+a.admin_pass.value),a.admin_pass.value=a.admin_pass.value.replace(/./g,"*"))}function hashModeratePassword(a,b,c,d){"undefined"!==typeof hex_sha256&&(a.moderate_hash_pass.value=hex_sha256(b.php_strtolower()+a.moderate_pass.value),a.moderate_pass.value=a.moderate_pass.value.replace(/./g,"*"))}
function expandPages(a,b,c,d,e){var g="",f=0;50<(d-c)/e&&(f=d,d=c+50*e);for(;c<d;c+=e)g+='<a class="navPages" href="'+b.replace(/%1\$d/,c).replace(/%%/g,"%")+'">'+(1+c/e)+"</a> ";0<f&&(g+='<span class="expand_pages" role="menuitem" onclick="expandPages(this, \''+b+"', "+d+", "+f+", "+e+');"> ... </span> ');setOuterHTML(a,g)}function smc_preCacheImage(a){"smc_aCachedImages"in window||(window.smc_aCachedImages=[]);in_array(a,window.smc_aCachedImages)||((new Image).src=a)}
function smc_Cookie(a){this.opt=a;this.oCookies={};this.init()}smc_Cookie.prototype.init=function(){if("cookie"in document&&""!==document.cookie)for(var a=document.cookie.split(";"),b=0,c=a.length;b<c;b++){var d=a[b].split("=");this.oCookies[d[0].replace(/^\s+|\s+$/g,"")]=decodeURIComponent(d[1])}};smc_Cookie.prototype.get=function(a){return a in this.oCookies?this.oCookies[a]:null};smc_Cookie.prototype.set=function(a,b){document.cookie=a+"="+encodeURIComponent(b)};
function elk_Toggle(a){this.opt=a;this.bCollapsed=!1;this.oCookie=null;this.init()}
elk_Toggle.prototype.init=function(){var a=0,b=0;if(!("bToggleEnabled"in this.opt)||this.opt.bToggleEnabled){"oCookieOptions"in this.opt&&this.opt.oCookieOptions.bUseCookie&&(this.oCookie=new smc_Cookie({}),a=this.oCookie.get(this.opt.oCookieOptions.sCookieName),null!==a&&(this.opt.bCurrentlyCollapsed="1"===a));this.opt.bCurrentlyCollapsed&&this.changeState(!0,!0);if("aSwapImages"in this.opt)for(a=0,b=this.opt.aSwapImages.length;a<b;a++){var c=document.getElementById(this.opt.aSwapImages[a].sId);
"object"===typeof c&&null!==c&&("none"===getComputedStyle(c).getPropertyValue("display")&&(c.style.display="inline"),c.instanceRef=this,c.onclick=function(){this.instanceRef.toggle();this.blur()},c.style.cursor="pointer",smc_preCacheImage(this.opt.aSwapImages[a].srcCollapsed))}else if("aSwapClasses"in this.opt)for(a=0,b=this.opt.aSwapClasses.length;a<b;a++)c=document.getElementById(this.opt.aSwapClasses[a].sId),"object"===typeof c&&null!==c&&("none"===getComputedStyle(c).getPropertyValue("display")&&
(c.style.display="block"),c.instanceRef=this,c.onclick=function(){this.instanceRef.toggle();this.blur()},c.style.cursor="pointer");if("aSwapLinks"in this.opt)for(a=0,b=this.opt.aSwapLinks.length;a<b;a++)c=document.getElementById(this.opt.aSwapLinks[a].sId),"object"===typeof c&&null!==c&&("none"===getComputedStyle(c).getPropertyValue("display")&&(c.style.display="inline-block"),c.instanceRef=this,c.onclick=function(){this.instanceRef.toggle();this.blur();return!1})}};
elk_Toggle.prototype.changeState=function(a,b){var c;b="undefined"!==typeof b;!b&&a&&"funcOnBeforeCollapse"in this.opt?(this.tmpMethod=this.opt.funcOnBeforeCollapse,this.tmpMethod(),delete this.tmpMethod):!b&&!a&&"funcOnBeforeExpand"in this.opt&&(this.tmpMethod=this.opt.funcOnBeforeExpand,this.tmpMethod(),delete this.tmpMethod);if("aSwapImages"in this.opt){var d=0;for(c=this.opt.aSwapImages.length;d<c;d++){var e=document.getElementById(this.opt.aSwapImages[d].sId);if("object"===typeof e&&null!==e){var g=
a?this.opt.aSwapImages[d].srcCollapsed:this.opt.aSwapImages[d].srcExpanded;e.src!=g&&(e.src=g);e.alt=e.title=a?this.opt.aSwapImages[d].altCollapsed:this.opt.aSwapImages[d].altExpanded}}}else if("aSwapClasses"in this.opt)for(d=0,c=this.opt.aSwapClasses.length;d<c;d++)e=document.getElementById(this.opt.aSwapClasses[d].sId),"object"===typeof e&&null!==e&&(g=a?this.opt.aSwapClasses[d].classCollapsed:this.opt.aSwapClasses[d].classExpanded,e.className!==g&&(e.className=g),e.title=e.title=a?this.opt.aSwapClasses[d].titleCollapsed:
this.opt.aSwapClasses[d].titleExpanded);if("aSwapLinks"in this.opt)for(d=0,c=this.opt.aSwapLinks.length;d<c;d++)e=document.getElementById(this.opt.aSwapLinks[d].sId),"object"===typeof e&&null!==e&&(e.innerHTML=a?this.opt.aSwapLinks[d].msgCollapsed:this.opt.aSwapLinks[d].msgExpanded);d=0;for(c=this.opt.aSwappableContainers.length;d<c;d++)null!==this.opt.aSwappableContainers[d]&&(e=document.getElementById(this.opt.aSwappableContainers[d]),"object"===typeof e&&null!==e&&(a?$(e).slideUp():$(e).slideDown()));
this.bCollapsed=a;"oCookieOptions"in this.opt&&this.opt.oCookieOptions.bUseCookie&&this.oCookie.set(this.opt.oCookieOptions.sCookieName,this.bCollapsed?"1":"0");!b&&"oThemeOptions"in this.opt&&this.opt.oThemeOptions.bUseThemeSettings&&elk_setThemeOption(this.opt.oThemeOptions.sOptionName,this.bCollapsed?"1":"0","sThemeId"in this.opt.oThemeOptions?this.opt.oThemeOptions.sThemeId:null,"sAdditionalVars"in this.opt.oThemeOptions?this.opt.oThemeOptions.sAdditionalVars:null)};
elk_Toggle.prototype.toggle=function(){this.changeState(!this.bCollapsed)};function ajax_indicator(a){null===ajax_indicator_ele&&(ajax_indicator_ele=document.getElementById("ajax_in_progress"),null===ajax_indicator_ele&&create_ajax_indicator_ele());null!==ajax_indicator_ele&&(ajax_indicator_ele.style.display=a?"block":"none")}
function create_ajax_indicator_ele(){ajax_indicator_ele=document.createElement("div");ajax_indicator_ele.id="ajax_in_progress";var a=document.createElement("a");a.href="javascript:ajax_indicator(false)";var b=document.createElement("img");b.src=elk_images_url+"/icons/quick_remove.png";"undefined"!==typeof ajax_notification_cancel_text&&(b.alt=ajax_notification_cancel_text,b.title=ajax_notification_cancel_text);a.appendChild(b);ajax_indicator_ele.appendChild(a);ajax_indicator_ele.innerHTML+=ajax_notification_text;
document.body.appendChild(ajax_indicator_ele)}function createEventListener(a){"addEventListener"in a||(a.attachEvent?(a.addEventListener=function(b,c,d){a.attachEvent("on"+b,c)},a.removeEventListener=function(b,c,d){a.detachEvent("on"+b,c)}):(a.addEventListener=function(b,c,d){a["on"+b]=c},a.removeEventListener=function(b,c,d){a["on"+b]=null}))}function grabJumpToContent(){getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=xmlhttp;sa=jumpto;xml",onJumpReceived);return!1}
function onJumpReceived(a){var b=[],c,d=a.getElementsByTagName("elk")[0].getElementsByTagName("item");a=0;for(c=d.length;a<c;a++)b[b.length]={id:parseInt(d[a].getAttribute("id")),isCategory:"category"===d[a].getAttribute("type"),name:d[a].firstChild.nodeValue.removeEntities(),is_current:!1,childLevel:parseInt(d[a].getAttribute("childlevel"))};a=0;for(c=aJumpTo.length;a<c;a++)aJumpTo[a].fillSelect(b)}var aJumpTo=[];
function JumpTo(a){this.opt=a;this.dropdownList=null;this.showSelect();createEventListener(this.dropdownList);is_mobile&&is_touch?this.dropdownList.addEventListener("touchstart",grabJumpToContent):this.dropdownList.addEventListener("mouseenter",grabJumpToContent)}JumpTo.prototype.removeAll=function(){for(var a=this.dropdownList.options.length;0<a;a--)this.dropdownList.remove(a-1)};
JumpTo.prototype.showSelect=function(){for(var a="",b=this.opt.iCurBoardChildLevel;0<b;b--)a+=this.opt.sBoardChildLevelIndicator;""!==a&&(a+=this.opt.sBoardPrefix);document.getElementById(this.opt.sContainerId).innerHTML=this.opt.sJumpToTemplate.replace(/%select_id%/,this.opt.sContainerId+"_select").replace(/%dropdown_list%/,"<select "+(!0===this.opt.bDisabled?'disabled="disabled" ':"")+(void 0!==this.opt.sClassName?'class="'+this.opt.sClassName+'" ':"")+'name="'+(void 0!==this.opt.sCustomName?this.opt.sCustomName:
this.opt.sContainerId+"_select")+'" id="'+this.opt.sContainerId+'_select"><option value="'+(void 0!==this.opt.bNoRedirect&&!0===this.opt.bNoRedirect?this.opt.iCurBoardId:"?board="+this.opt.iCurBoardId+".0")+'">'+a+this.opt.sCurBoardName.removeEntities()+"</option></select>&nbsp;"+(void 0!==this.opt.sGoButtonLabel?'<input type="button" class="button_submit" value="'+this.opt.sGoButtonLabel+'" onclick="window.location.href = \''+elk_prepareScriptUrl(elk_scripturl)+"board="+this.opt.iCurBoardId+".0';\" />":
""));this.dropdownList=document.getElementById(this.opt.sContainerId+"_select")};
JumpTo.prototype.fillSelect=function(a){this.removeAll();is_mobile&&is_touch?this.dropdownList.removeEventListener("touchstart",grabJumpToContent):this.dropdownList.removeEventListener("mouseenter",grabJumpToContent);for(var b=document.createDocumentFragment(),c=document.createElement("optgroup"),d=0,e=a.length;d<e;d++){var g="";if(a[d].isCategory)c=document.createElement("optgroup"),c.label=a[d].name,b.appendChild(c);else{var f=a[d].childLevel;for(g="";0<f;f--)g+=this.opt.sBoardChildLevelIndicator;
""!==g&&(g+=this.opt.sBoardPrefix);f=document.createElement("option");var h=document.createElement("span");h.innerHTML=g+a[d].name;a[d].id===this.opt.iCurBoardId&&(f.selected="selected");f.appendChild(h);f.value=this.opt.bNoRedirect?a[d].id:"?board="+a[d].id+".0";c.appendChild(f)}}this.dropdownList.appendChild(b);this.opt.bNoRedirect||(this.dropdownList.onchange=function(){0<this.selectedIndex&&this.options[this.selectedIndex].value&&(window.location.href=elk_scripturl+this.options[this.selectedIndex].value.substr(-1===
elk_scripturl.indexOf("?")||"?"!==this.options[this.selectedIndex].value.substr(0,1)?0:1))});"funcOnBeforeCollapse"in this.opt&&(this.tmpMethod=this.opt.funcOnBeforeCollapse,this.tmpMethod(this),delete this.tmpMethod)};var aIconLists=[];
function IconList(a){this.opt=a;this.bListLoaded=!1;this.funcMousedownHandler=this.oContainerDiv=null;this.funcParent=this;this.iCurTimeout=this.iCurMessageId=0;"sAction"in this.opt&&null!==this.opt.sAction||(this.opt.sAction="messageicons;board="+this.opt.iBoardId);this.initIcons()}
IconList.prototype.initIcons=function(){for(var a=document.images.length-1,b=this.opt.sIconIdPrefix.length;0<=a;a--)document.images[a].id.substr(0,b)===this.opt.sIconIdPrefix&&setOuterHTML(document.images[a],'<div title="'+this.opt.sLabelIconList+'" onclick="'+this.opt.sBackReference+".openPopup(this, "+document.images[a].id.substr(b)+')" onmouseover="'+this.opt.sBackReference+'.onBoxHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onBoxHover(this, false)" style="background: '+this.opt.sBoxBackground+
'; cursor: pointer; padding: 2px; margin: 0 auto; vertical-align: top"><img src="'+document.images[a].src+'" alt="'+document.images[a].alt+'" id="'+document.images[a].id+'" style="vertical-align: top; margin: 0 auto; padding: 0 2px;" /></div>')};
IconList.prototype.onBoxHover=function(a,b){a.style.border=b?this.opt.iBoxBorderWidthHover+"px solid "+this.opt.sBoxBorderColorHover:"";a.style.background=b?this.opt.sBoxBackgroundHover:this.opt.sBoxBackground;a.style.padding=b?2-this.opt.iBoxBorderWidthHover+"px":"2px"};
IconList.prototype.openPopup=function(a,b){this.iCurMessageId=b;this.bListLoaded||null!==this.oContainerDiv||(this.oContainerDiv=document.createElement("div"),this.oContainerDiv.id="iconList",this.oContainerDiv.style.display="none",this.oContainerDiv.style.cursor="pointer",this.oContainerDiv.style.position="absolute",this.oContainerDiv.style.background=this.opt.sContainerBackground,this.oContainerDiv.style.border=this.opt.sContainerBorder,this.oContainerDiv.style.padding="6px 0px",document.body.appendChild(this.oContainerDiv),
ajax_indicator(!0),sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+"action=xmlhttp;sa="+this.opt.sAction+";xml","",this.onIconsReceived),createEventListener(document.body));var c=elk_itemPos(a);this.oContainerDiv.style.top=c[1]+a.offsetHeight+"px";this.oContainerDiv.style.left=c[0]-1+"px";this.oClickedIcon=a;this.bListLoaded&&(this.oContainerDiv.style.display="block");document.body.addEventListener("mousedown",this.onWindowMouseDown,!1)};
IconList.prototype.onIconsReceived=function(a){a=a.getElementsByTagName("elk")[0].getElementsByTagName("icon");for(var b="",c=0,d=a.length;c<d;c++)b+='<span onmouseover="'+this.opt.sBackReference+'.onItemHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onItemHover(this, false);" onmousedown="'+this.opt.sBackReference+".onItemMouseDown(this, '"+a[c].getAttribute("value")+'\');" style="padding: 2px 3px; line-height: 20px; border: '+this.opt.sItemBorder+"; background: "+this.opt.sItemBackground+
'"><img src="'+a[c].getAttribute("url")+'" alt="'+a[c].getAttribute("name")+'" title="'+a[c].firstChild.nodeValue+'" style="vertical-align: middle" /></span>';this.oContainerDiv.innerHTML=b;this.oContainerDiv.style.display="block";this.bListLoaded=!0;is_ie&&(this.oContainerDiv.style.width=this.oContainerDiv.clientWidth+"px");ajax_indicator(!1)};
IconList.prototype.onItemHover=function(a,b){a.style.background=b?this.opt.sItemBackgroundHover:this.opt.sItemBackground;a.style.border=b?this.opt.sItemBorderHover:this.opt.sItemBorder;0!==this.iCurTimeout&&window.clearTimeout(this.iCurTimeout);if(b)this.onBoxHover(this.oClickedIcon,!0);else this.iCurTimeout=window.setTimeout(this.opt.sBackReference+".collapseList();",500)};
IconList.prototype.onItemMouseDown=function(a,b){if(0!==this.iCurMessageId){ajax_indicator(!0);this.tmpMethod=getXMLDocument;var c=this.tmpMethod(elk_prepareScriptUrl(elk_scripturl)+"action=jsmodify;topic="+this.opt.iTopicId+";msg="+this.iCurMessageId+";"+elk_session_var+"="+elk_session_id+";icon="+b+";xml");delete this.tmpMethod;ajax_indicator(!1);c=c.responseXML.getElementsByTagName("elk")[0].getElementsByTagName("message")[0];0===c.getElementsByTagName("error").length&&(this.opt.bShowModify&&0!==
c.getElementsByTagName("modified").length&&null!==document.getElementById("modified_"+this.iCurMessageId)&&(document.getElementById("modified_"+this.iCurMessageId).innerHTML=c.getElementsByTagName("modified")[0].childNodes[0].nodeValue),this.oClickedIcon.getElementsByTagName("img")[0].src=a.getElementsByTagName("img")[0].src)}else this.oClickedIcon.getElementsByTagName("img")[0].src=a.getElementsByTagName("img")[0].src,"sLabelIconBox"in this.opt&&(document.getElementById(this.opt.sLabelIconBox).value=
b)};IconList.prototype.onWindowMouseDown=function(){for(var a=aIconLists.length-1;0<=a;a--)aIconLists[a].funcParent.tmpMethod=aIconLists[a].collapseList,aIconLists[a].funcParent.tmpMethod(),delete aIconLists[a].funcParent.tmpMethod};IconList.prototype.collapseList=function(){this.onBoxHover(this.oClickedIcon,!1);this.oContainerDiv.style.display="none";this.iCurMessageId=0;document.body.removeEventListener("mousedown",this.onWindowMouseDown,!1)};
function elk_itemPos(a){var b=0,c=0;if("offsetParent"in a)for(b=a.offsetLeft,c=a.offsetTop;a.offsetParent&&"object"===typeof a.offsetParent;)a=a.offsetParent,b+=a.offsetLeft,c+=a.offsetTop;else"x"in a&&(b=a.x,c=a.y);return[b,c]}function elk_prepareScriptUrl(a){return-1===a.indexOf("?")?a+"?":a+("?"===a.charAt(a.length-1)||"&"===a.charAt(a.length-1)||";"===a.charAt(a.length-1)?"":";")}var aOnloadEvents=[];
function addLoadEvent(a){"function"!==typeof a||"onload"in window&&"function"===typeof window.onload?0===aOnloadEvents.length?(aOnloadEvents[0]=window.onload,aOnloadEvents[1]=a,window.onload=function(){for(var a=0,c=aOnloadEvents.length;a<c;a++)if("function"===typeof aOnloadEvents[a])aOnloadEvents[a]();else"string"===typeof aOnloadEvents[a]&&eval(aOnloadEvents[a])}):aOnloadEvents[aOnloadEvents.length]=a:window.onload=a}
function elkSelectText(a,b){var c="boolean"===typeof b&&b?document.getElementById(a):a.parentNode.nextSibling;if("object"!==typeof c||null===c)return!1;if("createTextRange"in document.body){var d=document.body.createTextRange();d.moveToElementText(c);d.select()}else if(window.getSelection){d=window.getSelection();var e=document.createRange();e.selectNodeContents(c);d.removeAllRanges();d.addRange(e)}return!1}
function smc_saveEntities(a,b,c){var d;if("string"===typeof c){var e=0;for(d=document.forms[a].elements.length;e<d;e++)document.forms[a].elements[e].id.substr(0,c.length)===c&&(b[b.length]=document.forms[a].elements[e].name)}e=0;for(d=b.length;e<d;e++)b[e]in document.forms[a]&&("undefined"!==typeof post_box_name&&b[e]===post_box_name&&void 0!==$editor_data[post_box_name]?(document.forms[a][b[e]].value=$editor_data[post_box_name].val().replace(/&#/g,"&#38;#"),$editor_data[post_box_name].val(document.forms[a][b[e]].value)):
document.forms[a][b[e]].value=document.forms[a][b[e]].value.replace(/&#/g,"&#38;#"))}function pollOptions(){var a=document.getElementById("poll_expire");isEmptyText(a)||0===a.value?(document.forms[form_name].poll_hide[2].disabled=!0,document.forms[form_name].poll_hide[2].checked&&(document.forms[form_name].poll_hide[1].checked=!0)):document.forms[form_name].poll_hide[2].disabled=!1}
function generateDays(a){a="undefined"!==typeof a?a:"";var b=document.getElementById("day"+a);var c=document.getElementById("year"+a);a=document.getElementById("month"+a);var d=[31,28,31,30,31,30,31,31,30,31,30,31];d[1]=28;0===c.options[c.selectedIndex].value%4&&(d[1]=29);for(c=b.selectedIndex;b.options.length;)b.options[0]=null;a=d[a.value-1];for(d=1;d<=a;d++)b.options[b.length]=new Option(d,d);c<a&&(b.selectedIndex=c)}function toggleLinked(a){a.board.disabled=!a.link_to_board.checked}
function initSearch(){-1!==document.forms.searchform.search.value.indexOf("%u")&&(document.forms.searchform.search.value=decodeURI(document.forms.searchform.search.value))}function selectBoards(a,b,c){for(var d=!0,e=0,g=document.forms.length;e<g;e++)if(document.forms[e].name==b){aForm=document.forms[e];break}if("undefined"!=typeof aForm){for(b=0;b<a.length;b++)d=d&&aForm[c+"["+a[b]+"]"].checked;for(b=0;b<a.length;b++)aForm[c+"["+a[b]+"]"].checked=!d}}
function expandCollapse(a,b,c){a=$("#"+a);b=b||!1;c=c||300;b&&$("#"+b).attr("src",elk_images_url+(!0!==a.is(":hidden")?"/selected.png":"/selected_open.png"));a.slideToggle(c)}function initHighlightSelection(a){$("#"+a+' [name="def_language"]').on("click",function(b){$("#"+a+" .standard_row").removeClass("highlight2");$(this).parent().parent().addClass("highlight2")})}
function doAutoSubmit(a,b,c){var d="undefined"!==typeof c?c:"autoSubmit";if(0===a)document.forms[d].submit();else if(-1===a)return;document.forms[d].cont.value=b+" ("+a+")";a--;setTimeout(function(){doAutoSubmit(a,b,d)},1E3)};/*
 @name      ElkArte Forum
 @copyright ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 @version 1.1
*/
function elk_codefix(){$(".bbc_code").each(function(){var a=$(this);a.get(0).scrollHeight>a.innerHeight()?(a.css("height",a.height()),a.css("max-height","none")):a.css("resize","none")})}
function toggleButtonAJAX(a,b,c){$.ajax({type:"GET",url:a.href+";xml;api",context:document.body,beforeSend:ajax_indicator(!0)}).done(function(d){if(""!==d){var e=$(d).find("elk")[0];if(0===e.getElementsByTagName("error").length){var g=e.getElementsByTagName("text"),f=e.getElementsByTagName("url"),h=e.getElementsByTagName("confirm");if(1===h.length)var k=h[0].firstChild.nodeValue.removeEntities();$("."+a.className.replace(/(list|link)level\d/g,"").trim()).each(function(){1===g.length&&$(this).html("<span>"+
g[0].firstChild.nodeValue.removeEntities()+"</span>");1===f.length&&$(this).attr("href",f[0].firstChild.nodeValue.removeEntities());"undefined"!==typeof k&&eval(b+"= '"+k.replace(/[\\']/g,"\\$&")+"'")})}else 0!==e.getElementsByTagName("text").length&&alert(e.getElementsByTagName("text")[0].firstChild.nodeValue.removeEntities()),0!==e.getElementsByTagName("url").length&&(window.location.href=e.getElementsByTagName("url")[0].firstChild.nodeValue);"undefined"!==typeof c&&c(a,d,e.getElementsByTagName("error"))}}).fail(function(){}).always(function(){ajax_indicator(!1)});
return!1}
function toggleHeaderAJAX(a,b){ajax_indicator(!0);$.ajax({type:"GET",url:a.href+";xml;api",context:document.body,beforeSend:ajax_indicator(!0)}).done(function(a){if(""!==a){var c=$(a).find("elk")[0];0===c.getElementsByTagName("error").length&&(a=c.getElementsByTagName("text"),c=c.getElementsByTagName("body"),$("#"+b+" .pagesection").remove(),$("#"+b+" .topic_listing").remove(),$("#"+b+" .topic_sorting").remove(),1===a.length&&$("#"+b+" #unread_header").html(a[0].firstChild.nodeValue.removeEntities()),1===
c.length&&$('<div class="board_row centertext">{body}</div>'.replace("{body}",c[0].firstChild.nodeValue.removeEntities())).insertAfter("#unread_header"))}}).fail(function(){}).always(function(){ajax_indicator(!1)})}function notifyButton(a){return"undefined"===typeof notification_topic_notice||confirm(notification_topic_notice)?toggleButtonAJAX(a,"notification_topic_notice",function(a,c,d){0<d.length||(a=-1!==a.href.indexOf("sa=on")?1:0,$("input[name='notify']").val(a))}):!1}
function notifyboardButton(a){if("undefined"!==typeof notification_board_notice&&!confirm(notification_board_notice))return!1;toggleButtonAJAX(a,"notification_board_notice");return!1}function unwatchButton(a){toggleButtonAJAX(a);return!1}function markboardreadButton(a){if(!confirm(txt_mark_as_read_confirm))return!1;toggleButtonAJAX(a);$(".new_posts").remove();return!1}
function markallreadButton(a){if(!confirm(txt_mark_as_read_confirm))return!1;toggleButtonAJAX(a);$(".new_posts").remove();$(".board_icon").each(function(){$(this).removeClass("i-board-new i-board-sub").addClass("i-board-off")});$(".board_new_posts").removeClass("board_new_posts");return!1}function markunreadButton(a){if(!confirm(txt_mark_as_read_confirm))return!1;toggleHeaderAJAX(a,"main_content_section");return!1}var relative_time_refresh=0;
function updateRelativeTime(){relative_time_refresh=36E5;$("time").each(function(){var a=new relativeTime(1E3*$(this).data("timestamp"),oRttime.referenceTime);if(a.seconds())$(this).text(oRttime.now),relative_time_refresh=Math.min(relative_time_refresh,1E4);else if(a.minutes()){var b=1<a.deltaTime?oRttime.minutes:oRttime.minute;$(this).text(b.replace("%s",a.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,6E4)}else a.hours()?(b=1<a.deltaTime?oRttime.hours:oRttime.hour,$(this).text(b.replace("%s",
a.deltaTime)),relative_time_refresh=Math.min(relative_time_refresh,36E5)):a.days()?(b=1<a.deltaTime?oRttime.days:oRttime.day,$(this).text(b.replace("%s",a.deltaTime)),relative_time_refresh=Math.min(relative_time_refresh,36E5)):a.weeks()?(b=1<a.deltaTime?oRttime.weeks:oRttime.week,$(this).text(b.replace("%s",a.deltaTime)),relative_time_refresh=Math.min(relative_time_refresh,36E5)):a.months()?(b=1<a.deltaTime?oRttime.months:oRttime.month,$(this).text(b.replace("%s",a.deltaTime)),relative_time_refresh=
Math.min(relative_time_refresh,36E5)):a.years()&&(b=1<a.deltaTime?oRttime.years:oRttime.year,$(this).text(b.replace("%s",a.deltaTime)),relative_time_refresh=Math.min(relative_time_refresh,36E5))});oRttime.referenceTime+=relative_time_refresh;setTimeout(function(){updateRelativeTime()},relative_time_refresh)}
function relativeTime(a,b){if("undefined"===typeof b)this.dateTo=new Date;else if("NaN"==parseInt(b)){var c=b.split(/\D/);this.dateTo=new Date(c[0],--c[1],c[2],c[3],c[4])}else this.dateTo=new Date(b);"NaN"==parseInt(a)?(c=a.split(/\D/),this.dateFrom=new Date(c[0],--c[1],c[2],c[3],c[4])):this.dateFrom=new Date(a);this.time_text="";this.past_time=(this.dateTo-this.dateFrom)/1E3;this.deltaTime=0}relativeTime.prototype.seconds=function(){return 60>this.past_time?(this.deltaTime=this.past_time,!0):!1};
relativeTime.prototype.minutes=function(){return 60<=this.past_time&&60>Math.round(this.past_time/60)?(this.deltaTime=Math.round(this.past_time/60),!0):!1};relativeTime.prototype.hours=function(){return 60<=Math.round(this.past_time/60)&&24>Math.round(this.past_time/3600)?(this.deltaTime=Math.round(this.past_time/3600),!0):!1};relativeTime.prototype.days=function(){return 24<=Math.round(this.past_time/3600)&&7>Math.round(this.past_time/86400)?(this.deltaTime=Math.round(this.past_time/86400),!0):!1};
relativeTime.prototype.weeks=function(){return 7<=Math.round(this.past_time/86400)&&30>Math.round(this.past_time/86400)?(this.deltaTime=Math.round(this.past_time/86400/7),!0):!1};relativeTime.prototype.months=function(){return 30<=Math.round(this.past_time/86400)&&12>Math.round(this.past_time/2592E3)?(this.deltaTime=Math.round(this.past_time/2592E3),!0):!1};
relativeTime.prototype.years=function(){return 12<=Math.round(this.past_time/2592E3)?(this.deltaTime=this.dateTo.getFullYear()-this.dateFrom.getFullYear(),!0):!1};
function revalidateMentions(a,b){for(var c,d,e,g,f=-1,h=/[ \.,;!\?'-\\\/="]/i,k=0,l=all_elk_mentions.length;k<l;k++)if(all_elk_mentions[k].selector===b||all_elk_mentions[k].selector==="#"+b){all_elk_mentions[k].oOptions.isPlugin?(g=$editor_data[all_elk_mentions[k].selector],c=g.opts.mentionOptions.cache.names,d=g.opts.mentionOptions.cache.queries,e=g.getText().replace(/[\u00a0\r\n]/g," "),g=$(g.opts.mentionOptions.cache.mentions)):(c=all_elk_mentions[k].oMention.cached_names,d=all_elk_mentions[k].oMention.cached_queries,
e=document.forms[a][b].value.replace(/[\u00a0\r\n]/g," "),g=$(all_elk_mentions[k].oMention.mentions));e=" "+e+" ";$(g).find("input").each(function(a,b){var c=$(b).data("name");var d=e.indexOf(c);"undefined"!==typeof c&&(-1===d?$(b).remove():(c=e.charAt(d+c.length),d=e.charAt(d-1),""!==c&&0!==c.search(h)?$(b).remove():""!==d&&0!==d.search(h)&&$(b).remove()))});for(var m=0,q=d.length;m<q;m++)for(var n=c[d[m]],p=0,u=n.length;p<u;p++)checkWordOccurrence(e,n[p].name)&&(f=e.indexOf(" @"+n[p].name),-1!==
f&&0===e.charAt(f+2+n[p].name.length+1).search(h)&&g.append($('<input type="hidden" name="uid[]" />').val(n[p].id)))}}function checkWordOccurrence(a,b){return(new RegExp("\\b"+b+"\\b","i")).test(a)}var all_elk_mentions=[];function add_elk_mention(a,b){all_elk_mentions.hasOwnProperty(a)||("undefined"===typeof b&&(b={}),b.selector=a,all_elk_mentions[all_elk_mentions.length]={selector:a,oOptions:b})}
(function(a){a.fn.elkSortable=function(b){a.fn.elkSortable.oDefaultsSettings={opacity:.7,cursor:"move",axis:"y",scroll:!0,containment:"parent",delay:150,handle:"",href:"",tolerance:"intersect",setorder:"serialize",placeholder:"",preprocess:"",tag:"#table_grid_sortable",connect:"",sa:"",title:"",error:"",token:""};var c=a.extend({},a.fn.elkSortable.oDefaultsSettings,b||{});"undefined"===typeof c.infobar&&(c.infobar=new ElkInfoBar("sortable_bar",{error_class:"errorbox",success_class:"infobox"}));a("<div id='errorContainer'><div/>").appendTo("body");
a("#errorContainer").css({display:"none"});a(c.tag).sortable({opacity:c.opacity,cursor:c.cursor,axis:c.axis,handle:c.handle,containment:c.containment,connectWith:c.connect,placeholder:c.placeholder,tolerance:c.tolerance,delay:c.delay,scroll:c.scroll,helper:function(b,e){var d=e.children(),f=e.clone();f.children().each(function(){a(this).replaceWith(function(){return a("<span />",{html:a(this).html()})})});f.children().each(function(b){return a(this).width(d.eq(b).width()).css("display","inline-block")});
a("body").append('<div id="clone" class="'+c.placeholder+'">'+f.html()+"</div>");var h=a("#clone");h.hide();setTimeout(function(){h.appendTo(e.parent());h.show()},1);return h},update:function(b,e){var d="",f=e.item.attr("id"),h=[],k=e.item.parent().attr("id");if(""!==c.preprocess)window[c.preprocess]();"inorder"===c.setorder?(a(c.tag).find("li").each(function(){var b=a(this).attr("id").split("_");h.push({name:b[0]+"[]",value:b[1]})}),d=a.param(h)):a(c.tag).each(function(){d=""===d?d+a(this).sortable(c.setorder):
d+("&"+a(this).sortable(c.setorder))});d+="&"+elk_session_var+"="+elk_session_id;d+="&order=reorder";d+="&moved="+f;d+="&received="+k;""!==c.token&&(d+="&"+c.token.token_var+"="+c.token.token_id);a.ajax({type:"POST",url:elk_scripturl+"?action=xmlhttp;sa="+c.sa+";xml",dataType:"xml",data:d}).fail(function(a,b,d){c.infobar.isError();c.infobar.changeText(b).showBar();""!==c.href&&setTimeout(function(){window.location.href=elk_scripturl+c.href},1E3)}).done(function(b,d,e){e=a("#errorContent");var f=a("#errorContainer");
0!==a(b).find("error").length?(f.append('<p id="errorContent"></p>'),e.html(a(b).find("error").text()),e.dialog({autoOpen:!0,title:c.title,modal:!0,close:function(a,b){""!==c.href&&(window.location.href=elk_scripturl+c.href)}})):0!==a(b).find("elk").length?(c.infobar.isSuccess(),c.infobar.changeText(a(b).find("elk > orders > order").text()).showBar()):(f.append('<p id="errorContent"></p>'),e.html(c.error+" : "+d),e.dialog({autoOpen:!0,title:c.title,modal:!0}))}).always(function(b,d,e){0!==a(b).find("elk > tokens > token").length&&
(c.token.token_id=a(b).find("tokens").find('[type="token"]').text(),c.token.token_var=a(b).find("tokens").find('[type="token_var"]').text())})}})}})(jQuery);
function setBoardIds(){$("[id^=category_]").each(function(){var a=$(this).attr("id").split("category_"),b=$(this).find("ul");1===b.length?0===$(b).find("li").length?$(b).append('<li id="cbp_'+a+',-1,-1"></li>'):$(b).find("li:not(:has(ul))").append('<ul class="nolist elk_droppings"></ul>'):$(b).find("li:not(:has(ul))").append('<ul class="nolist elk_droppings"></ul>');$(this).find("ul:parent").each(function(b,d){var c=$(this).parent("li").attr("id"),g=0;"undefined"!==typeof c&&(g=c.split(","),g=g[1]);
$(this).find("li").each(function(b,c){var d=$(c).attr("id").split(",");$(c).removeAttr("id");d="cbp_"+a[1]+","+d[1]+","+g;$(c).attr("id",d)})})})}
(function(a){a.fn.expand_pages=function(){function b(c){var d=a(c.closest(".linavPages")),e=d.prev().clone(),g=e.find("a").clone(),f=c.clone(),h=c.data("perpage"),k=c.data("firstpage"),l=c.data("lastpage"),m=c.data("baseurl");c=eval(c.data("baseurl"));var q,n=0,p=0;10<(l-k)/h&&(p=l,l=k+10*h);for(n=l;n>k;n-=h){var u=g.clone(),r=e.clone();u.attr("href",c.replace("%1$d",n-h)).text(n/h);r.find("a").each(function(){a(this).replaceWith(u[0])});d.after(r);"undefined"===typeof q&&(q=r)}d.remove();0<p&&(f.find("#expanded_pages_container").each(function(){a(this).remove()}),
f.on("click",function(c){var d=a(this);c.preventDefault();b(d);d.off("mouseenter focus")}).on("mouseenter focus",function(){hover_expand(a(this))}).data("perpage",h).data("firstpage",l).data("lastpage",p).data("baseurl",m),q.after(f))}this.attr("tabindex",0).on("click",function(c){var d=a(this);c.preventDefault();b(d)})}})(jQuery);
(function(a){a.fn.SiteTooltip=function(b){a.fn.SiteTooltip.oDefaultsSettings={followMouse:1,hoverIntent:{sensitivity:10,interval:650,timeout:50},positionTop:12,positionLeft:12,tooltipID:"site_tooltip",tooltipTextID:"site_tooltipText",tooltipClass:"tooltip",tooltipSwapClass:"site_swaptip",tooltipContent:"html"};var c=a.extend({},a.fn.SiteTooltip.oDefaultsSettings,b||{});a(this).each(function(){var b=a('<span class="'+c.tooltipSwapClass+'">'+this.title+"</span>").hide();a(this).append(b).attr("title",
"")});var d=function(b){var d=0,e=0,g=a("#"+c.tooltipID);b||(b=window.event);if(b.pageX||b.pageY)d=b.pageX,e=b.pageY;else if(b.clientX||b.clientY)d=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=b.clientY+document.body.scrollTop+document.documentElement.scrollTop;b=d+c.positionLeft;e+=c.positionTop;d=g.width();var l=g.height(),m=a(window).scrollLeft(),q=a(window).scrollTop(),n=a(window).width()-24,p=a(window).height()-24;e+l>q+p&&b+d>m+n?(b=b-d-45,e=e-l-45):b+d>m+n?b-=b+
d-(m+n)+24:e+l>q+p&&(e-=e+l-(q+p)+24);g.css({left:b+"px",top:e+"px"})},e=function(){a("#"+c.tooltipID).fadeOut(175,function(){a(this).trigger("unload").remove()})};return this.each(function(){function b(b){if(a(this).children("."+c.tooltipSwapClass).text()){a("body").append('<div id="'+c.tooltipID+'" class="'+c.tooltipClass+'"><div id="'+c.tooltipTextID+'" class="hide"></div></div>');var e=a("#"+c.tooltipTextID);"html"===c.tooltipContent?e.html(a(this).children("."+c.tooltipSwapClass).html()):e.text(a(this).children("."+
c.tooltipSwapClass).text());a("#"+c.tooltipID+" #"+c.tooltipTextID).slideDown(150);d(b)}return!1}function f(a){e(this);return!1}a.fn.hoverIntent?a(this).hoverIntent({sensitivity:c.hoverIntent.sensitivity,interval:c.hoverIntent.interval,over:b,timeout:c.hoverIntent.timeout,out:f}):a(this).hover(b,f);if(c.followMouse)a(this).on("mousemove",function(a){d(a);return!1});a(this).on("click",function(){e(this);return!0})})}})(jQuery);var error_txts={};
function errorbox_handler(a){this.opt=a;this.oError_box=null;this.oErrorHandle=window;this.evaluate=!1;this.init()}
errorbox_handler.prototype.init=function(){void 0!==this.opt.check_id?this.oChecks_on=$(document.getElementById(this.opt.check_id)):void 0!==this.opt.selector?this.oChecks_on=this.opt.selector:void 0!==this.opt.editor&&(this.oChecks_on=eval(this.opt.editor),this.evaluate=!0);this.oErrorHandle.instanceRef=this;null===this.oError_box&&(this.oError_box=$(document.getElementById(this.opt.error_box_id)));if(!1===this.evaluate)this.oChecks_on.attr("onblur",this.opt.self+".checkErrors()"),this.oChecks_on.attr("onkeyup",
this.opt.self+".checkErrors()");else{var a=this.opt.self;$(function(){var b=eval(a);$editor_data[b.opt.editor_id].addEvent(b.opt.editor_id,"keyup",function(){b.checkErrors()})})}};errorbox_handler.prototype.boxVal=function(){return!1===this.evaluate?this.oChecks_on.val():this.oChecks_on()};
errorbox_handler.prototype.checkErrors=function(){var a=this.opt.error_checks.length;if(0!==a){for(var b=0;b<a;b++){var c=$(document.getElementById(this.opt.error_box_id+"_"+this.opt.error_checks[b].code));this.opt.error_checks[b].efunction(this.boxVal())?this.addError(c,this.opt.error_checks[b].code):this.removeError(this.oError_box,c)}this.oError_box.attr("class","errorbox")}0===this.oError_box.find("li").length?this.oError_box.slideUp():this.oError_box.slideDown()};
errorbox_handler.prototype.addError=function(a,b){0===a.length&&(""===$.trim(this.oError_box.children("#"+this.opt.error_box_id+"_list").html())&&this.oError_box.append("<ul id='"+this.opt.error_box_id+"_list'></ul>"),$(document.getElementById(this.opt.error_box_id+"_list")).append('<li style="display:none;" id=\''+this.opt.error_box_id+"_"+b+"' class='error'>"+error_txts[b]+"</li>"),$(document.getElementById(this.opt.error_box_id+"_"+b)).slideDown())};
errorbox_handler.prototype.removeError=function(a,b){0!==b.length&&b.slideUp(function(){b.remove();0===a.find("li").length&&a.slideUp()})};
function addAnotherOption(a,b,c,d){b.type=b.type||"text";b["class"]=b["class"]||"input_text";b.size=b.size||"20";c.type=c.type||"text";c["class"]=c["class"]||"input_text";c.size=c.size||"20";d=d||"";var e=document.createElement("dt"),g=document.createElement("input");g.name=b.name;g.type=b.type;g.setAttribute("class",b["class"]);g.size=b.size;e.appendChild(g);b=document.createElement("dd");g=""===d?document.createElement("input"):document.createElement("select");g.name=c.name;g.type=c.type;g.size=
c.size;g.setAttribute("class",c["class"]);b.appendChild(g);if(""!==d){var f;for(f in d){var h=d[f];c=document.createElement("option");c.name="option";c.value=h.id;c.innerHTML=h.name;g.appendChild(c)}}a=document.getElementById(a);a.parentNode.insertBefore(e,a);a.parentNode.insertBefore(b,a)}
function toggle_mlsearch_opt(){var a=$("#mlsearch_options");a.is(":visible")||(a.fadeIn("fast"),$("body").on("click",mlsearch_opt_hide),$("#mlsearch_options, #mlsearch_input").off("click",mlsearch_opt_hide).on("click",function(a){a.stopPropagation()}))}function mlsearch_opt_hide(){$("body").off("click",mlsearch_opt_hide);$("#mlsearch_options").slideToggle("fast")}
function loadAddNewPoll(a,b,c){if("undefined"===typeof b)return!0;var d=$("#post_header").closest("form"),e=$("#poll_main, #poll_options");if($(a).val()===poll_add){if($(a).val(poll_remove),a=$("#icon"),"xx"===a.val()&&a.val("poll").change(),d.attr("action",d.attr("action")+";poll"),0<$("#poll_main").length)return e.find("input").each(function(){"required"===$(this).data("required")&&$(this).attr("required","required")}),e.toggle(),!1}else return b=$("#icon"),"poll"===b.val()&&b.val("xx").change(),
d.attr("action",d.attr("action").replace(";poll","")),e.hide().find("input").each(function(){"required"===$(this).attr("required")&&($(this).data("required","required"),$(this).removeAttr("required"))}),$(a).val(poll_add),!1;$.ajax({url:elk_scripturl+"?action=poll;sa=interface;xml;board="+b,type:"GET",dataType:"html",beforeSend:ajax_indicator(!0)}).done(function(a,b,d){var e=0;b=0;for(d=document.forms[c].elements.length;b<d;b++)e=Math.max(e,document.forms[c].elements[b].tabIndex);$("#post_header").after(a);
$("#poll_main input, #poll_options input").each(function(){$(this).attr("tabindex",++e)});$("#poll_main legend, #poll_options legend").on("click",function(){$(this).siblings().slideToggle("fast");$(this).parent().toggleClass("collapsed")}).each(function(){$(this).data("collapsed")&&($(this).siblings().css({display:"none"}),$(this).parent().toggleClass("collapsed"))})}).always(function(){ajax_indicator(!1)});return!1}
function disableAutoComplete(){window.onload=function(){$("input[type=email], input[type=password], .input_text, .input_clear").attr("autocomplete","off");setTimeout(function(){$("input[type=password], .input_clear").val(" ").val("")},1)}}
(function(){var a=function(a){a=a?a:{};var b=[],d=0,e=function(a){for(var c=0;c<b.length;c++)b[c].send(a)},g=function(){0!==b.length&&$.ajax({url:elk_scripturl+"?action=mentions;sa=fetch;api=json;lastsent="+d}).done(function(b){""!==b&&(e(b),d=b.timelast);setTimeout(function(){g()},a.delay)})};(function(a){"undefined"===typeof a.delay&&(a.delay=15E3);setTimeout(function(){g()},a.delay)})(a);return{add:function(a){b.push(a)}}};"undefined"!==typeof define&&define.amd?define([],function(){return a}):
"undefined"!==typeof module&&module.exports?module.exports=a:this.ElkNotifications=a})();var ElkNotifier=new ElkNotifications;
(function(){var a=function(a,c,d){$.extend(d,{inlineSelector:".inline_insert",data:"attachid",addAfter:"label"});var b=[];return{addInterface:function(a,e){if("undefined"!==typeof d.trigger)var f=d.trigger.clone();else f=$("<a />"),"undefined"!==typeof d.triggerClass&&f.addClass(d.triggerClass);f.on("click",function(a){a.preventDefault();$editor_data[c].insertText("[attach]"+e+"[/attach]",!1,!0)}).attr("id","inline_attach_"+e).data("attachid",e);a.after(f);b.push(f)},removeAttach:function(a){var c=
[],d;for(d=0;d<b.length&&b[d].data("attachid")!=a;d++)c.push(b[d]);for(d++;d<b.length;d++)c.push(b[d]);b=c;$("#inline_attach_"+a).remove()}}};"undefined"!==typeof define&&define.amd?define([],function(){return a}):"undefined"!==typeof module&&module.exports?module.exports=a:this.ElkInlineAttachments=a})();
(function(){var a=function(a,c){c=$.extend({text:"","class":"ajax_infobar",hide_delay:4E3,error_class:"error",success_class:"success"},c);var b=$("#"+a),e=null,g=function(a){b.addClass(a);return this},f=function(a){b.removeClass(a);return this},h=function(){clearTimeout(e);b.slideUp();return this};(function(a,c){clearTimeout(e);0===b.length&&(b=$('<div id="'+a+'" class="'+c["class"]+' hide" />'),$("body").append(b),b.attr("id",a),b.addClass(c["class"]),b.text(c.text))})(a,c);return{changeText:function(a){clearTimeout(e);
b.html(a);return this},addClass:g,removeClass:f,showBar:function(){clearTimeout(e);b.fadeIn();0!==c.hide_delay&&(e=setTimeout(function(){h()},c.hide_delay));return this},isError:function(){f(c.success_class);g(c.error_class)},isSuccess:function(){f(c.error_class);g(c.success_class)},hide:h}};"undefined"!==typeof define&&define.amd?define([],function(){return a}):"undefined"!==typeof module&&module.exports?module.exports=a:this.ElkInfoBar=a})();$(function(){use_click_menu?$("#main_menu, ul.admin_menu, ul.sidebar_menu, ul.poster, ul.quickbuttons, #sort_by").superclick({speed:150,animation:{opacity:"show",height:"toggle"},speedOut:0,activeClass:"sfhover"}):$("#main_menu, ul.admin_menu, ul.sidebar_menu, ul.poster, ul.quickbuttons, #sort_by").superfish({delay:300,speed:175,hoverClass:"sfhover"});$("a[href='#top']").on("click",function(a){a.preventDefault();$("html,body").animate({scrollTop:0},1200)});$("a[href='#bot']").on("click",function(a){a.preventDefault();
a=$("#bot");var b=a.height();$("html,body").animate({scrollTop:a.offset().top+b-$(window).height()},1200)});(!is_mobile&&!is_touch||use_click_menu)&&$(".preview").SiteTooltip({hoverIntent:{sensitivity:10,interval:750,timeout:50}});$("a.bbc_link img.bbc_img").parent().css("border","0");"function"===typeof elk_codefix&&elk_codefix();$(".expand_pages").expand_pages();$(document).on("click","legend",function(){$(this).siblings().slideToggle("fast");$(this).parent().toggleClass("collapsed")});$("legend",
function(){$(this).data("collapsed")&&$(this).click()});$(".spoilerheader").click(function(){$(this).next().children().slideToggle("fast")});$("[data-lightboximage]").on("click.elk_lb",function(a){a.preventDefault();expandThumbLB($(this).data("lightboximage"),$(this).data("lightboxmessage"))});$("img").each(function(){if(!1===$(this).hasClass("bbc_img resized"))return!0;$(this).css({cursor:"pointer"});$(this).on("click.elk_bbc",function(){var a=$(this);$.isEmptyObject(a.data("bbc_img"))?(a.data("bbc_img",
{width:a.css("width"),height:a.css("height"),"max-width":a.css("max-width"),"max-height":a.css("max-height")}),a.css({width:"auto"===a.css("width")?null:"auto"}),a.css({height:"auto"===a.css("height")?null:"auto"}),a.css({"max-height":"none"}),a.css({"max-width":"100%"}),a.wrap('<div style="overflow:auto;display:inline-block;"></div>')):(a.css({width:a.data("bbc_img").width}),a.css({height:a.data("bbc_img").height}),a.css({"max-width":a.data("bbc_img")["max-width"]}),a.css({"max-height":a.data("bbc_img")["max-height"]}),
a.removeData("bbc_img"),a.unwrap(),a.css({"max-width":"100%"}))})});$(".hamburger_30").click(function(a){a.preventDefault();a=$(this).data("id");$("#"+a).addClass("visible");$(this).addClass("visible")})});
function elk_addButton(a,b,c){a=document.getElementById(a);b=a.getElementsByTagName("span");0<b.length&&(b=b[b.length-1],b.className=b.className.replace(/\s*last/,"position_holder"));a=a.getElementsByTagName("ul")[0];b=document.createElement("li");var d=document.createAttribute("role");d.value="menuitem";b.setAttributeNode(d);"sId"in c&&(b.id=c.sId);b.innerHTML='<a class="linklevel1" href="'+c.sUrl+'" '+("sCustom"in c?c.sCustom:"")+'><span class="last"'+("sId"in c?' id="'+c.sId+'_text"':"")+">"+c.sText+
"</span></a>";a.appendChild(b)};function elk_PersonalMessageSend(a){this.opt=a;this.oToListContainer=this.oBccAutoSuggest=this.oToAutoSuggest=this.oBccDiv2=this.oBccDiv=null;this.init()}
elk_PersonalMessageSend.prototype.init=function(){if(!this.opt.bBccShowByDefault){this.oBccDiv=document.getElementById(this.opt.sBccDivId);this.oBccDiv.style.display="none";this.oBccDiv2=document.getElementById(this.opt.sBccDivId2);this.oBccDiv2.style.display="none";var a=document.getElementById(this.opt.sBccLinkContainerId);a.style.display="inline";a.innerHTML=this.opt.sShowBccLinkTemplate;a=document.getElementById(this.opt.sBccLinkId);a.instanceRef=this;a.onclick=function(){this.instanceRef.showBcc();
return!1}}document.getElementById(this.opt.sToControlId);this.oToAutoSuggest=new smc_AutoSuggest({sSelf:this.opt.sSelf+".oToAutoSuggest",sSessionId:this.opt.sSessionId,sSessionVar:this.opt.sSessionVar,sSuggestId:"to_suggest",sControlId:this.opt.sToControlId,sSearchType:"member",sPostName:"recipient_to",sURLMask:"action=profile;u=%item_id%",sTextDeleteItem:this.opt.sTextDeleteItem,bItemList:!0,sItemListContainerId:"to_item_list_container",aListItems:this.opt.aToRecipients});this.oToAutoSuggest.registerCallback("onBeforeAddItem",
this.opt.sSelf+".callbackAddItem");this.oBccAutoSuggest=new smc_AutoSuggest({sSelf:this.opt.sSelf+".oBccAutoSuggest",sSessionId:this.opt.sSessionId,sSessionVar:this.opt.sSessionVar,sSuggestId:"bcc_suggest",sControlId:this.opt.sBccControlId,sSearchType:"member",sPostName:"recipient_bcc",sURLMask:"action=profile;u=%item_id%",sTextDeleteItem:this.opt.sTextDeleteItem,bItemList:!0,sItemListContainerId:"bcc_item_list_container",aListItems:this.opt.aBccRecipients});this.oBccAutoSuggest.registerCallback("onBeforeAddItem",
this.opt.sSelf+".callbackAddItem")};elk_PersonalMessageSend.prototype.showBcc=function(){this.oBccDiv.style.display="block";this.oBccDiv2.style.display="block"};elk_PersonalMessageSend.prototype.callbackAddItem=function(a,b){this.oToAutoSuggest.deleteAddedItem(b);this.oBccAutoSuggest.deleteAddedItem(b);return!0};
function loadLabelChoices(){var a=document.forms.pmFolder.elements,b=document.forms.pmFolder.pm_action,c={length:0},d={length:0};if(0!==b.childNodes.length){if(!("-1"in allLabels))for(var e=0;e<b.options.length;e++)"rem_"===b.options[e].value.substr(0,4)&&(allLabels[b.options[e].value.substr(4)]=b.options[e].text);for(e=0;e<a.length;e++)if("pms[]"===a[e].name&&a[e].checked){var g=[],f;for(f in currentLabels[a[e].value])f in d||(d[f]=allLabels[f],d.length++),g[f]=allLabels[f];for(f in allLabels)f in
g||(c[f]=allLabels[f],c.length++)}for(;2<b.options.length;)b.options[2]=null;if(0!==c.length)for(e in b.options[b.options.length]=new Option(txt_pm_msg_label_apply),b.options[b.options.length-1].innerHTML=txt_pm_msg_label_apply,b.options[b.options.length-1].className="jump_to_header",b.options[b.options.length-1].disabled=!0,c)"length"!==e&&(b.options[b.options.length]=new Option(c[e],"add_"+e));if(0!==d.length)for(e in b.options[b.options.length]=new Option(txt_pm_msg_label_remove),b.options[b.options.length-
1].innerHTML=txt_pm_msg_label_remove,b.options[b.options.length-1].className="jump_to_header",b.options[b.options.length-1].disabled=!0,d)"length"!==e&&(b.options[b.options.length]=new Option(d[e],"rem_"+e))}}
function rebuildRuleDesc(){var a="",b="",c=!1,d=!1,e=!1;"string"===typeof groups&&(groups=JSON.parse(groups));"string"===typeof labels&&(labels=JSON.parse(labels));"string"===typeof rules&&(rules=JSON.parse(rules));for(var g=0;g<document.forms.addrule.elements.length;g++){if("ruletype"===document.forms.addrule.elements[g].id.substr(0,8)){var f=d?"and"===document.getElementById("logic").value?" "+txt_pm_readable_and+" ":" "+txt_pm_readable_or+" ":"";d=!0;var h=document.forms.addrule.elements[g].id.match(/\d+/);
var k=document.forms.addrule.elements[g].value;h="gid"===k?document.getElementById("ruledefgroup"+h).value.php_htmlspecialchars():"bud"!==k?document.getElementById("ruledef"+h).value.php_htmlspecialchars():"";"mid"===k&&h?a+=f+txt_pm_readable_member.replace("{MEMBER}",h):"gid"===k&&h&&groups[h]?a+=f+txt_pm_readable_group.replace("{GROUP}",groups[h]):"sub"===k&&h?a+=f+txt_pm_readable_subject.replace("{SUBJECT}",h):"msg"===k&&h?a+=f+txt_pm_readable_body.replace("{BODY}",h):"bud"!==k||c||(a+=f+txt_pm_readable_buddy,
c=!0)}"acttype"===document.forms.addrule.elements[g].id.substr(0,7)&&(f=e?" "+txt_pm_readable_and+" ":"",e=!0,h=document.forms.addrule.elements[g].id.match(/\d+/),k=document.forms.addrule.elements[g].value,h="lab"===k?document.getElementById("labdef"+h).value.php_htmlspecialchars():"","lab"===k&&h&&labels[h]?b+=f+txt_pm_readable_label.replace("{LABEL}",labels[h]):"del"===k&&(b+=f+txt_pm_readable_delete))}""!==a&&d?(""!==b&&(a+=" "+txt_pm_readable_then+" "+b),a=txt_pm_readable_start+a+txt_pm_readable_end):
a=txt_pm_rule_not_defined;document.getElementById("ruletext").innerHTML=a}
function initUpdateRulesActions(){var a=$("#criteria"),b=$("#actions");a.on("change",'[name^="ruletype"]',function(){var a=$(this).data("optnum");"gid"===document.getElementById("ruletype"+a).value?(document.getElementById("defdiv"+a).style.display="none",document.getElementById("defseldiv"+a).style.display="inline"):("bud"===document.getElementById("ruletype"+a).value||""===document.getElementById("ruletype"+a).value?document.getElementById("defdiv"+a).style.display="none":document.getElementById("defdiv"+
a).style.display="inline",document.getElementById("defseldiv"+a).style.display="none")});b.on("change",'[name^="acttype"]',function(){var a=$(this).data("actnum");"lab"===document.getElementById("acttype"+a).value?document.getElementById("labdiv"+a).style.display="inline":document.getElementById("labdiv"+a).style.display="none"});a.find('[name^="ruletype"]').change();b.find('[name^="acttype"]').change();a.on("change keyup",'[name^="ruletype"], [name^="ruledefgroup"], [name^="ruledef"], [name^="acttype"], [name^="labdef"], #logic',
function(){rebuildRuleDesc()});$("#criteria, #actions").on("change keyup",'[name^="ruletype"], [name^="ruledefgroup"], [name^="ruledef"], [name^="acttype"], [name^="labdef"], #logic',function(){rebuildRuleDesc()});rebuildRuleDesc()}
function addCriteriaOption(){if(0===criteriaNum)for(var a=0;a<document.forms.addrule.elements.length;a++)"ruletype"===document.forms.addrule.elements[a].id.substr(0,8)&&criteriaNum++;criteriaNum++;"string"===typeof groups&&(groups=JSON.parse(groups));"string"===typeof labels&&(labels=JSON.parse(labels));"string"===typeof rules&&(rules=JSON.parse(rules));var b=a="";for(b in rules)rules.hasOwnProperty(b)&&(a+='<option value="'+b+'">'+rules[b]+"</option>");var c="";for(b in groups)c+='<option value="'+
b+'">'+groups[b]+"</option>";setOuterHTML(document.getElementById("criteriaAddHere"),'<br /><select class="criteria" name="ruletype['+criteriaNum+']" id="ruletype'+criteriaNum+'" data-optnum="'+criteriaNum+'"><option value="">'+txt_pm_rule_criteria_pick+":</option>"+a+'</select>&nbsp;<span id="defdiv'+criteriaNum+'" class="hide"><input type="text" name="ruledef['+criteriaNum+']" id="ruledef'+criteriaNum+'" value="" class="input_text" /></span><span id="defseldiv'+criteriaNum+'" class="hide"><select class="criteria" name="ruledefgroup['+
criteriaNum+']" id="ruledefgroup'+criteriaNum+'"><option value="">'+txt_pm_rule_sel_group+"</option>"+c+'</select></span><span id="criteriaAddHere"></span>');return!1}
function addActionOption(){if(0===actionNum)for(var a=0;a<document.forms.addrule.elements.length;a++)"acttype"===document.forms.addrule.elements[a].id.substr(0,7)&&actionNum++;actionNum++;var b=a="";"string"===typeof labels&&(labels=JSON.parse(labels));for(b in labels)a+='<option value="'+b+'">'+labels[b]+"</option>";setOuterHTML(document.getElementById("actionAddHere"),'<br /><select name="acttype['+actionNum+']" id="acttype'+actionNum+'" data-actnum="'+actionNum+'"><option value="">'+txt_pm_rule_sel_action+
':</option><option value="lab">'+txt_pm_rule_label+'</option><option value="del">'+txt_pm_rule_delete+'</option></select>&nbsp;<span id="labdiv'+actionNum+'" class="hide"><select name="labdef['+actionNum+']" id="labdef'+actionNum+'"><option value="">'+txt_pm_rule_sel_label+"</option>"+a+'</select></span><span id="actionAddHere"></span>')};function smc_AutoSuggest(a){this.opt=a;this.oTextHandle=document.getElementById(this.opt.sControlId);this.oSuggestDivHandle=this.oRealTextHandle=null;this.sLastDirtySearch=this.sLastSearch="";this.oSelectedDiv=null;this.aCache=[];this.aDisplayData=[];this.sRetrieveURL="sRetrieveURL"in this.opt?this.opt.sRetrieveURL:"%scripturl%action=suggest;xml";this.iMaxDisplayQuantity="iMaxDisplayQuantity"in this.opt?this.opt.iMaxDisplayQuantity:12;this.iMinimumSearchChars="iMinimumSearchChars"in this.opt?this.opt.iMinimumSearchChars:
2;this.bItemList="bItemList"in this.opt?this.opt.bItemList:!1;this.aListItems="aListItems"in this.opt?this.opt.aListItems:[];this.sItemTemplate="sItemTemplate"in this.opt?this.opt.sItemTemplate:'<input type="hidden" name="%post_name%[]" value="%item_id%" /><a href="%item_href%" class="extern" onclick="window.open(this.href, \'_blank\'); return false;">%item_name%</a>&nbsp;<img src="%images_url%/pm_recipient_delete.png" alt="%delete_text%" title="%delete_text%" onclick="return %self%.deleteAddedItem(%item_id%)" />';
this.sTextDeleteItem="sTextDeleteItem"in this.opt?this.opt.sTextDeleteItem:"";this.oCallback={};this.bDoAutoAdd=!1;this.iItemCount=0;this.oHideTimer=null;this.bPositionComplete=!1;this.oXmlRequestHandle=null;addLoadEvent(this.opt.sSelf+".init();")}
smc_AutoSuggest.prototype.init=function(){this.oSuggestDivHandle=document.createElement("div");this.oSuggestDivHandle.className="auto_suggest_div";document.body.appendChild(this.oSuggestDivHandle);this.oRealTextHandle=document.createElement("input");this.oRealTextHandle.type="hidden";this.oRealTextHandle.name=this.oTextHandle.name;this.oRealTextHandle.value=this.oTextHandle.value;this.oTextHandle.form.appendChild(this.oRealTextHandle);this.oTextHandle.name="dummy_"+Math.floor(1E6*Math.random());this.oTextHandle.autocomplete=
"off";this.oTextHandle.instanceRef=this;this.oTextHandle.onkeydown=function(a){return this.instanceRef.handleKey(a)};this.oTextHandle.onkeyup=function(a){return this.instanceRef.autoSuggestUpdate(a)};this.oTextHandle.onchange=function(a){return this.instanceRef.autoSuggestUpdate(a)};this.oTextHandle.onblur=function(a){return this.instanceRef.autoSuggestHide(a)};this.oTextHandle.onfocus=function(a){return this.instanceRef.autoSuggestUpdate(a)};this.bItemList&&("sItemListContainerId"in this.opt?this.oItemList=
document.getElementById(this.opt.sItemListContainerId):(this.oItemList=document.createElement("div"),this.oTextHandle.parentNode.insertBefore(this.oItemList,this.oTextHandle.nextSibling)));if(0<this.aListItems.length)for(var a=0,b=this.aListItems.length;a<b;a++)this.addItemLink(this.aListItems[a].sItemId,this.aListItems[a].sItemName);return!0};
smc_AutoSuggest.prototype.handleKey=function(a){a||(a=window.event);var b=0;"which"in a?b=a.which:"keyCode"in a&&(b=a.keyCode);switch(b){case 9:0<this.aDisplayData.length&&(null!==this.oSelectedDiv?this.itemClicked(this.oSelectedDiv):this.handleSubmit());break;case 13:if(0<this.aDisplayData.length&&null!==this.oSelectedDiv)return this.itemClicked(this.oSelectedDiv),!1;break;case 38:case 40:if(this.aDisplayData.length&&"hidden"!==this.oSuggestDivHandle.style.visibility){a=!1;for(var c=null,d=0;d<this.aDisplayData.length;d++){if(null!==
this.oSelectedDiv&&this.oSelectedDiv===this.aDisplayData[d]&&0===d&&38===b){c=this.oSelectedDiv;break}if(null===this.oSelectedDiv&&40===b){c=this.aDisplayData[d];break}if(!1!==a&&a===this.oSelectedDiv&&40===b){c=this.aDisplayData[d];break}if(!1!==a&&this.aDisplayData[d]===this.oSelectedDiv&&38===b){c=a;break}a=this.aDisplayData[d]}null===c&&(c=a);null!==this.oSelectedDiv&&this.itemMouseOut(this.oSelectedDiv);this.oSelectedDiv=c;this.itemMouseOver(this.oSelectedDiv)}}return!0};
smc_AutoSuggest.prototype.registerCallback=function(a,b){switch(a){case "onBeforeAddItem":this.oCallback.onBeforeAddItem=b;break;case "onAfterAddItem":this.oCallback.onAfterAddItem=b;break;case "onAfterDeleteItem":this.oCallback.onAfterDeleteItem=b;break;case "onBeforeUpdate":this.oCallback.onBeforeUpdate=b}};
smc_AutoSuggest.prototype.handleSubmit=function(){for(var a=!0,b=null,c=0;c<this.aCache.length;c++)if(this.sLastSearch.toLowerCase()===this.aCache[c].sItemName.toLowerCase().substr(0,this.sLastSearch.length))if(this.sLastSearch.length===this.aCache[c].sItemName.length){b={sItemId:this.aCache[c].sItemId,sItemName:this.aCache[c].sItemName};break}else null!==b?a=!1:b={sItemId:this.aCache[c].sItemId,sItemName:this.aCache[c].sItemName};if(null===b||!1===a)return a;this.addItemLink(b.sItemId,b.sItemName,
!0);return!1};smc_AutoSuggest.prototype.positionDiv=function(){if(this.bPositionComplete)return!0;this.bPositionComplete=!0;var a=elk_itemPos(this.oTextHandle);this.oSuggestDivHandle.style.left=a[0]+"px";this.oSuggestDivHandle.style.top=a[1]+this.oTextHandle.offsetHeight+"px";this.oSuggestDivHandle.style.width=this.oTextHandle.clientWidth+"px";return!0};
smc_AutoSuggest.prototype.itemClicked=function(a){this.bItemList?this.addItemLink(a.sItemId,a.innerHTML):this.oTextHandle.value=a.innerHTML.php_unhtmlspecialchars();this.oRealTextHandle.value=this.oTextHandle.value;this.autoSuggestActualHide();this.oSelectedDiv=null};
smc_AutoSuggest.prototype.removeLastSearchString=function(){var a=this.oTextHandle.value.toLowerCase(),b=a.indexOf(this.sLastSearch.toLowerCase());if(-1!==b){for(;0<b;)if('"'===a.charAt(b-1)||","===a.charAt(b-1)||" "===a.charAt(b-1)){if(b--,","===a.charAt(b-1))break}else break;this.oTextHandle.value=this.oTextHandle.value.substr(0,b)}else this.oTextHandle.value=""};
smc_AutoSuggest.prototype.addItemLink=function(a,b,c){this.iItemCount++;if(!("oCallback"in this&&"onBeforeAddItem"in this.oCallback&&"string"===typeof this.oCallback.onBeforeAddItem)||eval(this.oCallback.onBeforeAddItem+"("+this.opt.sSelf+", '"+a+"');")){var d=document.createElement("div");d.id="suggest_"+this.opt.sSuggestId+"_"+a;d.innerHTML=this.sItemTemplate.replace(/%post_name%/g,this.opt.sPostName).replace(/%item_id%/g,a).replace(/%item_href%/g,elk_prepareScriptUrl(elk_scripturl)+this.opt.sURLMask.replace(/%item_id%/g,
a)).replace(/%item_name%/g,b).replace(/%images_url%/g,elk_images_url).replace(/%self%/g,this.opt.sSelf).replace(/%delete_text%/g,this.sTextDeleteItem);this.oItemList.appendChild(d);"oCallback"in this&&"onAfterAddItem"in this.oCallback&&"string"===typeof this.oCallback.onAfterAddItem&&eval(this.oCallback.onAfterAddItem+"("+this.opt.sSelf+", '"+d.id+"', "+this.iItemCount+");");this.removeLastSearchString();this.bDoAutoAdd=""!==this.oTextHandle.value&&c;this.autoSuggestUpdate()}};
smc_AutoSuggest.prototype.deleteAddedItem=function(a){var b=document.getElementById("suggest_"+this.opt.sSuggestId+"_"+a);"object"===typeof b&&null!==b&&(b.parentNode.removeChild(document.getElementById("suggest_"+this.opt.sSuggestId+"_"+a)),this.iItemCount--,"oCallback"in this&&"onAfterDeleteItem"in this.oCallback&&"string"===typeof this.oCallback.onAfterDeleteItem&&eval(this.oCallback.onAfterDeleteItem+"("+this.opt.sSelf+", "+this.iItemCount+");"));return!1};
smc_AutoSuggest.prototype.autoSuggestHide=function(){this.oHideTimer=setTimeout(this.opt.sSelf+".autoSuggestActualHide();",250)};smc_AutoSuggest.prototype.autoSuggestActualHide=function(){this.oSuggestDivHandle.style.display="none";this.oSuggestDivHandle.style.visibility="hidden";this.oSelectedDiv=null};
smc_AutoSuggest.prototype.autoSuggestShow=function(){this.oHideTimer&&(clearTimeout(this.oHideTimer),this.oHideTimer=!1);this.positionDiv();this.oSuggestDivHandle.style.visibility="visible";this.oSuggestDivHandle.style.display=""};
smc_AutoSuggest.prototype.populateDiv=function(a){for(;0<this.oSuggestDivHandle.childNodes.length;)this.oSuggestDivHandle.childNodes[0].onmouseover=null,this.oSuggestDivHandle.childNodes[0].onmouseout=null,this.oSuggestDivHandle.childNodes[0].onclick=null,this.oSuggestDivHandle.removeChild(this.oSuggestDivHandle.childNodes[0]);if("undefined"===typeof a)return this.aDisplayData=[],!1;for(var b=[],c=0;c<(a.length>this.iMaxDisplayQuantity?this.iMaxDisplayQuantity:a.length);c++){var d=document.createElement("div");
d.sItemId=a[c].sItemId;d.className="auto_suggest_item";d.innerHTML=a[c].sItemName;this.oSuggestDivHandle.appendChild(d);d.instanceRef=this;d.onmouseover=function(a){this.instanceRef.itemMouseOver(this)};d.onmouseout=function(a){this.instanceRef.itemMouseOut(this)};d.onclick=function(a){this.instanceRef.itemClicked(this)};b[c]=d}this.aDisplayData=b;return!0};smc_AutoSuggest.prototype.itemMouseOver=function(a){this.oSelectedDiv=a;a.className="auto_suggest_item_hover"};
smc_AutoSuggest.prototype.itemMouseOut=function(a){a.className="auto_suggest_item"};
smc_AutoSuggest.prototype.onSuggestionReceived=function(a){var b=a.getElementsByTagName("item");this.aCache=[];for(a=0;a<b.length;a++)if(this.aCache[a]={sItemId:b[a].getAttribute("id"),sItemName:b[a].childNodes[0].nodeValue},this.bDoAutoAdd&&this.sLastSearch===this.aCache[a].sItemName)return b=this.aCache[a].sItemId,a=this.aCache[a].sItemName,this.aCache=[],this.addItemLink(b,a,!0);this.bDoAutoAdd=!1;this.populateDiv(this.aCache);0===b.length?this.autoSuggestHide():this.autoSuggestShow();return!0};
smc_AutoSuggest.prototype.autoSuggestUpdate=function(){if("onBeforeUpdate"in this.oCallback&&"string"===typeof this.oCallback.onBeforeUpdate&&!eval(this.oCallback.onBeforeUpdate+"("+this.opt.sSelf+");"))return!1;this.oRealTextHandle.value=this.oTextHandle.value;if(isEmptyText(this.oTextHandle))return this.aCache=[],this.populateDiv(),this.autoSuggestHide(),!0;if(this.oTextHandle.value===this.sLastDirtySearch)return!0;this.sLastDirtySearch=this.oTextHandle.value;var a=this.oTextHandle.value.replace(/^("[^"]+",[ ]*)+/,
"").replace(/^([^,]+,[ ]*)+/,"");'"'===a.substr(0,1)&&(a=a.substr(1));var b=this.sLastSearch;this.sLastSearch=a;if(""===a||'"'===a.substr(a.length-1))return this.populateDiv(),!0;if(b===a)return!0;if(a.length<this.iMinimumSearchChars)return this.aCache=[],this.autoSuggestHide(),!0;if(a.substr(0,b.length)===b){b=[];for(var c=0,d=a.toLowerCase(),e=0;e<this.aCache.length;e++)this.aCache[e].sItemName.substr(0,a.length).toLowerCase()===d&&(b[c++]=this.aCache[e]);this.aCache=[];if(0!==b.length)return this.aCache=
b,this.populateDiv(this.aCache),this.autoSuggestShow(),!0}"object"===typeof this.oXmlRequestHandle&&null!==this.oXmlRequestHandle&&this.oXmlRequestHandle.abort();a=a.php_urlencode();a={suggest_type:this.opt.sSearchType,search:a,time:(new Date).getTime()};a="jsonString="+JSON.stringify(a)+"&"+this.opt.sSessionVar+"="+this.opt.sSessionId;sendXMLDocument.call(this,this.sRetrieveURL.replace(/%scripturl%/g,elk_prepareScriptUrl(elk_scripturl)),a,this.onSuggestionReceived);return!0};/*
 ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 This file contains code covered by:
 copyright:	2011 Simple Machines (http://www.simplemachines.org)
 license:		BSD, See included LICENSE.TXT for terms and conditions.

 @version 1.1
*/
(function(a){a.fn.Elk_Captcha=function(b){var c={letterCount:5,uniqueID:"",imageURL:"",useLibrary:!1,refreshevent:"click",playevent:"click",admin:!1};a.extend(c,b);return this.each(function(){$this=a(this);if("sound"==$this.data("type"))$this.on(c.playevent,function(a){a.preventDefault();popupFailed=reqWin(c.imageURL+";sound",400,300);popupFailed||(is_ie&&a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&(a.stopPropagation(),a.preventDefault()));return popupFailed});else $this.on(c.refreshevent,
function(b){b.preventDefault();b=c.uniqueID?"_"+c.uniqueID:"";var d;if(c.admin){c.imageURL=a("#verification_image"+b).attr("src").replace(/.$/,"")+$this.val();var g=String(c.imageURL)}else for(g=String(c.imageURL),g=g.substr(0,g.indexOf("rand=")+5),d=0;32>d;d++)g+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);if(c.useLibrary)a("#verification_image"+b).attr("src",g);else if(document.getElementById("verification_image"+b))for(d=1;d<=c.letterCount;d++)document.getElementById("verification_image"+
b+"_"+d)&&(document.getElementById("verification_image"+b+"_"+d).src=g+";letter="+d)})})}})(jQuery);(function(a){a.extend(!0,a.sceditor.prototype,{addEvent:function(b,c,d){b=a("#"+b);b.parent().on(c,"textarea",d);b=b.parent().find("iframe")[0].contentWindow;if(null!==b&&b.document)a(b.document.body).on(c,d)},InsertText:function(a,c){var b=this.inSourceMode();b||this.toggleSourceMode();var e=this.getSourceEditorValue(!1),g=e.length;this.setSourceEditorValue(c?a+"\n":e+(0<g?"\n":"")+a+"\n");b||this.toggleSourceMode()},getText:function(a){return this.inSourceMode()?this.getSourceEditorValue(!1):this.getWysiwygEditorValue(a)},
appendEmoticon:function(b,c){""===c?line.append(a("<br />")):($img=a("<img />").attr({src:c.url||c,alt:b,title:c.tooltip||c}).on("click",function(b){var c="",d="";base.opts.emoticonsCompat&&(c="<span> ",d=" </span>");base.inSourceMode()?base.sourceEditorInsertText(" "+a(this).attr("alt")+" "):base.wysiwygEditorInsertHtml(c+'<img src="'+a(this).attr("src")+'" data-sceditor-emoticon="'+a(this).attr("alt")+'" />'+d);b.preventDefault()}),$wrapper=a('<span class="smiley"></span>').append($img),line.append($wrapper))},
storeLastState:function(){this.wasSource=this.inSourceMode()},setTextMode:function(){this.inSourceMode()||this.toggleSourceMode()},createPermanentDropDown:function(){var b=a.extend({},this.opts.emoticons.dropdown);base=this;content=a('<div class="sceditor-insertemoticon" />');line=a('<div id="sceditor-smileycontainer" />');a.isEmptyObject(this.opts.emoticons.popup)||(this.opts.emoticons.more=this.opts.emoticons.popup,moreButton=a('<div class="sceditor-more" />').text(this._("More")).on("click",function(){var b=
a(".sceditor-smileyPopup");if(0<b.length)b.fadeIn("fast");else{b=a.extend({},base.opts.emoticons.popup);var d=a('<div class="category_header sceditor-popup-grip"/>');popupContent=a('<div id="sceditor-popup" />');line=a('<div id="sceditor-popup-smiley" />');popupContent.append(d);a.each(b,base.appendEmoticon);0<line.children().length&&popupContent.append(line);closeButton=a('<div id="sceditor-popup-close" />').text("["+base._("Close")+"]").on("click",function(){a(".sceditor-smileyPopup").fadeOut("fast")});
"undefined"!==typeof closeButton&&popupContent.append(closeButton);!1!==base.ieUnselectable&&(content=a(content),content.find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"));$dropdown=a('<div class="sceditor-dropdown sceditor-smileyPopup" />').append(popupContent).appendTo(a("body")).css({top:.2*a(window).height(),left:.5*a(window).width()-popupContent.find("#sceditor-popup-smiley").width()/2});dropdownIgnoreLastClick=!0;a(".sceditor-smileyPopup").draggable({handle:".sceditor-popup-grip"});
$dropdown.on("click",function(a){a.stopPropagation()})}}));a.each(b,base.appendEmoticon);0<line.children().length&&content.append(line);a(".sceditor-toolbar").append(content);"undefined"!==typeof moreButton&&content.append(moreButton)}})})(jQuery);
$.sceditor.command.set("space",{}).set("spoiler",{state:function(){var a=this.currentNode(),b=this.getRangeHelper();if(b.selectedRange()){b=b.selectedRange().startOffset;var c=$(a).text();a=c.substr(0,b);c=c.substr(b);b=a.lastIndexOf("[spoiler]");a=a.lastIndexOf("[/spoiler]");var d=c.indexOf("[spoiler]");c=c.indexOf("[/spoiler]");if(-1<b&&b>a||-1<c&&(-1===d||d>c))return 1}return 0},exec:function(){this.insert("[spoiler]","[/spoiler]")},txtExec:["[spoiler]","[/spoiler]"],tooltip:"Insert Spoiler"}).set("footnote",
{state:function(){var a=this.currentNode(),b=this.getRangeHelper();if(b.selectedRange()){b=b.selectedRange().startOffset;var c=$(a).text();a=c.substr(0,b);c=c.substr(b);b=a.lastIndexOf("[footnote]");a=a.lastIndexOf("[/footnote]");var d=c.indexOf("[footnote]");c=c.indexOf("[/footnote]");if(-1<b&&b>a||-1<c&&(-1===d||d>c))return 1}return 0},exec:function(){this.insert("[footnote] ","[/footnote]")},txtExec:["[footnote]","[/footnote]"],tooltip:"Insert Footnote"}).set("tt",{state:function(){var a=this.currentNode();
return $(a).is("span.tt")||0<$(a).parents("span.tt").length?1:0},exec:function(){var a=this.currentNode();$(a).is("span.tt")||0!==$(a).parents("span.tt").length?$(a).is("span.tt")&&1===$(a).text().length?($(a).replaceWith(""),this.insert("<span> ","</span>",!1)):!$(a).is("span.tt")&&0<$(a).parents("span.tt").length&&this.insert("<span> ","</span>",!1):this.insert('<span class="tt">',"</span>",!1)},txtExec:["[tt]","[/tt]"],tooltip:"Teletype"}).set("pre",{state:function(){var a=this.currentNode();return $(a).is("pre")||
0<$(a).parents("pre").length?1:0},exec:function(){var a=this.currentNode();if(!$(a).is("pre")&&0===$(a).parents("pre").length)this.insert("<pre>","</pre>",!1);else if(!$(a).is("pre")&&0<$(a).parents("pre").length){a=this.getRangeHelper();var b=a.getFirstBlockParent(),c=$("#"+post_box_name).sceditor("instance");this.insert('<p id="blank"> ',"</p>",!1);a.saveRange();c=c.getBody().find("#blank").get(0);b.parentNode.insertBefore(c,b.nextSibling);a.restoreRange();this.focus()}},txtExec:["[pre]","[/pre]"],
tooltip:"Preformatted Text"}).set("bulletlist",{txtExec:["[list]\n[li]","[/li]\n[li][/li]\n[/list]"]}).set("orderedlist",{txtExec:["[list type=decimal]\n[li]","[/li]\n[li][/li]\n[/list]"]}).set("table",{txtExec:["[table]\n[tr]\n[td]","[/td]\n[/tr]\n[/table]"]});
$.sceditor.plugins.bbcode.bbcode.set("tt",{tags:{tt:null,span:{"class":["tt"]}},format:"[tt]{0}[/tt]",html:'<span class="tt">{0}</span>'}).set("pre",{tags:{pre:null},isInline:!1,format:"[pre]{0}[/pre]",html:"<pre>{0}</pre>"}).set("member",{isInline:!0,format:function(a,b){return"[member="+a.attr("data-mention")+"]"+b.replace("@","")+"[/member]"},html:function(a,b,c){if("undefined"===typeof b.defaultattr||0===b.defaultattr.length)b.defaultattr=c;return'<a href="'+elk_scripturl+"?action=profile;u="+
b.defaultattr+'" class="mention" data-mention="'+b.defaultattr+'">@'+c.replace("@","")+"</a>"}}).set("me",{tags:{me:{"data-me":null}},isInline:!0,quoteType:$.sceditor.BBCodeParser.QuoteType.always,format:function(a,b){return"[me="+a.attr("data-me")+"]"+b.replace(a.attr("data-me")+" ","")+"[/me]"},html:function(a,b,c){if("undefined"===typeof b.defaultattr||0===b.defaultattr.length)b.defaultattr="";return'<me data-me="'+b.defaultattr+'">'+b.defaultattr+" "+c+"</me>"}}).set("attachurl",{allowsEmpty:!1,
quoteType:$.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){return"[attachurl]"+b+"[/attachurl]"},html:function(a,b,c){return'<a href="'+elk_scripturl+"?action=dlattach;attach="+c+";"+elk_session_var+"="+elk_session_id+'" data-ila="'+c+'">(<i class="icon i-paperclip"></i>&nbsp;'+ila_filename+")</a>"}}).set("attach",{allowsEmpty:!1,quoteType:$.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){var c="";(function(b){b.forEach(function(b){a.attr(b)?c+=" "+b+"="+a.attr(b):a.style[b]&&
(c+=" "+b+"="+a.style[b])})})(["width","height","align"]);return"[attach"+c+"]"+b+"[/attach]"},html:function(a,b,c){var d="";a="";(function(a){a.forEach(function(a){"undefined"!==typeof b[a]&&(d+=" "+a+"="+b[a])})})(["width","height","align"]);"undefined"!==typeof b.align&&(a=' class="img_bbc float'+b.align+'"');return"<img"+d+a+' src="'+elk_scripturl+"?action=dlattach;attach="+c+";thumb;"+elk_session_var+"="+elk_session_id+'" data-ila="'+c+'" />'}}).set("center",{tags:{center:null},styles:{"text-align":["center",
"-webkit-center","-moz-center","-khtml-center"]},isInline:!0,format:"[center]{0}[/center]",html:'<span style="display:block;text-align:center">{0}</span>'}).set("code",{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:function(a,b){var c="";1===a.children("cite:first").length?(c=a.children("cite:first").text().trim(),a.attr({from:c.php_htmlspecialchars()}),c="="+c,a.children("cite:first").remove(),b=this.elementToBbcode(a)):"undefined"!==typeof a.attr("from")&&(c="="+a.attr("from").php_unhtmlspecialchars());
return"[code"+c+"]"+b.replace("&#91;","[")+"[/code]"},quoteType:function(a){return a},html:function(a,b,c){a="";"undefined"!==typeof b.defaultattr&&(a="<cite>"+b.defaultattr+"</cite>");return"<code>"+a+c.replace("[","&#91;")+"</code>"}}).set("quote",{tags:{blockquote:null,cite:null},isInline:!1,format:function(a,b){var c="",d="",e="";if("cite"===a[0].tagName.toLowerCase())return"";a.attr("author")&&(c=" author="+a.attr("author").php_unhtmlspecialchars());a.attr("date")&&(d=" date="+a.attr("date"));
a.attr("link")&&(e=" link="+a.attr("link"));""===c&&""===d&&""!==e&&(e="="+a.attr("link"));return"[quote"+c+d+e+"]"+b+"[/quote]"},html:function(a,b,c){var d=a="",e="",g="",f="";if("undefined"!==typeof b.author)a=b.author,d=bbc_quote_from+": "+a;else if("undefined"!==typeof b.defaultattr){f=b.defaultattr;var h="http://"===f.substr(0,7)?f:elk_scripturl+"?"+f;d='<a href="'+h+'">'+bbc_quote_from+": "+h+"</a>"}for(var k in b)"link"===k.substr(0,4)&&b.hasOwnProperty(k)&&(f=4<k.length?k.substr(5)+"="+b[k]:
b[k],h="http://"===f.substr(0,7)?f:elk_scripturl+"?"+f,d=""===d?'<a href="'+h+'">'+bbc_quote_from+": "+h+"</a>":'<a href="'+h+'">'+d+"</a>");"undefined"!==typeof b.date&&(e=b.date,g='<date timestamp="'+e+'">'+new Date(1E3*b.date)+"</date>");d=""===d&&""===g?bbc_quote:d+(""!==g?" "+bbc_search_on:"");return'<blockquote author="'+a+'" link="'+f+'" date="'+e+'"><cite>'+d+" "+g+"</cite>"+c+"</blockquote>"}}).set("img",{tags:{img:{src:null}},allowsEmpty:!0,quoteType:$.sceditor.BBCodeParser.QuoteType.never,
format:function(a,b){var c="",d=function(b){b.forEach(function(b){a.attr(b)?c+=" "+b+"="+a.attr(b):a[0].style[b]&&(c+=" "+b+"="+a[0].style[b])})};if("undefined"!==typeof a.attr("data-sceditor-emoticon"))return b;if(a.attr("data-ila"))return d(["width","height","align"]),"[attach"+c+"]"+a.attr("data-ila")+"[/attach]";d(["width","height","title","alt"]);return"[img"+c+"]"+a.attr("src")+"[/img]"},html:function(a,b,c){var d="";(function(a){a.forEach(function(a){"undefined"!==typeof b[a]&&(d+=" "+a+'="'+
b[a]+'"')})})(["width","height","alt","title"]);return"<img"+d+' src="'+c+'" />'}}).set("list",{breakStart:!0,isInline:!1,skipLastLineBreak:!0,allowedChildren:["#","*","li"],html:function(a,b,c){a="";b.type&&(a='style="list-style-type: '+b.type+'"');return"<ul "+a+">"+c.replace(/<\/li><br \/>/g,"</li>")+"</ul>"}}).set("li",{breakAfter:!1}).set("ul",{tags:{ul:null},breakStart:!0,format:function(a,b){var c=$(a[0]).prop("style")["list-style-type"];return"disc"===c||""===c?"[list]"+b+"[/list]":"[list type="+
c+"]"+b+"[/list]"},isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"}).set("ol",{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[list type=decimal]{0}[/list]",html:"<ol>{0}</ol>"}).set("url",{allowsEmpty:!0,tags:{a:{href:null}},quoteType:$.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){var c=a.attr("href");return"mailto:"===c.substr(0,7)?'[email="'+c.substr(7)+'"]'+b+"[/email]":"undefined"!==typeof a.attr("data-mention")?"[member="+a.attr("data-mention")+"]"+
b.replace("@","")+"[/member]":"undefined"!==typeof a.attr("data-ila")?"[attachurl]"+a.attr("data-ila")+"[/attachurl]":"[url="+c+"]"+b+"[/url]"},html:function(a,b,c){b.defaultattr=$.sceditor.escapeEntities(b.defaultattr,!0)||c;return'<a href="'+$.sceditor.escapeUriScheme(b.defaultattr)+'" class="mention">'+c+"</a>"}});var bPost;function previewControl(){bPost=!1;switch(preview_area){case "pm":previewPM();break;case "news":previewNews();break;case "post":bPost=!0,previewPost()}return!1}
function previewPost(){var a=getFields(["subject",post_box_name,elk_session_var,"icon","guestname","email","evtitle","question","topic"],"board topic last_msg eventid calendar year month day poll_max_votes poll_expire poll_change_vote poll_hide".split(" "),["ns"],form_name);sendXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=post2"+(current_board?";board="+current_board:"")+(make_poll?";poll":"")+";preview;xml",a.join("&"),onDocSent);document.getElementById("preview_section").style.display=
"block";document.getElementById("preview_subject").innerHTML=txt_preview_title;document.getElementById("preview_body").innerHTML=txt_preview_fetch;return!1}
function previewPM(){var a=getFields(["subject",post_box_name,"to","bcc"],["recipient_to[]","recipient_bcc[]"],["outbox"],form_name);sendXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=pm;sa=send2;preview;xml",a.join("&"),onDocSent);document.getElementById("preview_section").style.display="block";document.getElementById("preview_subject").innerHTML=txt_preview_title;document.getElementById("preview_body").innerHTML=txt_preview_fetch;return!1}
function previewNews(){var a=getFields(["subject",post_box_name],[],["send_html","send_pm"],form_name);a[a.length]="item=newsletterpreview";sendXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=xmlpreview;xml",a.join("&"),onDocSent);document.getElementById("preview_section").style.display="block";document.getElementById("preview_subject").innerHTML=txt_preview_title;document.getElementById("preview_body").innerHTML=txt_preview_fetch;return!1}
function getFields(a,b,c,d){var e=[],g;var f=0;for(g=a.length;f<g;f++)a[f]in document.forms[d]&&(a[f]===post_box_name&&void 0!==$editor_data[post_box_name]?(e[e.length]=a[f]+"="+$editor_data[post_box_name].getText().replace(/&#/g,"&#38;#").php_urlencode(),e[e.length]="message_mode="+$editor_data[post_box_name].inSourceMode()):e[e.length]=a[f]+"="+document.forms[d][a[f]].value.replace(/&#/g,"&#38;#").php_urlencode());f=0;for(g=b.length;f<g;f++)if(b[f]in document.forms[d])if("value"in document.forms[d][b[f]])e[e.length]=
b[f]+"="+parseInt(document.forms[d].elements[b[f]].value);else{a=0;for(var h=document.forms[d][b[f]].length;a<h;a++)e[e.length]=b[f]+"="+parseInt(document.forms[d].elements[b[f]][a].value)}f=0;for(g=c.length;f<g;f++)c[f]in document.forms[d]&&document.forms[d].elements[c[f]].checked&&(e[e.length]=c[f]+"="+document.forms[d].elements[c[f]].value);e[e.length]=elk_session_var+"="+elk_session_id;return e}
function onDocSent(a){var b=0,c=0,d=0,e=0;if(!a||!a.getElementsByTagName("elk")[0])return document.forms[form_name].preview.onclick=function(){return!0},document.forms[form_name].preview.click(),!0;e=a.getElementsByTagName("elk")[0].getElementsByTagName("preview")[0];document.getElementById("preview_subject").innerHTML=e.getElementsByTagName("subject")[0].firstChild.nodeValue;d="";b=0;for(c=e.getElementsByTagName("body")[0].childNodes.length;b<c;b++)d+=e.getElementsByTagName("body")[0].childNodes[b].nodeValue;
document.getElementById("preview_body").innerHTML=d;document.getElementById("preview_body").className="post";e=a.getElementsByTagName("elk")[0].getElementsByTagName("errors")[0];var g="",f="";c=!1;b=0;for(d=e.getElementsByTagName("error").length;b<d;b++){f=e.getElementsByTagName("error")[b].attributes.getNamedItem("code").value;if("no_message"===f||"long_message"===f)c=!0;g+='<li id="post_error_'+f+'" class="error">'+e.getElementsByTagName("error")[b].firstChild.nodeValue+"</li>"}b=$(document.getElementById("post_error"));
""===$.trim(b.children("post_error_list").html())&&b.append("<ul id='post_error_list'></ul>");0===d?b.css("display","none"):(document.getElementById("post_error_list").innerHTML=g,b.css("display",""),b.attr("class",0===parseInt(e.getAttribute("serious"))?"warningbox":"errorbox"));bPost&&(document.getElementById("lock_warning").style.display=1===parseInt(e.getAttribute("topic_locked"))?"":"none");d=e.getElementsByTagName("caption");b=0;for(e=e.getElementsByTagName("caption").length;b<e;b++)document.getElementById("caption_"+
d[b].getAttribute("name"))&&(document.getElementById("caption_"+d[b].getAttribute("name")).className=d[b].getAttribute("class"));b="undefined"!==typeof $editor_container[post_box_name]?$editor_container[post_box_name]:$(document.forms[form_name][post_box_name]);c?b.find("textarea, iframe").addClass("border_error"):b.find("textarea, iframe").removeClass("border_error");if(bPost){"last_msg"in document.forms[form_name]&&(document.forms[form_name].last_msg.value=a.getElementsByTagName("elk")[0].getElementsByTagName("last_msg")[0].firstChild.nodeValue);
e=[];c=[];d=null;a=a.getElementsByTagName("elk")[0].getElementsByTagName("new_posts")[0]?a.getElementsByTagName("elk")[0].getElementsByTagName("new_posts")[0].getElementsByTagName("post"):{length:0};g=a.length;if(0!==g){f='<span id="new_replies"></span>';for(b=0;b<g;b++)e[e.length]=a[b].getAttribute("id"),d=!1,"0"!==a[b].getElementsByTagName("is_ignored")[0].firstChild.nodeValue&&(c[c.length]=d=a[b].getAttribute("id")),f+='<div class="content'+(0===++reply_counter%2?"2":"")+'"><div class="postarea2" id="msg'+
a[b].getAttribute("id")+'"><div class="keyinfo">',f+='<h5 class="floatleft"><span>'+txt_posted_by+"</span>&nbsp;"+a[b].getElementsByTagName("poster")[0].firstChild.nodeValue+"&nbsp;-&nbsp;"+a[b].getElementsByTagName("time")[0].firstChild.nodeValue,f+=' <span class="new_posts" id="image_new_'+a[b].getAttribute("id")+'">'+txt_new+"</span></h5>",can_quote&&(f+='<ul class="quickbuttons" id="msg_'+a[b].getAttribute("id")+'_quote"><li class="listlevel1"><a href="#postmodify" onmousedown="return insertQuoteFast('+
a[b].getAttribute("id")+');" class="linklevel1 quote_button">'+txt_bbc_quote+"</a></li></ul>"),f+="</div>",d&&(f+='<div id="msg_'+a[b].getAttribute("id")+'_ignored_prompt">'+txt_ignoring_user+'<a href="#" id="msg_'+a[b].getAttribute("id")+'_ignored_link" class="hide">'+show_ignore_user_post+"</a></div>"),f+='<div class="inner" id="msg_'+a[b].getAttribute("id")+'_body">'+a[b].getElementsByTagName("message")[0].firstChild.nodeValue+"</div></div></div>";setOuterHTML(document.getElementById("new_replies"),
f)}for(b=0;b<e.length;b++)document.getElementById("image_new_"+e[b]).style.display="none";a=c.length;if(0!==a)for(b=0;b<a;b++)aIgnoreToggles[c[b]]=new elk_Toggle({bToggleEnabled:!0,bCurrentlyCollapsed:!0,aSwappableContainers:["msg_"+c[b]+"_body","msg_"+c[b]+"_quote"],aSwapLinks:[{sId:"msg_"+c[b]+"_ignored_link",msgExpanded:"",msgCollapsed:show_ignore_user_post}]})}$("html, body").animate({scrollTop:$("#preview_section").offset().top},"slow");$.isFunction($.fn.linkifyvideo)&&$().linkifyvideo(oEmbedtext,
"preview_body");$(".spoilerheader").on("click",function(){$(this).next().children().slideToggle("fast")});"function"===typeof elk_codefix&&elk_codefix();"function"===typeof prettyPrint&&prettyPrint();$("[data-lightboximage]").on("click.elk_lb",function(a){a.preventDefault()})}
function addPollOption(){if(0===pollOptionNum)for(var a=0,b=document.forms[form_name].elements.length;a<b;a++)if("options-"===document.forms[form_name].elements[a].id.substr(0,8)){pollOptionNum++;var c=document.forms[form_name].elements[a].tabIndex}pollOptionNum++;pollOptionId++;c++;setOuterHTML(document.getElementById("pollMoreOptions"),'<li><label for="options-'+pollOptionId+'">'+txt_option+" "+pollOptionNum+'</label>: <input type="text" name="options['+pollOptionId+']" id="options-'+pollOptionId+
'" value="" size="80" maxlength="255" tabindex="'+c+'" class="input_text" /></li><li id="pollMoreOptions"></li>')}
function addAttachment(){--allowed_attachments;current_attachment+=1;if(0>=allowed_attachments)return alert(txt_more_attachments_error);setOuterHTML(document.getElementById("moreAttachments"),'<dd class="smalltext"><input type="file" size="60" name="attachment[]" id="attachment'+current_attachment+'" class="input_file" /> (<a href="javascript:void(0);" onclick="cleanFileInput(\'attachment'+current_attachment+"');\">"+txt_clean_attach+'</a>)</dd><dd class="smalltext" id="moreAttachments"><a href="#" onclick="addAttachment(); return false;">('+
txt_more_attachments+")</a></dd>");return!0}function cleanFileInput(a){a=$("#"+a);a.wrap("<form>").closest("form").get(0).reset();a.unwrap()}function insertQuoteFast(a){getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=quotefast;quote="+a+";xml;pb="+post_box_name+";mode=0",onDocReceived);return!0}
function onDocReceived(a){for(var b="",c=0,d=a.getElementsByTagName("quote")[0].childNodes.length;c<d;c++)b+=a.getElementsByTagName("quote")[0].childNodes[c].nodeValue+"\n";$editor_data[post_box_name].insert(b);ajax_indicator(!1)}function onReceiveOpener(a){$editor_data[post_box_name].insert(a)}function showimage(){document.images.icons.src=icon_urls[document.forms.postmodify.icon.options[document.forms.postmodify.icon.selectedIndex].value]}
function reActivate(){document.forms.postmodify.message.readOnly=!1};/*
 This file contains javascript associated with the splittag function as it
 relates to an sceditor instance

 @name      ElkArte Forum
 @copyright ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 This software is a derived product, based on:

 Original code author: Aziz
 License: http://opensource.org/licenses/Zlib

 @version 1.1

*/
(function(a){a.sceditor.plugins.splittag=function(){var b=this,c,d=[],e=/\[(?:([a-z]+)([^\]]*)|(\/[a-z]+))]/gi;b.init=function(){c=this;c.addShortcut("ctrl+enter",b.split);c.commands.splittag||(c.commands.splittag={txtExec:b.split,exec:b.split_wizzy,tooltip:"Split Tag"})};b.split=function(){var a="",b="";var h=c.val(null,!1);var k=c.sourceEditorCaret(),l=k.end;d=[];for(h=h.slice(0,l);l=e.exec(h);)l[3]?d.pop():d.push({name:l[1],attributes:l[2]});if(0!==d.length){for(h=d.length-1;0<=h;h--)a+="[/"+d[h].name+
"]";for(h=0;h<d.length;h++)0===h&&(b+="\n"),b+="["+d[h].name+d[h].attributes+"]";k.start!==k.end?c.insertText(a+b,a+b):c.insertText(a,b)}};b.split_wizzy=function(){var b=c.getRangeHelper(),d;b.saveRange();var e=b.cloneSelected();for(d=e.commonAncestorContainer;d&&(1!==d.nodeType||"BLOCKQUOTE"!==d.tagName.toUpperCase());)d=d.parentNode;if(d){var k=a(d).prop("attributes");e.setEndAfter(d);var l=e.extractContents();a.each(k,function(){a(l).attr(this.name,this.value)});e.collapse(d);d=d.ownerDocument.createElement("p");
a(d).html("&nbsp;");e.insertNode(l);e.insertNode(d);e=document.createRange();e.setStartBefore(d);b.selectRange(e);e.collapse(!1);c.focus()}else b.restoreRange()}}})(jQuery);(function(){var a=function(a){var b=[],d=0,e=null,g=null,f=null,h=0,k=0,l=[],m=!1,q=[],n=0,p=0,u={},r="",t='<div class="statusbar"><div class="info"></div><div class="progressBar"><div></div></div><div class="control icon i-close"></div></div>',w={},A,B=function(a){if("undefined"!==typeof a.events)for(var c in a.events)a.events.hasOwnProperty(c)&&C(c,a.events[c]);b=""===a.allowedExtensions?[]:a.allowedExtensions.toLowerCase().replace(/\s/g,"").split(",");e=""===a.totalSizeAllowed?null:a.totalSizeAllowed;
g=""===a.individualSizeAllowed?null:a.individualSizeAllowed;f=""===a.numOfAttachmentAllowed?null:a.numOfAttachmentAllowed;h=a.totalAttachSizeUploaded/1024;k=a.numAttachUploaded;l=[];"undefined"!==typeof a.topic&&(p=a.topic);"undefined"!==typeof a.fileDisplayTemplate&&(t=a.fileDisplayTemplate);A=$(t);n=a.board;u=a.oTxt;"undefined"!==typeof a.existingSelector&&G($(a.existingSelector))},G=function(a){a.each(function(a,b){var c=new D({}),e=$(this);c.setFileNameSize(e.parent().text(),e.data("size"));c.setProgress(100);
var f=c.getButton(),g={curFileNum:d++,attachid:e.data("attachid"),size:e.data("size")};f.addClass("abort");c.onUploadSuccess(g);l.push(g);e.closest("dd").remove()})},H=function(a,b,c,d){a=$.ajax({xhr:function(){var a=$.ajaxSettings.xhr();a.upload&&a.upload.addEventListener("progress",function(a){var c=0,d=a.loaded||a.position,e=a.total;a.lengthComputable&&(c=Math.ceil(d/e*100));b.setProgress(c)},!1);return a},url:elk_scripturl+"?action=attachment;sa=ulattach;api;"+elk_session_var+"="+elk_session_id+
";board="+n,type:"POST",dataType:"json",contentType:!1,processData:!1,cache:!1,data:a,context:{fileName:d,fileSize:c}}).done(function(a){"object"!==typeof a&&(a=JSON.parse(a));if(a.result){var c=l.length;a=a.data;b.setProgress(100);l.push(a);a.curFileNum=c;b.onUploadSuccess(a)}else{c={};var d=[],e;for(e in a.data){if(a.data.hasOwnProperty(e)){c.individualServerErr=a.data[e].title.php_unhtmlspecialchars()+"<br />";for(var f in a.data[e].errors)a.data[e].errors.hasOwnProperty(f)&&d.push(a.data[e].errors[f].php_unhtmlspecialchars())}k--;
y({errorMsgs:c,serverErrorFiles:d})}b.setServerFail(0)}}).fail(function(a,c,d){a={};c=[];k--;a.individualSizeErr=u.postUploadError;c.push(this.fileName.php_htmlspecialchars());y({errorMsgs:a,sizeErrorFiles:c});b.setServerFail(0)}).always(function(){m=!1;E()});b.setAbort(a)},I=function(a){var b=l[a.fileNum];$.ajax({url:elk_scripturl+"?action=attachment;sa=rmattach;api;"+elk_session_var+"="+elk_session_id,type:"POST",cache:!1,dataType:"json",data:{attachid:b.attachid}}).done(function(c){"object"!==
typeof c&&(c=JSON.parse(c));c.result?(h-=l[a.fileNum].size/1024,k--,F("RemoveSuccess",a.control,[b.attachid]),$("#"+b.attachid).off().remove()):"console"in window&&window.console.info(c.data)}).fail(function(a,b,c){"console"in window&&(window.console.info("Error:",b,c.name),window.console.info(a.responseText))})},D=function(a){var b=A.clone(),c=b.find(".control"),d=b.find(".progressBar");c.addClass("abort");$(".progress_tracker").append(b);this.setFileNameSize=function(a,c){var d=c/1024;var e=d/1024;
d=1024<parseInt(d,10)?e.toFixed(2)+" MB":d.toFixed(2)+" KB";b.find(".info").html(a+" ("+d+")")};this.setProgress=function(a){var b=a*d.width()/100;d.find("div").animate({width:b},10).html(a+"% ")};this.setAbort=function(a){c.on("click",function(c){c.preventDefault();a.abort();b.hide()})};this.getButton=function(){return c};this.setServerFail=function(a){this.setProgress(0);c.removeClass("i-close").addClass("i-alert")};this.onUploadSuccess=function(a){J(b,c,a);F("UploadSuccess",b,[c,a])}},J=function(a,
b,c){b.off("click");b.removeClass("abort i-close").addClass("remove i-delete");b.attr("id",c.curFileNum);a.attr("id",c.attachid);a.attr("data-size",c.size);b.after($("<input />").attr("type","hidden").attr("name","attach_del[]").attr("value",c.attachid));c=$("<img />").attr("src",elk_scripturl+"?action=dlattach;sa=tmpattach;attach="+a.attr("id")+";topic="+p);var d=a.find(".progressBar");d.after($('<div class="postattach_thumb" />').append(c));d.remove();b.on("click",function(b){b.preventDefault();
b=b.target.id;confirm(u.areYouSure)&&I({fileNum:b,control:a})})},z=function(a,c){for(var d={},l=[],n=[],v=0;v<a.length;v++){var m=/(?:\.([^.]+))?$/.exec(a[v].name)[1].toLowerCase(),p=a[v].size/1024,x=!1;0<b.length&&0>b.indexOf(m)&&(d.extnError="(<strong>"+m+"</strong>) "+u.allowedExtensions,l.push(a[v].name),x=!0);null!==g&&p>g&&(d.individualSizeErr="("+parseInt(p,10)+" KB) "+u.individualSizeAllowed,n.push(a[v].name),x=!0);k>=f&&(d.maxNumErr=u.numOfAttachmentAllowed,n.push(a[v].name),x=!0);!1===x&&
(h+=p);null!==e&&h>e&&(d.totalSizeError=u.totalSizeAllowed.replace("%1$s",e).replace("%2$s",String(parseInt(e-(h-p),10))),x=!0);!1===x&&(m=new FormData,p=new D(c),k++,m.append("attachment[]",a[v]),p.setFileNameSize(a[v].name.php_htmlspecialchars(),a[v].size),q.push({formData:m,statusInstance:p,fileName:a[v].name,fileSize:a[v].size}))}y({errorMsgs:d,extnErrorFiles:l,sizeErrorFiles:n});E()},E=function(){0<q.length&&!1===m&&setTimeout(function(){var a=q[0];m=!0;H(a.formData,a.statusInstance,a.fileSize,
a.fileName);q.splice(0,1)},200)},y=function(a){var b=$(".drop_attachments_error");b.html("");for(var c in a.errorMsgs){if(a.errorMsgs.hasOwnProperty(c))switch(c){case "extnError":r='<p class="warningbox">'+a.extnErrorFiles.join(", ")+" : "+a.errorMsgs[c]+"</p>";break;case "individualSizeErr":r='<p class="warningbox">'+a.sizeErrorFiles.join(", ")+" : "+a.errorMsgs[c]+"</p>";break;case "individualServerErr":r='<p class="warningbox">'+a.errorMsgs[c]+a.serverErrorFiles.join(", ")+"</p>";break;default:r=
'<p class="warningbox">'+a.errorMsgs[c]+"</p>"}b.append(r)}},C=function(a,b){w.hasOwnProperty(a)||(w[a]=[]);w[a].push(b)},F=function(a,b,c){if(w.hasOwnProperty(a))for(var d=0;d<w[a].length;d++)w[a][d].apply(b,c)};$(function(){var a=$(".drop_area");window.FormData&&"onprogress"in $.ajaxSettings.xhr()&&(a.toggle(),$(".drop_attachments_no_js").hide(),a.on("dragenter",function(a){a.stopPropagation();a.preventDefault();$(this).css("opacity","1")}),a.on("dragover",function(a){a.stopPropagation();a.preventDefault()}),
a.on("drop",function(b){var c=b.originalEvent.dataTransfer.files;b.preventDefault();$(this).css("opacity","0.6");z(c,a)}),a.on("dragexit",function(a){a.preventDefault();$(this).css("opacity","0.6")}),$input=a.find("#attachment_click"),$input.change(function(b){b.preventDefault();b=$(this)[0].files;z(b,a);this.value=null}),$input.clone(!0,!0).appendTo(".drop_area_fileselect_text"),$input.hide())});B(a);return{init:B,addEventListener:C,handleFileUpload:z}};"undefined"!==typeof define&&define.amd?define([],
function(){return a}):"undefined"!==typeof module&&module.exports?module.exports=a:this.dragDropAttachment=a})();
