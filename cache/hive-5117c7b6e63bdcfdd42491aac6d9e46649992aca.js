// https://hydrogenaud.io/themes/default/portal.js elk_jquery_plugins.js script.js script_elk.js theme.js topic.js jquery.atwho.min.js jquery.caret.min.js mentioning.js
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){var e,i;i={ESC:27,TAB:9,ENTER:13,CTRL:17,A:65,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32},e={beforeSave:function(t){return r.arrayToDefaultHash(t)},matcher:function(t,e,i,n){var r,o,s,a,h;return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i&&(t="(?:^|\\s)"+t),r=decodeURI("%C3%80"),o=decodeURI("%C3%BF"),h=n?" ":"",a=new RegExp(t+"([A-Za-z"+r+"-"+o+"0-9_"+h+"'.+-]*)$|"+t+"([^\\x00-\\xff]*)$","gi"),s=a.exec(e),s?s[2]||s[1]:null},filter:function(t,e,i){var n,r,o,s;for(n=[],r=0,s=e.length;r<s;r++)o=e[r],~new String(o[i]).toLowerCase().indexOf(t.toLowerCase())&&n.push(o);return n},remoteFilter:null,sorter:function(t,e,i){var n,r,o,s;if(!t)return e;for(n=[],r=0,s=e.length;r<s;r++)o=e[r],o.atwho_order=new String(o[i]).toLowerCase().indexOf(t.toLowerCase()),o.atwho_order>-1&&n.push(o);return n.sort(function(t,e){return t.atwho_order-e.atwho_order})},tplEval:function(t,e){var i,n;n=t;try{return"string"!=typeof t&&(n=t(e)),n.replace(/\$\{([^\}]*)\}/g,function(t,i,n){return e[i]})}catch(r){return i=r,""}},highlighter:function(t,e){var i;return e?(i=new RegExp(">\\s*([^<]*?)("+e.replace("+","\\+")+")([^<]*)\\s*<","ig"),t.replace(i,function(t,e,i,n){return"> "+e+"<strong>"+i+"</strong>"+n+" <"})):t},beforeInsert:function(t,e,i){return t},beforeReposition:function(t){return t},afterMatchFailed:function(t,e){}};var n;n=function(){function e(e){this.currentFlag=null,this.controllers={},this.aliasMaps={},this.$inputor=t(e),this.setupRootElement(),this.listen()}return e.prototype.createContainer=function(e){var i;return null!=(i=this.$el)&&i.remove(),t(e.body).append(this.$el=t("<div class='atwho-container'></div>"))},e.prototype.setupRootElement=function(e,i){var n;if(null==i&&(i=!1),e)this.window=e.contentWindow,this.document=e.contentDocument||this.window.document,this.iframe=e;else{this.document=this.$inputor[0].ownerDocument,this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(r){if(n=r,this.iframe=null,t.fn.atwho.debug)throw new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.\n"+n)}}return this.createContainer((this.iframeAsRoot=i)?this.document:document)},e.prototype.controller=function(t){var e,i,n,r;if(this.aliasMaps[t])i=this.controllers[this.aliasMaps[t]];else{r=this.controllers;for(n in r)if(e=r[n],n===t){i=e;break}}return i?i:this.controllers[this.currentFlag]},e.prototype.setContextFor=function(t){return this.currentFlag=t,this},e.prototype.reg=function(t,e){var i,n;return n=(i=this.controllers)[t]||(i[t]=this.$inputor.is("[contentEditable]")?new l(this,t):new s(this,t)),e.alias&&(this.aliasMaps[e.alias]=t),n.init(e),this},e.prototype.listen=function(){return this.$inputor.on("compositionstart",function(t){return function(e){var i;return null!=(i=t.controller())&&i.view.hide(),t.isComposing=!0,null}}(this)).on("compositionend",function(t){return function(e){return t.isComposing=!1,setTimeout(function(e){return t.dispatch(e)}),null}}(this)).on("keyup.atwhoInner",function(t){return function(e){return t.onKeyup(e)}}(this)).on("keydown.atwhoInner",function(t){return function(e){return t.onKeydown(e)}}(this)).on("blur.atwhoInner",function(t){return function(e){var i;if(i=t.controller())return i.expectedQueryCBId=null,i.view.hide(e,i.getOpt("displayTimeout"))}}(this)).on("click.atwhoInner",function(t){return function(e){return t.dispatch(e)}}(this)).on("scroll.atwhoInner",function(t){return function(){var e;return e=t.$inputor.scrollTop(),function(i){var n,r;return n=i.target.scrollTop,e!==n&&null!=(r=t.controller())&&r.view.hide(i),e=n,!0}}}(this)())},e.prototype.shutdown=function(){var t,e,i;i=this.controllers;for(t in i)e=i[t],e.destroy(),delete this.controllers[t];return this.$inputor.off(".atwhoInner"),this.$el.remove()},e.prototype.dispatch=function(t){var e,i,n,r;n=this.controllers,r=[];for(e in n)i=n[e],r.push(i.lookUp(t));return r},e.prototype.onKeyup=function(e){var n;switch(e.keyCode){case i.ESC:e.preventDefault(),null!=(n=this.controller())&&n.view.hide();break;case i.DOWN:case i.UP:case i.CTRL:case i.ENTER:t.noop();break;case i.P:case i.N:e.ctrlKey||this.dispatch(e);break;default:this.dispatch(e)}},e.prototype.onKeydown=function(e){var n,r;if(r=null!=(n=this.controller())?n.view:void 0,r&&r.visible())switch(e.keyCode){case i.ESC:e.preventDefault(),r.hide(e);break;case i.UP:e.preventDefault(),r.prev();break;case i.DOWN:e.preventDefault(),r.next();break;case i.P:if(!e.ctrlKey)return;e.preventDefault(),r.prev();break;case i.N:if(!e.ctrlKey)return;e.preventDefault(),r.next();break;case i.TAB:case i.ENTER:case i.SPACE:if(!r.visible())return;if(!this.controller().getOpt("spaceSelectsMatch")&&e.keyCode===i.SPACE)return;if(!this.controller().getOpt("tabSelectsMatch")&&e.keyCode===i.TAB)return;r.highlighted()?(e.preventDefault(),r.choose(e)):r.hide(e);break;default:t.noop()}},e}();var r,o=[].slice;r=function(){function i(e,i){this.app=e,this.at=i,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||this.uid(),this.expectedQueryCBId=null,this.setting=null,this.query=null,this.pos=0,this.range=null,0===(this.$el=t("#atwho-ground-"+this.id,this.app.$el)).length&&this.app.$el.append(this.$el=t("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new u(this),this.view=new c(this)}return i.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},i.prototype.init=function(e){return this.setting=t.extend({},this.setting||t.fn.atwho["default"],e),this.view.init(),this.model.reload(this.setting.data)},i.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},i.prototype.callDefault=function(){var i,n,r;r=arguments[0],i=2<=arguments.length?o.call(arguments,1):[];try{return e[r].apply(this,i)}catch(s){return n=s,t.error(n+" Or maybe At.js doesn't have function "+r)}},i.prototype.trigger=function(t,e){var i,n;return null==e&&(e=[]),e.push(this),i=this.getOpt("alias"),n=i?t+"-"+i+".atwho":t+".atwho",this.$inputor.trigger(n,e)},i.prototype.callbacks=function(t){return this.getOpt("callbacks")[t]||e[t]},i.prototype.getOpt=function(t,e){var i;try{return this.setting[t]}catch(n){return i=n,null}},i.prototype.insertContentFor=function(e){var i,n;return n=this.getOpt("insertTpl"),i=t.extend({},e.data("item-data"),{"atwho-at":this.at}),this.callbacks("tplEval").call(this,n,i,"onInsert")},i.prototype.renderView=function(t){var e;return e=this.getOpt("searchKey"),t=this.callbacks("sorter").call(this,this.query.text,t.slice(0,1001),e),this.view.render(t.slice(0,this.getOpt("limit")))},i.arrayToDefaultHash=function(e){var i,n,r,o;if(!t.isArray(e))return e;for(o=[],i=0,r=e.length;i<r;i++)n=e[i],t.isPlainObject(n)?o.push(n):o.push({name:n});return o},i.prototype.lookUp=function(t){var e,i;if((!t||"click"!==t.type||this.getOpt("lookUpOnClick"))&&(!this.getOpt("suspendOnComposing")||!this.app.isComposing))return(e=this.catchQuery(t))?(this.app.setContextFor(this.at),(i=this.getOpt("delay"))?this._delayLookUp(e,i):this._lookUp(e),e):(this.expectedQueryCBId=null,e)},i.prototype._delayLookUp=function(t,e){var i,n;return i=Date.now?Date.now():(new Date).getTime(),this.previousCallTime||(this.previousCallTime=i),n=e-(i-this.previousCallTime),0<n&&n<e?(this.previousCallTime=i,this._stopDelayedCall(),this.delayedCallTimeout=setTimeout(function(e){return function(){return e.previousCallTime=0,e.delayedCallTimeout=null,e._lookUp(t)}}(this),e)):(this._stopDelayedCall(),this.previousCallTime!==i&&(this.previousCallTime=0),this._lookUp(t))},i.prototype._stopDelayedCall=function(){if(this.delayedCallTimeout)return clearTimeout(this.delayedCallTimeout),this.delayedCallTimeout=null},i.prototype._generateQueryCBId=function(){return{}},i.prototype._lookUp=function(e){var i;return i=function(t,e){if(t===this.expectedQueryCBId)return e&&e.length>0?this.renderView(this.constructor.arrayToDefaultHash(e)):this.view.hide()},this.expectedQueryCBId=this._generateQueryCBId(),this.model.query(e.text,t.proxy(i,this,this.expectedQueryCBId))},i}();var s,a=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;s=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return a(i,e),i.prototype.catchQuery=function(){var t,e,i,n,r,o,s;if(e=this.$inputor.val(),t=this.$inputor.caret("pos",{iframe:this.app.iframe}),s=e.slice(0,t),r=this.callbacks("matcher").call(this,this.at,s,this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),n="string"==typeof r,!(n&&r.length<this.getOpt("minLen",0)))return n&&r.length<=this.getOpt("maxLen",20)?(o=t-r.length,i=o+r.length,this.pos=o,r={text:r,headPos:o,endPos:i},this.trigger("matched",[this.at,r.text])):(r=null,this.view.hide()),this.query=r},i.prototype.rect=function(){var e,i,n;if(e=this.$inputor.caret("offset",this.pos-1,{iframe:this.app.iframe}))return this.app.iframe&&!this.app.iframeAsRoot&&(i=t(this.app.iframe).offset(),e.left+=i.left,e.top+=i.top),n=this.app.document.selection?0:2,{left:e.left,top:e.top,bottom:e.top+e.height+n}},i.prototype.insert=function(t,e){var i,n,r,o,s;return i=this.$inputor,n=i.val(),r=n.slice(0,Math.max(this.query.headPos-this.at.length,0)),o=""===(o=this.getOpt("suffix"))?o:o||" ",t+=o,s=""+r+t+n.slice(this.query.endPos||0),i.val(s),i.caret("pos",r.length+t.length,{iframe:this.app.iframe}),i.is(":focus")||i.focus(),i.change()},i}(r);var l,a=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;l=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return a(n,e),n.prototype._getRange=function(){var t;if(t=this.app.window.getSelection(),t.rangeCount>0)return t.getRangeAt(0)},n.prototype._setRange=function(e,i,n){if(null==n&&(n=this._getRange()),n&&i)return i=t(i)[0],"after"===e?(n.setEndAfter(i),n.setStartAfter(i)):(n.setEndBefore(i),n.setStartBefore(i)),n.collapse(!1),this._clearRange(n)},n.prototype._clearRange=function(t){var e;if(null==t&&(t=this._getRange()),e=this.app.window.getSelection(),null==this.ctrl_a_pressed)return e.removeAllRanges(),e.addRange(t)},n.prototype._movingEvent=function(t){var e;return"click"===t.type||(e=t.which)===i.RIGHT||e===i.LEFT||e===i.UP||e===i.DOWN},n.prototype._unwrap=function(e){var i;return e=t(e).unwrap().get(0),(i=e.nextSibling)&&i.nodeValue&&(e.nodeValue+=i.nodeValue,t(i).remove()),e},n.prototype.catchQuery=function(e){var n,r,o,s,a,h,l,u,c,p,f,d;if((d=this._getRange())&&d.collapsed){if(e.which===i.ENTER)return(r=t(d.startContainer).closest(".atwho-query")).contents().unwrap(),r.is(":empty")&&r.remove(),(r=t(".atwho-query",this.app.document)).text(r.text()).contents().last().unwrap(),void this._clearRange();if(/firefox/i.test(navigator.userAgent)){if(t(d.startContainer).is(this.$inputor))return void this._clearRange();e.which===i.BACKSPACE&&d.startContainer.nodeType===document.ELEMENT_NODE&&(c=d.startOffset-1)>=0?(o=d.cloneRange(),o.setStart(d.startContainer,c),t(o.cloneContents()).contents().last().is(".atwho-inserted")&&(a=t(d.startContainer).contents().get(c),this._setRange("after",t(a).contents().last()))):e.which===i.LEFT&&d.startContainer.nodeType===document.TEXT_NODE&&(n=t(d.startContainer.previousSibling),n.is(".atwho-inserted")&&0===d.startOffset&&this._setRange("after",n.contents().last()))}if(t(d.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),(r=t(".atwho-query",this.app.document)).length>0&&r.is(":empty")&&0===r.text().length&&r.remove(),this._movingEvent(e)||r.removeClass("atwho-inserted"),r.length>0)switch(e.which){case i.LEFT:return this._setRange("before",r.get(0),d),void r.removeClass("atwho-query");case i.RIGHT:return this._setRange("after",r.get(0).nextSibling,d),void r.removeClass("atwho-query")}if(r.length>0&&(f=r.attr("data-atwho-at-query"))&&(r.empty().html(f).attr("data-atwho-at-query",null),this._setRange("after",r.get(0),d)),o=d.cloneRange(),o.setStart(d.startContainer,0),u=this.callbacks("matcher").call(this,this.at,o.toString(),this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),h="string"==typeof u,0===r.length&&h&&(s=d.startOffset-this.at.length-u.length)>=0&&(d.setStart(d.startContainer,s),r=t("<span/>",this.app.document).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),d.surroundContents(r.get(0)),l=r.contents().last().get(0),l&&(/firefox/i.test(navigator.userAgent)?(d.setStart(l,l.length),d.setEnd(l,l.length),this._clearRange(d)):this._setRange("after",l,d))),!(h&&u.length<this.getOpt("minLen",0)))return h&&u.length<=this.getOpt("maxLen",20)?(p={text:u,el:r},this.trigger("matched",[this.at,p.text]),this.query=p):(this.view.hide(),this.query={el:r},r.text().indexOf(this.at)>=0&&(this._movingEvent(e)&&r.hasClass("atwho-inserted")?r.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,r)&&this._setRange("after",this._unwrap(r.text(r.text()).contents().first()))),null)}},n.prototype.rect=function(){var e,i,n;if(n=this.query.el.offset())return this.app.iframe&&!this.app.iframeAsRoot&&(i=(e=t(this.app.iframe)).offset(),n.left+=i.left-this.$inputor.scrollLeft(),n.top+=i.top-this.$inputor.scrollTop()),n.bottom=n.top+this.query.el.height(),n},n.prototype.insert=function(t,e){var i,n,r,o,s;return this.$inputor.is(":focus")||this.$inputor.focus(),n=this.getOpt("functionOverrides"),n.insert?n.insert.bind(this)(t,e):(o=""===(o=this.getOpt("suffix"))?o:o||" ",i=e.data("item-data"),this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(t).attr("data-atwho-at-query",""+i["atwho-at"]+this.query.text).attr("contenteditable","false"),(r=this._getRange())&&(this.query.el.length&&r.setEndAfter(this.query.el[0]),r.collapse(!1),r.insertNode(s=this.app.document.createTextNode("‍"+o)),this._setRange("after",s,r)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change())},n}(r);var u;u=function(){function e(t){this.context=t,this.at=this.context.at,this.storage=this.context.$inputor}return e.prototype.destroy=function(){return this.storage.data(this.at,null)},e.prototype.saved=function(){return this.fetch()>0},e.prototype.query=function(t,e){var i,n,r;return n=this.fetch(),r=this.context.getOpt("searchKey"),n=this.context.callbacks("filter").call(this.context,t,n,r)||[],i=this.context.callbacks("remoteFilter"),n.length>0||!i&&0===n.length?e(n):i.call(this.context,t,e)},e.prototype.fetch=function(){return this.storage.data(this.at)||[]},e.prototype.save=function(t){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,t||[]))},e.prototype.load=function(t){if(!this.saved()&&t)return this._load(t)},e.prototype.reload=function(t){return this._load(t)},e.prototype._load=function(e){return"string"==typeof e?t.ajax(e,{dataType:"json"}).done(function(t){return function(e){return t.save(e)}}(this)):this.save(e)},e}();var c;c=function(){function e(e){this.context=e,this.$el=t("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.$elUl=this.$el.children(),this.timeoutID=null,this.context.$el.append(this.$el),this.bindEvent()}return e.prototype.init=function(){var t,e;return e=this.context.getOpt("alias")||this.context.at.charCodeAt(0),t=this.context.getOpt("headerTpl"),t&&1===this.$el.children().length&&this.$el.prepend(t),this.$el.attr({id:"at-view-"+e})},e.prototype.destroy=function(){return this.$el.remove()},e.prototype.bindEvent=function(){var e,i,n;return e=this.$el.find("ul"),i=0,n=0,e.on("mousemove.atwho-view","li",function(r){return function(r){var o;if((i!==r.clientX||n!==r.clientY)&&(i=r.clientX,n=r.clientY,o=t(r.currentTarget),!o.hasClass("cur")))return e.find(".cur").removeClass("cur"),o.addClass("cur")}}(this)).on("click.atwho-view","li",function(i){return function(n){return e.find(".cur").removeClass("cur"),t(n.currentTarget).addClass("cur"),i.choose(n),n.preventDefault()}}(this))},e.prototype.visible=function(){return t.expr.pseudos.visible(this.$el[0])},e.prototype.highlighted=function(){return this.$el.find(".cur").length>0},e.prototype.choose=function(t){var e,i;if((e=this.$el.find(".cur")).length&&(i=this.context.insertContentFor(e),this.context._stopDelayedCall(),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,i,e,t),e),this.context.trigger("inserted",[e,t]),this.hide(t)),this.context.getOpt("hideWithoutSuffix"))return this.stopShowing=!0},e.prototype.reposition=function(e){var i,n,r,o;return i=this.context.app.iframeAsRoot?this.context.app.window:window,e.bottom+this.$el.height()-t(i).scrollTop()>t(i).height()&&(e.bottom=e.top-this.$el.height()),e.left>(r=t(i).width()-this.$el.width()-5)&&(e.left=r),n={left:e.left,top:e.bottom},null!=(o=this.context.callbacks("beforeReposition"))&&o.call(this.context,n),this.$el.offset(n),this.context.trigger("reposition",[n])},e.prototype.next=function(){var t,e,i,n;return t=this.$el.find(".cur").removeClass("cur"),e=t.next(),e.length||(e=this.$el.find("li:first")),e.addClass("cur"),i=e[0],n=i.offsetTop+i.offsetHeight+(i.nextSibling?i.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,n-this.$el.height()))},e.prototype.prev=function(){var t,e,i,n;return t=this.$el.find(".cur").removeClass("cur"),i=t.prev(),i.length||(i=this.$el.find("li:last")),i.addClass("cur"),n=i[0],e=n.offsetTop+n.offsetHeight+(n.nextSibling?n.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,e-this.$el.height()))},e.prototype.scrollTop=function(t){var e;return e=this.context.getOpt("scrollDuration"),e?this.$elUl.animate({scrollTop:t},e):this.$elUl.scrollTop(t)},e.prototype.show=function(){var t;return this.stopShowing?void(this.stopShowing=!1):(this.visible()||(this.$el.show(),this.$el.scrollTop(0),this.context.trigger("shown")),(t=this.context.rect())?this.reposition(t):void 0)},e.prototype.hide=function(t,e){var i;if(this.visible())return isNaN(e)?(this.$el.hide(),this.context.trigger("hidden",[t])):(i=function(t){return function(){return t.hide()}}(this),clearTimeout(this.timeoutID),this.timeoutID=setTimeout(i,e))},e.prototype.render=function(e){var i,n,r,o,s,a,h;if(!(t.isArray(e)&&e.length>0))return void this.hide();for(this.$el.find("ul").empty(),n=this.$el.find("ul"),h=this.context.getOpt("displayTpl"),r=0,s=e.length;r<s;r++)o=e[r],o=t.extend({},o,{"atwho-at":this.context.at}),a=this.context.callbacks("tplEval").call(this.context,h,o,"onDisplay"),i=t(this.context.callbacks("highlighter").call(this.context,a,this.context.query.text)),i.data("item-data",o),n.append(i);return this.show(),this.context.getOpt("highlightFirst")?n.find("li:first").addClass("cur"):void 0},e}();var p;p={load:function(t,e){var i;if(i=this.controller(t))return i.model.load(e)},isSelecting:function(){var t;return!!(null!=(t=this.controller())?t.view.visible():void 0)},hide:function(){var t;return null!=(t=this.controller())?t.view.hide():void 0},reposition:function(){var t;if(t=this.controller())return t.view.reposition(t.rect())},setIframe:function(t,e){return this.setupRootElement(t,e),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},t.fn.atwho=function(e){var i,r;return i=arguments,r=null,this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each(function(){var o,s;return(s=(o=t(this)).data("atwho"))||o.data("atwho",s=new n(this)),"object"!=typeof e&&e?p[e]&&s?r=p[e].apply(s,Array.prototype.slice.call(i,1)):t.error("Method "+e+" does not exist on jQuery.atwho"):s.reg(e.at,e)}),null!=r?r:this},t.fn.atwho["default"]={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}</li>",insertTpl:"${atwho-at}${name}",headerTpl:null,callbacks:e,functionOverrides:{},searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,acceptSpaceBar:!1,highlightFirst:!0,limit:5,maxLen:20,minLen:0,displayTimeout:300,delay:null,spaceSelectsMatch:!1,tabSelectsMatch:!0,editableAtwhoQueryAttrs:{},scrollDuration:150,suspendOnComposing:!0,lookUpOnClick:!0},t.fn.atwho.debug=!1});
/*! jquery.caret 2015-02-01 */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return a.returnExportsGlobal=b(c)}):"object"==typeof exports?module.exports=b(require("jquery")):b(jQuery)}(this,function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l;k="caret",b=function(){function b(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return b.prototype.setPos=function(){return this.domInputor},b.prototype.getIEPosition=function(){return this.getPosition()},b.prototype.getPosition=function(){var a,b;return b=this.getOffset(),a=this.$inputor.offset(),b.left-=a.left,b.top-=a.top,b},b.prototype.getOldIEPos=function(){var a,b;return b=h.selection.createRange(),a=h.body.createTextRange(),a.moveToElementText(this.domInputor),a.setEndPoint("EndToEnd",b),a.text.length},b.prototype.getPos=function(){var a,b,c;return(c=this.range())?(a=c.cloneRange(),a.selectNodeContents(this.domInputor),a.setEnd(c.endContainer,c.endOffset),b=a.toString().length,a.detach(),b):h.selection?this.getOldIEPos():void 0},b.prototype.getOldIEOffset=function(){var a,b;return a=h.selection.createRange().duplicate(),a.moveStart("character",-1),b=a.getBoundingClientRect(),{height:b.bottom-b.top,left:b.left,top:b.top}},b.prototype.getOffset=function(){var b,c,d,e,f;return j.getSelection&&(d=this.range())?(d.endOffset-1>0&&d.endContainer===!this.domInputor&&(b=d.cloneRange(),b.setStart(d.endContainer,d.endOffset-1),b.setEnd(d.endContainer,d.endOffset),e=b.getBoundingClientRect(),c={height:e.height,left:e.left+e.width,top:e.top},b.detach()),c&&0!==(null!=c?c.height:void 0)||(b=d.cloneRange(),f=a(h.createTextNode("|")),b.insertNode(f[0]),b.selectNode(f[0]),e=b.getBoundingClientRect(),c={height:e.height,left:e.left,top:e.top},f.remove(),b.detach())):h.selection&&(c=this.getOldIEOffset()),c&&(c.top+=a(j).scrollTop(),c.left+=a(j).scrollLeft()),c},b.prototype.range=function(){var a;if(j.getSelection)return a=j.getSelection(),a.rangeCount>0?a.getRangeAt(0):null},b}(),c=function(){function b(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return b.prototype.getIEPos=function(){var a,b,c,d,e,f,g;return b=this.domInputor,f=h.selection.createRange(),e=0,f&&f.parentElement()===b&&(d=b.value.replace(/\r\n/g,"\n"),c=d.length,g=b.createTextRange(),g.moveToBookmark(f.getBookmark()),a=b.createTextRange(),a.collapse(!1),e=g.compareEndPoints("StartToEnd",a)>-1?c:-g.moveStart("character",-c)),e},b.prototype.getPos=function(){return h.selection?this.getIEPos():this.domInputor.selectionStart},b.prototype.setPos=function(a){var b,c;return b=this.domInputor,h.selection?(c=b.createTextRange(),c.move("character",a),c.select()):b.setSelectionRange&&b.setSelectionRange(a,a),b},b.prototype.getIEOffset=function(a){var b,c,d,e;return c=this.domInputor.createTextRange(),a||(a=this.getPos()),c.move("character",a),d=c.boundingLeft,e=c.boundingTop,b=c.boundingHeight,{left:d,top:e,height:b}},b.prototype.getOffset=function(b){var c,d,e;return c=this.$inputor,h.selection?(d=this.getIEOffset(b),d.top+=a(j).scrollTop()+c.scrollTop(),d.left+=a(j).scrollLeft()+c.scrollLeft(),d):(d=c.offset(),e=this.getPosition(b),d={left:d.left+e.left-c.scrollLeft(),top:d.top+e.top-c.scrollTop(),height:e.height})},b.prototype.getPosition=function(a){var b,c,e,f,g,h,i;return b=this.$inputor,f=function(a){return a=a.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(a=a.replace(/\s/g,"&nbsp;")),a},void 0===a&&(a=this.getPos()),i=b.val().slice(0,a),e=b.val().slice(a),g="<span style='position: relative; display: inline;'>"+f(i)+"</span>",g+="<span id='caret' style='position: relative; display: inline;'>|</span>",g+="<span style='position: relative; display: inline;'>"+f(e)+"</span>",h=new d(b),c=h.create(g).rect()},b.prototype.getIEPosition=function(a){var b,c,d,e,f;return d=this.getIEOffset(a),c=this.$inputor.offset(),e=d.left-c.left,f=d.top-c.top,b=d.height,{left:e,top:f,height:b}},b}(),d=function(){function b(a){this.$inputor=a}return b.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],b.prototype.mirrorCss=function(){var b,c=this;return b={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),a.each(this.css_attr,function(a,d){return b[d]=c.$inputor.css(d)}),b},b.prototype.create=function(b){return this.$mirror=a("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(b),this.$inputor.after(this.$mirror),this},b.prototype.rect=function(){var a,b,c;return a=this.$mirror.find("#caret"),b=a.position(),c={left:b.left,top:b.top,height:a.height()},this.$mirror.remove(),c},b}(),e={contentEditable:function(a){return!(!a[0].contentEditable||"true"!==a[0].contentEditable)}},g={pos:function(a){return a||0===a?this.setPos(a):this.getPos()},position:function(a){return h.selection?this.getIEPosition(a):this.getPosition(a)},offset:function(a){var b;return b=this.getOffset(a)}},h=null,j=null,i=null,l=function(a){var b;return(b=null!=a?a.iframe:void 0)?(i=b,j=b.contentWindow,h=b.contentDocument||j.document):(i=void 0,j=window,h=document)},f=function(a){var b;h=a[0].ownerDocument,j=h.defaultView||h.parentWindow;try{return i=j.frameElement}catch(c){b=c}},a.fn.caret=function(d,f,h){var i;return g[d]?(a.isPlainObject(f)?(l(f),f=void 0):l(h),i=e.contentEditable(this)?new b(this):new c(this),g[d].apply(i,[f])):a.error("Method "+d+" does not exist on jQuery.caret")},a.fn.caret.EditableCaret=b,a.fn.caret.InputCaret=c,a.fn.caret.Utils=e,a.fn.caret.apis=g});
;function sp_collapseBlock(e){$('#sp_block_'+e).slideToggle(300).promise().done(function(){var t=!1;if($('#sp_block_'+e).is(':visible'))t=!0;if(elk_member_id===0)document.cookie='sp_block_'+e+'='+(t?0:1);else elk_setThemeOption('sp_block_'+e,t?0:1,null,null);$('#sp_collapse_'+e).attr('class',t?'collapse':'expand')})};function sp_collapseSide(e){var t=[];t[1]='sp_left';t[4]='sp_right';mode=document.getElementById(t[e]).style.display===''?0:1;if(elk_member_id===0)document.cookie=t[e]+'='+(mode?0:1);else elk_setThemeOption(t[e],mode?0:1,null,null);document.getElementById('sp_collapse_side'+e).className=(mode?'dot collapse':'dot expand');$('#'+t[e]).toggle(400)};function sp_collapse_object(e,t){var i=document.getElementById('sp_object_'+e).style.display===''?0:1;$('#sp_object_'+e).toggle(300);if(typeof(t)==='undefined'||t===!0)document.getElementById('sp_collapse_'+e).src=elk_images_url+(i?'/collapse.png':'/expand.png')};function sp_image_resize(){var t=document.getElementsByTagName('img');for(var e=0;e<t.length;e++){if(t[e].className!=='bbc_img sp_article')continue;var i=new Image();i.src=t[e].src;if(i.width>300){t[e].height=(300*i.height)/i.width;t[e].width=300}
else{t[e].width=i.width;t[e].height=i.height}};if(typeof(window_oldSPImageOnload)!=='undefined'&&window_oldSPImageOnload){window_oldSPImageOnload();window_oldSPImageOnload=null}};function sp_submit_shout(e,t,i){if(window.XMLHttpRequest){shoutbox_indicator(e,!0);var n=document.getElementById('new_shout_'+e).value.replace(/&#/g,'&#38;#').php_urlencode();sendXMLDocument(elk_prepareScriptUrl(sp_script_url)+'action=shoutbox;xml','shoutbox_id='+e+'&shout='+n+'&'+t+'='+i,onShoutReceived);document.getElementById('new_shout_'+e).value='';return!1}};function sp_delete_shout(e,t,i,n){if(window.XMLHttpRequest){shoutbox_indicator(e,!0);sendXMLDocument(elk_prepareScriptUrl(sp_script_url)+'action=shoutbox;xml','shoutbox_id='+e+'&delete='+t+'&'+i+'='+n,onShoutReceived);return!1}};function sp_refresh_shout(e,t){if(window.XMLHttpRequest){shoutbox_indicator(e,!0);getXMLDocument(elk_prepareScriptUrl(sp_script_url)+'action=shoutbox;shoutbox_id='+e+';time='+t+';xml',onShoutReceived);return!1}};function onShoutReceived(e){var t,i,l,s,a,d,f,c,u,m,r,p,h,n='';i=e.getElementsByTagName('elk')[0].getElementsByTagName('shoutbox')[0].childNodes[0].nodeValue;l=e.getElementsByTagName('elk')[0].getElementsByTagName('updated')[0].childNodes[0].nodeValue;if(l==='1'){shouts=e.getElementsByTagName('elk')[0].getElementsByTagName('shout');s=e.getElementsByTagName('elk')[0].getElementsByTagName('error')[0].childNodes[0].nodeValue;a=e.getElementsByTagName('elk')[0].getElementsByTagName('warning')[0].childNodes[0].nodeValue;d=e.getElementsByTagName('elk')[0].getElementsByTagName('reverse')[0].childNodes[0].nodeValue;if(a!=='0')n+='<li class="shoutbox_warning smalltext">'+a+'</li>';if(s!=='0')document.getElementById('shouts_'+i).innerHTML=n+'<li class="smalltext">'+s+'</li>';else{for(var o=0;o<shouts.length;o++){t=e.getElementsByTagName('elk')[0].getElementsByTagName('shout')[o];f=t.getElementsByTagName('id')[0].childNodes[0].nodeValue;c=t.getElementsByTagName('author')[0].childNodes[0].nodeValue;u=t.getElementsByTagName('time')[0].childNodes[0].nodeValue;m=t.getElementsByTagName('timeclean')[0].childNodes[0].nodeValue;r=t.getElementsByTagName('delete')[0].childNodes[0].nodeValue;p=t.getElementsByTagName('content')[0].childNodes[0].nodeValue;h=t.getElementsByTagName('is_me')[0].childNodes[0].nodeValue;n+='<li>'+(h==='0'?'<strong>'+c+':</strong> ':'')+p+'<br />'+(r!==0?('<span class="shoutbox_delete">'+r+'</span>'):'')+'<span class="smalltext shoutbox_time">'+u+'</span></li>'};document.getElementById('shouts_'+i).innerHTML=n;if(d!=='0')document.getElementById('shouts_'+i).scrollTop=document.getElementById('shouts_'+i).scrollHeight;else document.getElementById('shouts_'+i).scrollTop=0}};shoutbox_indicator(i,!1);return!1};function shoutbox_indicator(e,t){document.getElementById('shoutbox_load_'+e).style.display=t?'':'none'};function sp_catch_enter(e){var t;if(window.event)t=window.event.keyCode;else if(e)t=e.which;if(t===13)return!0};function sp_show_ignored_shout(e){document.getElementById('ignored_shout_'+e).style.display='';document.getElementById('ignored_shout_link_'+e).style.display='none'};function sp_show_history_ignored_shout(e){document.getElementById('history_ignored_shout_'+e).style.display='';document.getElementById('history_ignored_shout_link_'+e).style.display='none'};function sp_showMoreSmileys(e,t,n,o,a,r){if(typeof(this.oSmileyPopupWindow)!=='undefined'&&'closed' in this.oSmileyPopupWindow&&!this.oSmileyPopupWindow.closed){this.oSmileyPopupWindow.focus();return};if(typeof(s)==='undefined'){var s='';for(i=0;i<sp_smileys.length;i++){sp_smileys[i][2]=sp_smileys[i][2].replace(/"/g,'&quot;');sp_smileys[i][0]=sp_smileys[i][0].replace(/"/g,'&quot;');s+='<a href="javascript:void(0);" onclick="window.opener.replaceText(\' '+sp_smileys[i][0].php_addslashes()+'\', window.opener.document.getElementById(\'new_shout_'+e+'\')); window.focus(); return false;"><img src="'+r+'/'+sp_smileys[i][1]+'" id="sml_'+sp_smileys[i][1]+'" alt="'+sp_smileys[i][2]+'" title="'+sp_smileys[i][2]+'" style="padding: 4px;" border="0" /></a> '}};this.oSmileyPopupWindow=window.open('','add_smileys','toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=480,height=220,resizable=yes');this.oSmileyPopupWindow.document.open('text/html','replace');this.oSmileyPopupWindow.document.write(sp_moreSmileysTemplate.easyReplace({smileyRows:s}));this.oSmileyPopupWindow.document.close()};function sp_update_editor(e,t){var o=$('textarea'),i=o.sceditor('instance'),n='';if(e==='bbc'&&typeof(i)==='undefined'){if(t==='html')n=o.html().php_unhtmlspecialchars();else n='[code]'+o.val().replace(/\n/g,'<br \>')+'[/code]';elk_editor();i=o.sceditor('instance');i.sourceMode(!1);i.setWysiwygEditorValue(n);i.sourceMode(!0)}
else if(e!=='bbc'&&typeof(i)!=='undefined'&&t!==''){if(e==='html'){if(i.getSourceEditorValue()!==''){n=i.getWysiwygEditorValue(!1);n=n.replace(/<span .*>\s?<\/span>/g,'').replace(/<br( \\)?>/g,'\n')}}
else{n=i.getSourceEditorValue(!1).replace(/<br( \\)?>/g,'\n').php_unhtmlspecialchars().replace('[code]','').replace('[/code]','')};i.destroy();$('textarea').val(n)}
else if(e!=='bbc'&&typeof(i)!=='undefined'){if(e==='html')i.updateOriginal();i.destroy()}};function sp_editor_change_type(e){var t;$('#'+e).on('focus',function(){t=this.value}).change(function(){sp_update_editor(this.value,t);t=this.value})};function sp_theme_select(e){var t=e.options[e.selectedIndex].value;document.getElementById('sp_ts_thumb').src=sp_ts_thumbs[t]};function sp_collapseCalendar(e){new_day='sp_calendar_'+e;if(new_day===current_day)return!1;document.getElementById(current_day).style.display='none';document.getElementById(new_day).style.display='';current_day=new_day};function sp_collapseObject(e){var t=document.getElementById('sp_object_'+e).style.display;t=(t===''|t==='block')?!1:!0;$('#sp_object_'+e).slideToggle(300);document.getElementById('sp_collapse_'+e).src=elk_images_url+(!t?'/selected_open.png':'/selected.png')};function check_style_options(){var e=document.getElementById('no_title').checked,t=document.getElementById('no_body').checked;document.getElementById('title_default_class').disabled=e;document.getElementById('title_custom_class').disabled=e;document.getElementById('title_custom_style').disabled=e;document.getElementById('body_default_class').disabled=t;document.getElementById('body_custom_class').disabled=t;document.getElementById('body_custom_style').disabled=t};function sp_surroundText(e,t,i){if('caretPos' in i&&'createTextRange' in i){var n=i.caretPos,d=n.text.length;n.text=n.text.charAt(n.text.length-1)===' '?e+n.text+t+' ':e+n.text+t;if(d===0){n.moveStart('character',-t.length);n.moveEnd('character',-t.length);n.select()}
else i.focus(n)}
else if('selectionStart' in i){var a=i.value.substr(0,i.selectionStart),s=i.value.substr(i.selectionStart,i.selectionEnd-i.selectionStart),r=i.value.substr(i.selectionEnd),o=i.selectionStart,l=i.scrollTop;i.value=a+e+s+t+r;if(i.setSelectionRange){if(s.length===0)i.setSelectionRange(o+e.length,o+e.length);else i.setSelectionRange(o,o+e.length+s.length+t.length);i.focus()};i.scrollTop=l}
else{i.value+=e+t;i.focus(i.value.length-1)}};
/*!
 * hoverIntent v1.9.0 // 2014.08.11 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
(function(e){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],e)}
else if(jQuery&&!jQuery.fn.hoverIntent){e(jQuery)}})(function(e){'use strict';var r={interval:100,sensitivity:6,timeout:0};var s=0,t,i,n=function(e){t=e.pageX;i=e.pageY},o=function(e,s,a,r){if(Math.sqrt((a.pX-t)*(a.pX-t)+(a.pY-i)*(a.pY-i))<r.sensitivity){s.off('mousemove.hoverIntent'+a.namespace,n);delete a.timeoutId;a.isActive=!0;delete a.pX;delete a.pY;return r.over.apply(s[0],[e])}
else{a.pX=t;a.pY=i;a.timeoutId=setTimeout(function(){o(e,s,a,r)},r.interval)}},a=function(e,t,i,n){delete t.data('hoverIntent')[i.id];return n.apply(t[0],[e])};e.fn.hoverIntent=function(t,i,l){var c=s++,d=e.extend({},r);if(e.isPlainObject(t)){d=e.extend(d,t)}
else if(e.isFunction(i)){d=e.extend(d,{over:t,out:i,selector:l})}
else{d=e.extend(d,{over:t,out:t,selector:i})};var u=function(t){var l=e.extend({},t);var s=e(this),r=s.data('hoverIntent');if(!r){s.data('hoverIntent',(r={}))};var i=r[c];if(!i){r[c]=i={id:c}};if(i.timeoutId){i.timeoutId=clearTimeout(i.timeoutId)};var u=i.namespace='.hoverIntent'+c;if(t.type==='mouseenter'){if(i.isActive){return};i.pX=l.pageX;i.pY=l.pageY;s.on('mousemove.hoverIntent'+u,n);i.timeoutId=setTimeout(function(){o(l,s,i,d)},d.interval)}
else{if(!i.isActive){return};s.off('mousemove.hoverIntent'+u,n);i.timeoutId=setTimeout(function(){a(l,s,i,d.out)},d.timeout)}};return this.on({'mouseenter.hoverIntent':u,'mouseleave.hoverIntent':u},d.selector)}});(function(e,t){'use strict';var i=(function(){var i={bcClass:'sf-breadcrumb',menuClass:'sf-js-enabled',anchorClass:'sf-with-ul',menuArrowClass:'sf-arrows'},v=(function(){e(window).on('load',function(){e('body').children().on('click.superfish',function(){e('.sf-js-enabled').superfish('hide','true')})})})(),a=(function(){var t=/^(?![\w\W]*Windows Phone)[\w\W]*(iPhone|iPad|iPod)/i.test(navigator.userAgent);if(t){e('html').css('cursor','pointer').on('click',e.noop)};return t})(),p=(function(){var e=document.documentElement.style;return('behavior' in e&&'fill' in e&&/iemobile/i.test(navigator.userAgent))})(),h=(function(){return(!!t.PointerEvent)})(),r=function(e,t,n){var o=i.menuClass,s;if(t.cssArrows){o+=' '+i.menuArrowClass};s=(n)?'addClass':'removeClass';e[s](o)},f=function(t,n){return t.find('li.'+n.pathClass).slice(0,n.pathLevels).addClass(n.hoverClass+' '+i.bcClass).filter(function(){return(e(this).children(n.popUpSelector).hide().show().length)}).removeClass(n.pathClass)},l=function(e,t){var n=(t)?'addClass':'removeClass';e.children('a')[n](i.anchorClass)},d=function(e){var i=e.css('ms-touch-action'),t=e.css('touch-action');t=t||i;t=(t==='pan-y')?'auto':'pan-y';e.css({'ms-touch-action':t,'touch-action':t})},c=function(e){return e.closest('.'+i.menuClass)},n=function(e){return c(e).data('sfOptions')},o=function(){var t=e(this),i=n(t);clearTimeout(i.sfTimer);t.siblings().superfish('hide').end().superfish('show')},u=function(t){t.retainPath=(e.inArray(this[0],t.$path)>-1);this.superfish('hide');if(!this.parents('.'+t.hoverClass).length){t.onIdle.call(c(this));if(t.$path.length){e.proxy(o,t.$path)()}}},s=function(){var i=e(this),t=n(i);if(a){e.proxy(u,i,t)()}
else{clearTimeout(t.sfTimer);t.sfTimer=setTimeout(e.proxy(u,i,t),t.delay)}},m=function(t){var i=e(this),a=n(i),s=i.siblings(t.data.popUpSelector);if(a.onHandleTouch.call(s)===!1){return this};if(s.length>0&&s.is(':hidden')){i.one('click.superfish',!1);if(t.type==='MSPointerDown'||t.type==='pointerdown'){i.trigger('focus')}
else{e.proxy(o,i.parent('li'))()}}},g=function(t,i){var r='li:has('+i.popUpSelector+')';if(e.fn.hoverIntent&&!i.disableHI){t.hoverIntent(o,s,r)}
else{t.on('mouseenter.superfish',r,o).on('mouseleave.superfish',r,s)};var n='MSPointerDown.superfish';if(h){n='pointerdown.superfish'};if(!a){n+=' touchend.superfish'};if(p){n+=' mousedown.superfish'};t.on('focusin.superfish','li',o).on('focusout.superfish','li',s).on(n,'a',i,m)};return{hide:function(t){if(this.length){var a=this,i=n(a);if(!i){return this};var r=(i.retainPath===!0)?i.$path:'',o=a.find('li.'+i.hoverClass).add(this).not(r).removeClass(i.hoverClass).children(i.popUpSelector),s=i.speedOut;if(t){o.show();s=0};i.retainPath=!1;if(i.onBeforeHide.call(o)===!1){return this};o.stop(!0,!0).animate(i.animationOut,s,function(){var t=e(this);i.onHide.call(t)})};return this},show:function(){var e=n(this);if(!e){return this};var i=this.addClass(e.hoverClass),t=i.children(e.popUpSelector);if(e.onBeforeShow.call(t)===!1){return this};t.stop(!0,!0).animate(e.animation,e.speed,function(){e.onShow.call(t)});return this},destroy:function(){return this.each(function(){var n=e(this),t=n.data('sfOptions'),o;if(!t){return!1};o=n.find(t.popUpSelector).parent('li');clearTimeout(t.sfTimer);r(n,t);l(o);d(n);n.off('.superfish').off('.hoverIntent');o.children(t.popUpSelector).attr('style',function(e,t){return t.replace(/display[^;]+;?/g,'')});t.$path.removeClass(t.hoverClass+' '+i.bcClass).addClass(t.pathClass);n.find('.'+t.hoverClass).removeClass(t.hoverClass);t.onDestroy.call(n);n.removeData('sfOptions')})},init:function(t){return this.each(function(){var o=e(this);if(o.data('sfOptions')){return!1};var n=e.extend({},e.fn.superfish.defaults,t),s=o.find(n.popUpSelector).parent('li');n.$path=f(o,n);o.data('sfOptions',n);r(o,n,!0);l(s,!0);d(o);g(o,n);s.not('.'+i.bcClass).superfish('hide',!0);n.onInit.call(this)})}}})();e.fn.superfish=function(t,n){if(i[t]){return i[t].apply(this,Array.prototype.slice.call(arguments,1))}
else if(typeof t==='object'||!t){return i.init.apply(this,arguments)}
else{return e.error('Method '+t+' does not exist on jQuery.fn.superfish')}};e.fn.superfish.defaults={popUpSelector:'ul,.sf-mega',hoverClass:'sfHover',pathClass:'overrideThisToUse',pathLevels:1,delay:800,animation:{opacity:'show'},animationOut:{opacity:'hide'},speed:'normal',speedOut:'fast',cssArrows:!0,disableHI:!1,onInit:e.noop,onBeforeShow:e.noop,onShow:e.noop,onBeforeHide:e.noop,onHide:e.noop,onIdle:e.noop,onDestroy:e.noop,onHandleTouch:e.noop}})(jQuery,window);
/*!
 * Superclick v1.0.0 - jQuery menu widget
 * Copyright (c) 2013 Joel Birch
 *
 * Dual licensed under the MIT and GPL licenses:
 *	http://www.opensource.org/licenses/mit-license.php
 *	http://www.gnu.org/licenses/gpl.html
 */
(function(e,t){'use strict';var i=(function(){var i={bcClass:'sf-breadcrumb',menuClass:'sf-js-enabled',anchorClass:'sf-with-ul',menuArrowClass:'sf-arrows'},f=(function(){e(t).on('load',function(){e('body').children().on('click.superclick',function(){var t=e('.sf-js-enabled');t.superclick('reset')})})})(),o=function(e,t){var n=i.menuClass;if(t.cssArrows){n+=' '+i.menuArrowClass};e.toggleClass(n)},c=function(t,n){return t.find('li.'+n.pathClass).slice(0,n.pathLevels).addClass(n.activeClass+' '+i.bcClass).filter(function(){return(e(this).children(n.popUpSelector).hide().show().length)}).removeClass(n.pathClass)},s=function(e){e.children('a').toggleClass(i.anchorClass)},a=function(e){var i=e.css('ms-touch-action'),t=e.css('touch-action');t=t||i;t=(t==='pan-y')?'auto':'pan-y';e.css({'ms-touch-action':t,'touch-action':t})},u=function(t){var n=e(this),i=n.siblings(t.data.popUpSelector),o;if(i.length){var s=!i.is(':hidden');o=(i.is(':hidden'))?r:l;e.proxy(o,n.parent('li'))();return!!s}},p=function(t){var i=e(this),n=i.siblings(t.data.popUpSelector),o=t.currentTarget.href;if(n.length===1&&o){if(n.not(':hidden'))e.proxy(l,i.parent('li'))();window.location=o;return!1}},r=function(){var t=e(this),i=n(t);t.siblings().superclick('hide').end().superclick('show')},l=function(){var t=e(this),i=n(t);e.proxy(h,t,i)()},h=function(t){t.retainPath=(e.inArray(this[0],t.$path)>-1);this.superclick('hide');if(!this.parents('.'+t.activeClass).length){t.onIdle.call(d(this));if(t.$path.length){e.proxy(r,t.$path)()}}},d=function(e){return e.closest('.'+i.menuClass)},n=function(e){return d(e).data('sf-options')};return{hide:function(t){if(this.length){var a=this,i=n(a);if(!i){return this};var r=(i.retainPath===!0)?i.$path:'',o=a.find('li.'+i.activeClass).add(this).not(r).removeClass(i.activeClass).children(i.popUpSelector),s=i.speedOut;if(t){o.show();s=0};i.retainPath=!1;i.onBeforeHide.call(o);o.stop(!0,!0).animate(i.animationOut,s,function(){var t=e(this);i.onHide.call(t)})};return this},show:function(){var e=n(this);if(!e){return this};var i=this.addClass(e.activeClass),t=i.children(e.popUpSelector);e.onBeforeShow.call(t);t.stop(!0,!0).animate(e.animation,e.speed,function(){e.onShow.call(t)});return this},destroy:function(){return this.each(function(){var n=e(this),t=n.data('sf-options'),r;if(!t){return!1};r=n.find(t.popUpSelector).parent('li');o(n,t);s(r);a(n);n.off('.superclick');r.children(t.popUpSelector).attr('style',function(e,t){return t.replace(/display[^;]+;?/g,'')});t.$path.removeClass(t.activeClass+' '+i.bcClass).addClass(t.pathClass);n.find('.'+t.activeClass).removeClass(t.activeClass);t.onDestroy.call(n);n.removeData('sf-options')})},reset:function(){return this.each(function(){var t=e(this),i=n(t),o=e(t.find('.'+i.activeClass).toArray().reverse());o.children('a').trigger('click')})},init:function(t){return this.each(function(){var r=e(this);if(r.data('sf-options')){return!1};var n=e.extend({},e.fn.superclick.defaults,t),l=r.find(n.popUpSelector).parent('li');n.$path=c(r,n);r.data('sf-options',n);o(r,n);s(l);a(r);r.on('click.superclick','a',n,u);l.on('dblclick.superclick','a',n,p);l.not('.'+i.bcClass).superclick('hide',!0);n.onInit.call(this)})}}})();e.fn.superclick=function(t,n){if(i[t]){return i[t].apply(this,Array.prototype.slice.call(arguments,1))}
else if(typeof t==='object'||!t){return i.init.apply(this,arguments)}
else{return e.error('Method '+t+' does not exist on jQuery.fn.superclick')}};e.fn.superclick.defaults={popUpSelector:'ul,.sf-mega',activeClass:'sfHover',pathClass:'overrideThisToUse',pathLevels:1,animation:{opacity:'show'},animationOut:{opacity:'hide'},speed:'normal',speedOut:'fast',cssArrows:!0,onInit:e.noop,onBeforeShow:e.noop,onShow:e.noop,onBeforeHide:e.noop,onHide:e.noop,onIdle:e.noop,onDestroy:e.noop}})(jQuery,window);
/*!
 * @name      ElkArte news fader
 * @copyright ElkArte Forum contributors
 * @license   MIT http://www.opensource.org/licenses/mit-license.php
 */
;(function(e){e.fn.Elk_NewsFader=function(t){var i={'iFadeDelay':5000,'iFadeSpeed':1000},o=0,n=e(this).find('li');if(n.length>1){e.extend(i,t);n.hide();n.eq(0).fadeIn(i.iFadeSpeed);setInterval(function(){e(n[o]).fadeOut(i.iFadeSpeed,function(){o++;if(o==n.length)o=0;e(n[o]).fadeIn(i.iFadeSpeed)})},i.iFadeSpeed+i.iFadeDelay)};return this}})(jQuery);
/*!
 * @name      ElkArte Forum
 * @copyright ElkArte Forum contributors
 * @license   BSD http://opensource.org/licenses/BSD-3-Clause
 *
 * This file contains code covered by:
 * copyright:	2011 Simple Machines (http://www.simplemachines.org)
 * license:		BSD, See included LICENSE.TXT for terms and conditions.
 *
 * @version 1.1
 */
;var elk_formSubmitted=!1,lastKeepAliveCheck=new Date().getTime(),ajax_indicator_ele=null,ua=navigator.userAgent.toLowerCase(),is_opera=!!window.opera,is_ff=typeof InstallTrigger!=='undefined'||((ua.indexOf('iceweasel')!==-1||ua.indexOf('icecat')!==-1||ua.indexOf('shiretoko')!==-1||ua.indexOf('minefield')!==-1)&&!is_opera),is_safari=Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor')>0,is_chrome=!!window.chrome,is_ie=!!document.documentMode,is_webkit=ua.indexOf('applewebkit')!==-1;is_osx=navigator.platform.toUpperCase().indexOf('MAC')>=0,is_mobile=navigator.userAgent.indexOf('Mobi')!==-1,is_touch='ontouchstart' in window||window.DocumentTouch&&document instanceof DocumentTouch;if(!('getElementsByClassName' in document)){document.getElementsByClassName=function(e){return $('.'+e)}};function getXMLDocument(e,t){var i=new XMLHttpRequest(),n=typeof(t)!=='undefined',o=this;if(n){i.onreadystatechange=function(){if(i.readyState!==4)return;if(i.responseXML!==null&&i.status===200)t.call(o,i.responseXML);else t.call(o,!1)}};i.open('GET',e,n);i.send(null);return i};function sendXMLDocument(e,t,i){var n=new window.XMLHttpRequest(),o=this;if(typeof(i)!=='undefined'){n.onreadystatechange=function(){if(n.readyState!==4)return;if(n.responseXML!==null&&n.status===200)i.call(o,n.responseXML);else i.call(o,!1)}};n.open('POST',e,!0);if('setRequestHeader' in n)n.setRequestHeader('Content-Type','application/x-www-form-urlencoded');n.send(t);return!0};String.prototype.php_strtr=function(e,t){return this.replace(new RegExp('['+e+']','g'),function(i){return t.charAt(e.indexOf(i))})};String.prototype.php_strtolower=function(){return typeof(elk_iso_case_folding)==='boolean'&&elk_iso_case_folding===!0?this.php_strtr('ABCDEFGHIJKLMNOPQRSTUVWXYZ\x8a\x8c\x8e\x9f\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde','abcdefghijklmnopqrstuvwxyz\x9a\x9c\x9e\xff\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe'):this.php_strtr('ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz')};String.prototype.php_urlencode=function(){return encodeURIComponent(this).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+')};String.prototype.php_htmlspecialchars=function(){return this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')};String.prototype.php_unhtmlspecialchars=function(){return this.replace(/&quot;/g,'"').replace(/&gt;/g,'>').replace(/&lt;/g,'<').replace(/&amp;/g,'&')};String.prototype.php_addslashes=function(){return this.replace(/\\/g,'\\\\').replace(/'/g,'\\\'')};String.prototype._replaceEntities=function(e,t,i){return String.fromCharCode(parseInt(i))};String.prototype.removeEntities=function(){return this.replace(/&(amp;)?#(\d+);/g,this._replaceEntities)};String.prototype.easyReplace=function(e){var i=this;for(var t in e){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');i=i.replace(new RegExp('%'+t+'%','g'),e[t])};return i};function php_str_repeat(e,t){if(t<1)return'';else return e+php_str_repeat(e,t-1)};function reqWin(e,t,i,n){if((t&&self.screen.availWidth*0.8<t)||(i&&self.screen.availHeight*0.8<i)){n=!1;t=Math.min(t,self.screen.availWidth*0.8);i=Math.min(i,self.screen.availHeight*0.8)}
else n=typeof(n)==='boolean'&&n===!0;window.open(e,'requested_popup','toolbar=no,location=no,status=no,menubar=no,scrollbars='+(n?'no':'yes')+',width='+(t?t:480)+',height='+(i?i:220)+',resizable=no');return!1};function reqOverlayDiv(e,t,i){var s='<div class="centertext"><i class="icon icon-spin icon-big i-spinner"></i></div>';i=typeof(i)==='string'?i:'i-help';t=typeof(t)==='string'?t:help_popup_heading_text;var o=new smc_Popup({heading:t,content:s,icon:i}),n=$('#'+o.popup_id).find('.popup_content');$.ajax({url:e,type:'GET',dataType:'html'}).done(function(e,t,i){var o=$('<div id="temp_help">').html(e).find('a[href$="self.close();"]').hide().prev('br').hide().parent().html();n.html(o)}).fail(function(e,t,i){n.html(t)});return!1};function smc_Popup(e){this.opt=e;this.popup_id=this.opt.custom_id?this.opt.custom_id:'elk_popup';this.show()};smc_Popup.prototype.show=function(){var t='popup_window '+(this.opt.custom_class?this.opt.custom_class:'content'),i=this.opt.icon?'<i class="icon '+this.opt.icon+' icon-top"></i> ':'';$('body').append('<div id="'+this.popup_id+'" class="popup_container"><div class="'+t+'" style="max-height: none;"><h3 class="popup_heading"><a href="javascript:void(0);" class="hide_popup icon i-close" title="Close"></a>'+i+this.opt.heading+'</h3><div class="popup_content">'+this.opt.content+'</div></div></div>');this.popup_body=$('#'+this.popup_id).children('.popup_window');this.popup_body.parent().fadeIn(300);this.popup_body.addClass('in');var e=this;$(document).mouseup(function(t){if($('#'+e.popup_id).has(t.target).length===0)e.hide()}).keyup(function(t){if(t.keyCode===27)e.hide()});$('#'+this.popup_id).find('.hide_popup').on('click',function(){return e.hide()});return!1};smc_Popup.prototype.hide=function(){$('#'+this.popup_id).fadeOut(300,function(){$(this).remove()});return!1};function replaceText(e,t){if('selectionStart' in t){var i=t.value.substr(0,t.selectionStart),o=t.value.substr(t.selectionEnd),s=t.scrollTop,n=0;t.value=i+e+o;if(t.setSelectionRange){t.focus();if(is_opera&&e.match(/\n/g)!==null)n=e.match(/\n/g).length;t.setSelectionRange(i.length+e.length+n,i.length+e.length+n)};t.scrollTop=s}
else{t.value+=e;t.focus(t.value.length-1)}};function isEmptyText(e){var t;if(typeof(e)==='string')t=e;else t=e.value;while(t.length>0&&(t.charAt(0)===' '||t.charAt(0)==='\t'))t=t.substring(1,t.length);while(t.length>0&&(t.charAt(t.length-1)===' '||t.charAt(t.length-1)==='\t'))t=t.substring(0,t.length-1);return t===''};function submitonce(e){elk_formSubmitted=!0};function submitThisOnce(e,t){var s='form' in e?e.form:e,n=s.getElementsByTagName('textarea');t=typeof t=='undefined'?!0:t;for(var i=0,o=n.length;i<o;i++)n[i].readOnly=t;window.setTimeout(function(){submitThisOnce(e,!1)},1000);return!elk_formSubmitted};function setInnerHTML(e,t){if(e)e.innerHTML=t};function getInnerHTML(e){if(e)return e.innerHTML};function setOuterHTML(e,t){if('outerHTML' in e)e.outerHTML=t;else{var i=document.createRange();i.setStartBefore(e);e.parentNode.replaceChild(i.createContextualFragment(t),e)}};function in_array(e,t){for(var i in t)if(t[i]==e)return!0;return!1};function array_search(e,t){for(var i in t)if(t[i]==e)return i;return null};function selectRadioByName(e,t){if(!('length' in e))return e.checked=!0;for(var i=0,n=e.length;i<n;i++)if(e[i].value===t)return e[i].checked=!0;return!1};function selectAllRadio(e,t,i,n){for(var o=0;o<t.length;o++)if(t[o].name!==undefined&&t[o].name.substr(0,i.length)==i&&t[o].value==n)t[o].checked=!0};function invertAll(e,t,i,n){for(var o=0;o<t.length;o++){if(!('name' in t[o])||(typeof(i)==='string'&&t[o].name.substr(0,i.length)!==i&&t[o].id.substr(0,i.length)!==i))continue;if(!t[o].disabled||(typeof(n)==='boolean'&&n))t[o].checked=e.checked}};function elk_sessionKeepAlive(){var e=new Date().getTime();if(elk_scripturl&&e-lastKeepAliveCheck>900000){var t=new Image();t.src=elk_prepareScriptUrl(elk_scripturl)+'action=keepalive;time='+e;lastKeepAliveCheck=e};window.setTimeout(function(){elk_sessionKeepAlive()},1200000)};window.setTimeout(function(){elk_sessionKeepAlive()},1200000);function elk_setThemeOption(e,t,i,n){if(n===null||typeof(n)==='undefined')n='';var o=new Image();o.src=elk_prepareScriptUrl(elk_scripturl)+'action=jsoption;var='+e+';val='+t+';'+elk_session_var+'='+elk_session_id+n+(i===null?'':'&th='+i)+';time='+(new Date().getTime())};function hashLoginPassword(e,t,i){if(typeof(hex_sha256)==='undefined')return;if(e.user.value.indexOf('@')!==-1)return;e.passwrd.autocomplete='off';e.hash_passwrd.value=hex_sha256(e.user.value.php_strtolower()+e.passwrd.value);if('old_hash_passwrd' in e&&typeof(hex_sha1)!=='undefined')e.old_hash_passwrd.value=hex_sha1(hex_sha1(e.user.value.php_strtolower()+e.passwrd.value)+t+(typeof i==='undefined'?'':i));e.passwrd.value=e.passwrd.value.replace(/./g,'*')};function hashAdminPassword(e,t,i,n){if(typeof(hex_sha256)==='undefined')return;e.admin_hash_pass.value=hex_sha256(t.php_strtolower()+e.admin_pass.value);e.admin_pass.value=e.admin_pass.value.replace(/./g,'*')};function hashModeratePassword(e,t,i,n){if(typeof(hex_sha256)==='undefined')return;e.moderate_hash_pass.value=hex_sha256(t.php_strtolower()+e.moderate_pass.value);e.moderate_pass.value=e.moderate_pass.value.replace(/./g,'*')};function expandPages(e,t,i,n,o){var a='',s=0,r=0,l=50;if((n-i)/o>l){r=n;n=i+l*o};for(s=i;s<n;s+=o)a+='<a class="navPages" href="'+t.replace(/%1\$d/,s).replace(/%%/g,'%')+'">'+(1+s/o)+'</a> ';if(r>0)a+='<span class="expand_pages" role="menuitem" onclick="expandPages(this, \''+t+'\', '+n+', '+r+', '+o+');"> ... </span> ';setOuterHTML(e,a)};function smc_preCacheImage(e){if(!('smc_aCachedImages' in window))window.smc_aCachedImages=[];if(!in_array(e,window.smc_aCachedImages)){var t=new Image();t.src=e}};function smc_Cookie(e){this.opt=e;this.oCookies={};this.init()};smc_Cookie.prototype.init=function(){if('cookie' in document&&document.cookie!==''){var i=document.cookie.split(';');for(var e=0,n=i.length;e<n;e++){var t=i[e].split('=');this.oCookies[t[0].replace(/^\s+|\s+$/g,'')]=decodeURIComponent(t[1])}}};smc_Cookie.prototype.get=function(e){return e in this.oCookies?this.oCookies[e]:null};smc_Cookie.prototype.set=function(e,t){document.cookie=e+'='+encodeURIComponent(t)};function elk_Toggle(e){this.opt=e;this.bCollapsed=!1;this.oCookie=null;this.init()};elk_Toggle.prototype.init=function(){var e=0,o=0;if('bToggleEnabled' in this.opt&&!this.opt.bToggleEnabled)return;if('oCookieOptions' in this.opt&&this.opt.oCookieOptions.bUseCookie){this.oCookie=new smc_Cookie({});var s=this.oCookie.get(this.opt.oCookieOptions.sCookieName);if(s!==null)this.opt.bCurrentlyCollapsed=s==='1'};if(this.opt.bCurrentlyCollapsed)this.changeState(!0,!0);if('aSwapImages' in this.opt){for(e=0,o=this.opt.aSwapImages.length;e<o;e++){var i=document.getElementById(this.opt.aSwapImages[e].sId);if(typeof(i)==='object'&&i!==null){if(getComputedStyle(i).getPropertyValue('display')==='none')i.style.display='inline';i.instanceRef=this;i.onclick=function(){this.instanceRef.toggle();this.blur()};i.style.cursor='pointer';smc_preCacheImage(this.opt.aSwapImages[e].srcCollapsed)}}}
else if('aSwapClasses' in this.opt){for(e=0,o=this.opt.aSwapClasses.length;e<o;e++){var t=document.getElementById(this.opt.aSwapClasses[e].sId);if(typeof(t)==='object'&&t!==null){if(getComputedStyle(t).getPropertyValue('display')==='none')t.style.display='block';t.instanceRef=this;t.onclick=function(){this.instanceRef.toggle();this.blur()};t.style.cursor='pointer'}}};if('aSwapLinks' in this.opt){for(e=0,o=this.opt.aSwapLinks.length;e<o;e++){var n=document.getElementById(this.opt.aSwapLinks[e].sId);if(typeof(n)==='object'&&n!==null){if(getComputedStyle(n).getPropertyValue('display')==='none')n.style.display='inline-block';n.instanceRef=this;n.onclick=function(){this.instanceRef.toggle();this.blur();return!1}}}}};elk_Toggle.prototype.changeState=function(e,t){var i=0,o=0,n;t=typeof(t)!=='undefined';if(!t&&e&&'funcOnBeforeCollapse' in this.opt){this.tmpMethod=this.opt.funcOnBeforeCollapse;this.tmpMethod();delete this.tmpMethod}
else if(!t&&!e&&'funcOnBeforeExpand' in this.opt){this.tmpMethod=this.opt.funcOnBeforeExpand;this.tmpMethod();delete this.tmpMethod};if('aSwapImages' in this.opt){for(i=0,o=this.opt.aSwapImages.length;i<o;i++){var s=document.getElementById(this.opt.aSwapImages[i].sId);if(typeof(s)==='object'&&s!==null){var l=e?this.opt.aSwapImages[i].srcCollapsed:this.opt.aSwapImages[i].srcExpanded;if(s.src!=l)s.src=l;s.alt=s.title=e?this.opt.aSwapImages[i].altCollapsed:this.opt.aSwapImages[i].altExpanded}}}
else if('aSwapClasses' in this.opt){for(i=0,o=this.opt.aSwapClasses.length;i<o;i++){n=document.getElementById(this.opt.aSwapClasses[i].sId);if(typeof(n)==='object'&&n!==null){var r=e?this.opt.aSwapClasses[i].classCollapsed:this.opt.aSwapClasses[i].classExpanded;if(n.className!==r)n.className=r;n.title=n.title=e?this.opt.aSwapClasses[i].titleCollapsed:this.opt.aSwapClasses[i].titleExpanded}}};if('aSwapLinks' in this.opt){for(i=0,o=this.opt.aSwapLinks.length;i<o;i++){var a=document.getElementById(this.opt.aSwapLinks[i].sId);if(typeof(a)==='object'&&a!==null)a.innerHTML=e?this.opt.aSwapLinks[i].msgCollapsed:this.opt.aSwapLinks[i].msgExpanded}};for(i=0,o=this.opt.aSwappableContainers.length;i<o;i++){if(this.opt.aSwappableContainers[i]===null)continue;n=document.getElementById(this.opt.aSwappableContainers[i]);if(typeof(n)==='object'&&n!==null){if(e)$(n).slideUp();else $(n).slideDown()}};this.bCollapsed=e;if('oCookieOptions' in this.opt&&this.opt.oCookieOptions.bUseCookie)this.oCookie.set(this.opt.oCookieOptions.sCookieName,this.bCollapsed?'1':'0');if(!t&&'oThemeOptions' in this.opt&&this.opt.oThemeOptions.bUseThemeSettings)elk_setThemeOption(this.opt.oThemeOptions.sOptionName,this.bCollapsed?'1':'0','sThemeId' in this.opt.oThemeOptions?this.opt.oThemeOptions.sThemeId:null,'sAdditionalVars' in this.opt.oThemeOptions?this.opt.oThemeOptions.sAdditionalVars:null)};elk_Toggle.prototype.toggle=function(){this.changeState(!this.bCollapsed)};function ajax_indicator(e){if(ajax_indicator_ele===null){ajax_indicator_ele=document.getElementById('ajax_in_progress');if(ajax_indicator_ele===null&&typeof(ajax_notification_text)!==null){create_ajax_indicator_ele()}};if(ajax_indicator_ele!==null){ajax_indicator_ele.style.display=e?'block':'none'}};function create_ajax_indicator_ele(){ajax_indicator_ele=document.createElement('div');ajax_indicator_ele.id='ajax_in_progress';var t=document.createElement('a');t.href='javascript:ajax_indicator(false)';var e=document.createElement('img');e.src=elk_images_url+'/icons/quick_remove.png';if(typeof(ajax_notification_cancel_text)!=='undefined'){e.alt=ajax_notification_cancel_text;e.title=ajax_notification_cancel_text};t.appendChild(e);ajax_indicator_ele.appendChild(t);ajax_indicator_ele.innerHTML+=ajax_notification_text;document.body.appendChild(ajax_indicator_ele)};function createEventListener(e){if(!('addEventListener' in e)){if(e.attachEvent){e.addEventListener=function(t,i,n){e.attachEvent('on'+t,i)};e.removeEventListener=function(t,i,n){e.detachEvent('on'+t,i)}}
else{e.addEventListener=function(t,i,n){e['on'+t]=i};e.removeEventListener=function(t,i,n){e['on'+t]=null}}}};function grabJumpToContent(){getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+'action=xmlhttp;sa=jumpto;xml',onJumpReceived);return!1};function onJumpReceived(e){var o=[],t,n,i=e.getElementsByTagName('elk')[0].getElementsByTagName('item');for(t=0,n=i.length;t<n;t++){o[o.length]={id:parseInt(i[t].getAttribute('id')),isCategory:i[t].getAttribute('type')==='category',name:i[t].firstChild.nodeValue.removeEntities(),is_current:!1,childLevel:parseInt(i[t].getAttribute('childlevel'))}};for(t=0,n=aJumpTo.length;t<n;t++)aJumpTo[t].fillSelect(o)};var aJumpTo=[];function JumpTo(e){this.opt=e;this.dropdownList=null;this.showSelect();createEventListener(this.dropdownList);if(is_mobile&&is_touch)this.dropdownList.addEventListener('touchstart',grabJumpToContent);else this.dropdownList.addEventListener('mouseenter',grabJumpToContent)};JumpTo.prototype.removeAll=function(){for(var e=this.dropdownList.options.length;e>0;e--)this.dropdownList.remove(e-1)};JumpTo.prototype.showSelect=function(){var e='';for(var t=this.opt.iCurBoardChildLevel;t>0;t--)e+=this.opt.sBoardChildLevelIndicator;if(e!=='')e+=this.opt.sBoardPrefix;document.getElementById(this.opt.sContainerId).innerHTML=this.opt.sJumpToTemplate.replace(/%select_id%/,this.opt.sContainerId+'_select').replace(/%dropdown_list%/,'<select '+(this.opt.bDisabled===!0?'disabled="disabled" ':'')+(this.opt.sClassName!==undefined?'class="'+this.opt.sClassName+'" ':'')+'name="'+(this.opt.sCustomName!==undefined?this.opt.sCustomName:this.opt.sContainerId+'_select')+'" id="'+this.opt.sContainerId+'_select"><option value="'+(this.opt.bNoRedirect!==undefined&&this.opt.bNoRedirect===!0?this.opt.iCurBoardId:'?board='+this.opt.iCurBoardId+'.0')+'">'+e+this.opt.sCurBoardName.removeEntities()+'</option></select>&nbsp;'+(this.opt.sGoButtonLabel!==undefined?'<input type="button" class="button_submit" value="'+this.opt.sGoButtonLabel+'" onclick="window.location.href = \''+elk_prepareScriptUrl(elk_scripturl)+'board='+this.opt.iCurBoardId+'.0\';" />':''));this.dropdownList=document.getElementById(this.opt.sContainerId+'_select')};JumpTo.prototype.fillSelect=function(e){this.removeAll();if(is_mobile&&is_touch)this.dropdownList.removeEventListener('touchstart',grabJumpToContent);else this.dropdownList.removeEventListener('mouseenter',grabJumpToContent);var r=document.createDocumentFragment(),o=document.createElement('optgroup');for(var t=0,l=e.length;t<l;t++){var s,n='',i,a;if(e[t].isCategory){o=document.createElement('optgroup');o.label=e[t].name;r.appendChild(o);continue}
else{for(s=e[t].childLevel,n='';s>0;s--)n+=this.opt.sBoardChildLevelIndicator;if(n!=='')n+=this.opt.sBoardPrefix};i=document.createElement('option');a=document.createElement('span');a.innerHTML=n+e[t].name;if(e[t].id===this.opt.iCurBoardId)i.selected='selected';i.appendChild(a);if(!this.opt.bNoRedirect){i.value='?board='+e[t].id+'.0'}
else{i.value=e[t].id};o.appendChild(i)};this.dropdownList.appendChild(r);if(!this.opt.bNoRedirect)this.dropdownList.onchange=function(){if(this.selectedIndex>0&&this.options[this.selectedIndex].value)window.location.href=elk_scripturl+this.options[this.selectedIndex].value.substr(elk_scripturl.indexOf('?')===-1||this.options[this.selectedIndex].value.substr(0,1)!=='?'?0:1)};if('funcOnBeforeCollapse' in this.opt){this.tmpMethod=this.opt.funcOnBeforeCollapse;this.tmpMethod(this);delete this.tmpMethod}};var aIconLists=[];function IconList(e){this.opt=e;this.bListLoaded=!1;this.oContainerDiv=null;this.funcMousedownHandler=null;this.funcParent=this;this.iCurMessageId=0;this.iCurTimeout=0;if(!('sAction' in this.opt)||this.opt.sAction===null)this.opt.sAction='messageicons;board='+this.opt.iBoardId;this.initIcons()};IconList.prototype.initIcons=function(){for(var e=document.images.length-1,t=this.opt.sIconIdPrefix.length;e>=0;e--)if(document.images[e].id.substr(0,t)===this.opt.sIconIdPrefix)setOuterHTML(document.images[e],'<div title="'+this.opt.sLabelIconList+'" onclick="'+this.opt.sBackReference+'.openPopup(this, '+document.images[e].id.substr(t)+')" onmouseover="'+this.opt.sBackReference+'.onBoxHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onBoxHover(this, false)" style="background: '+this.opt.sBoxBackground+'; cursor: pointer; padding: 2px; margin: 0 auto; vertical-align: top"><img src="'+document.images[e].src+'" alt="'+document.images[e].alt+'" id="'+document.images[e].id+'" style="vertical-align: top; margin: 0 auto; padding: 0 2px;" /></div>')};IconList.prototype.onBoxHover=function(e,t){e.style.border=t?this.opt.iBoxBorderWidthHover+'px solid '+this.opt.sBoxBorderColorHover:'';e.style.background=t?this.opt.sBoxBackgroundHover:this.opt.sBoxBackground;e.style.padding=t?(2-this.opt.iBoxBorderWidthHover)+'px':'2px'};IconList.prototype.openPopup=function(e,t){this.iCurMessageId=t;if(!this.bListLoaded&&this.oContainerDiv===null){this.oContainerDiv=document.createElement('div');this.oContainerDiv.id='iconList';this.oContainerDiv.style.display='none';this.oContainerDiv.style.cursor='pointer';this.oContainerDiv.style.position='absolute';this.oContainerDiv.style.background=this.opt.sContainerBackground;this.oContainerDiv.style.border=this.opt.sContainerBorder;this.oContainerDiv.style.padding='6px 0px';document.body.appendChild(this.oContainerDiv);ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+'action=xmlhttp;sa='+this.opt.sAction+';xml','',this.onIconsReceived);createEventListener(document.body)};var i=elk_itemPos(e);this.oContainerDiv.style.top=(i[1]+e.offsetHeight)+'px';this.oContainerDiv.style.left=(i[0]-1)+'px';this.oClickedIcon=e;if(this.bListLoaded)this.oContainerDiv.style.display='block';document.body.addEventListener('mousedown',this.onWindowMouseDown,!1)};IconList.prototype.onIconsReceived=function(e){var i=e.getElementsByTagName('elk')[0].getElementsByTagName('icon'),n='';for(var t=0,o=i.length;t<o;t++)n+='<span onmouseover="'+this.opt.sBackReference+'.onItemHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onItemHover(this, false);" onmousedown="'+this.opt.sBackReference+'.onItemMouseDown(this, \''+i[t].getAttribute('value')+'\');" style="padding: 2px 3px; line-height: 20px; border: '+this.opt.sItemBorder+'; background: '+this.opt.sItemBackground+'"><img src="'+i[t].getAttribute('url')+'" alt="'+i[t].getAttribute('name')+'" title="'+i[t].firstChild.nodeValue+'" style="vertical-align: middle" /></span>';this.oContainerDiv.innerHTML=n;this.oContainerDiv.style.display='block';this.bListLoaded=!0;if(is_ie)this.oContainerDiv.style.width=this.oContainerDiv.clientWidth+'px';ajax_indicator(!1)};IconList.prototype.onItemHover=function(e,t){e.style.background=t?this.opt.sItemBackgroundHover:this.opt.sItemBackground;e.style.border=t?this.opt.sItemBorderHover:this.opt.sItemBorder;if(this.iCurTimeout!==0)window.clearTimeout(this.iCurTimeout);if(t)this.onBoxHover(this.oClickedIcon,!0);else this.iCurTimeout=window.setTimeout(this.opt.sBackReference+'.collapseList();',500)};IconList.prototype.onItemMouseDown=function(e,t){if(this.iCurMessageId!==0){ajax_indicator(!0);this.tmpMethod=getXMLDocument;var n=this.tmpMethod(elk_prepareScriptUrl(elk_scripturl)+'action=jsmodify;topic='+this.opt.iTopicId+';msg='+this.iCurMessageId+';'+elk_session_var+'='+elk_session_id+';icon='+t+';xml');delete this.tmpMethod;ajax_indicator(!1);var i=n.responseXML.getElementsByTagName('elk')[0].getElementsByTagName('message')[0];if(i.getElementsByTagName('error').length===0){if((this.opt.bShowModify&&i.getElementsByTagName('modified').length!==0)&&(document.getElementById('modified_'+this.iCurMessageId)!==null))document.getElementById('modified_'+this.iCurMessageId).innerHTML=i.getElementsByTagName('modified')[0].childNodes[0].nodeValue;this.oClickedIcon.getElementsByTagName('img')[0].src=e.getElementsByTagName('img')[0].src}}
else{this.oClickedIcon.getElementsByTagName('img')[0].src=e.getElementsByTagName('img')[0].src;if('sLabelIconBox' in this.opt)document.getElementById(this.opt.sLabelIconBox).value=t}};IconList.prototype.onWindowMouseDown=function(){for(var e=aIconLists.length-1;e>=0;e--){aIconLists[e].funcParent.tmpMethod=aIconLists[e].collapseList;aIconLists[e].funcParent.tmpMethod();delete aIconLists[e].funcParent.tmpMethod}};IconList.prototype.collapseList=function(){this.onBoxHover(this.oClickedIcon,!1);this.oContainerDiv.style.display='none';this.iCurMessageId=0;document.body.removeEventListener('mousedown',this.onWindowMouseDown,!1)};function elk_itemPos(e){var t=0,i=0;if('offsetParent' in e){t=e.offsetLeft;i=e.offsetTop;while(e.offsetParent&&typeof(e.offsetParent)==='object'){e=e.offsetParent;t+=e.offsetLeft;i+=e.offsetTop}}
else if('x' in e){t=e.x;i=e.y};return[t,i]};function elk_prepareScriptUrl(e){return e.indexOf('?')===-1?e+'?':e+(e.charAt(e.length-1)==='?'||e.charAt(e.length-1)==='&'||e.charAt(e.length-1)===';'?'':';')};var aOnloadEvents=[];function addLoadEvent(e){if(typeof(e)==='function'&&(!('onload' in window)||typeof(window.onload)!=='function'))window.onload=e;else if(aOnloadEvents.length===0){aOnloadEvents[0]=window.onload;aOnloadEvents[1]=e;window.onload=function(){for(var e=0,t=aOnloadEvents.length;e<t;e++){if(typeof(aOnloadEvents[e])==='function')aOnloadEvents[e]();else if(typeof(aOnloadEvents[e])==='string')eval(aOnloadEvents[e])}}}
else aOnloadEvents[aOnloadEvents.length]=e};function elkSelectText(e,t){var i=null;if(typeof(t)==='boolean'&&t)i=document.getElementById(e);else i=e.parentNode.nextSibling;if(typeof(i)!=='object'||i===null)return!1;if('createTextRange' in document.body){var s=document.body.createTextRange();s.moveToElementText(i);s.select()}
else if(window.getSelection){var n=window.getSelection(),o=document.createRange();o.selectNodeContents(i);n.removeAllRanges();n.addRange(o)};return!1};function smc_saveEntities(e,t,i){var n=0,o=0;if(typeof(i)==='string'){for(n=0,o=document.forms[e].elements.length;n<o;n++){if(document.forms[e].elements[n].id.substr(0,i.length)===i){t[t.length]=document.forms[e].elements[n].name}}};for(n=0,o=t.length;n<o;n++){if(t[n]in document.forms[e]){if(typeof post_box_name!=='undefined'&&t[n]===post_box_name&&$editor_data[post_box_name]!==undefined){document.forms[e][t[n]].value=$editor_data[post_box_name].val().replace(/&#/g,'&#38;#');$editor_data[post_box_name].val(document.forms[e][t[n]].value)}
else{document.forms[e][t[n]].value=document.forms[e][t[n]].value.replace(/&#/g,'&#38;#')}}}};function pollOptions(){var e=document.getElementById('poll_expire');if(isEmptyText(e)||e.value===0){document.forms[form_name].poll_hide[2].disabled=!0;if(document.forms[form_name].poll_hide[2].checked)document.forms[form_name].poll_hide[1].checked=!0}
else document.forms[form_name].poll_hide[2].disabled=!1};function generateDays(e){e=typeof(e)!=='undefined'?e:'';var n=0,o=0,t=document.getElementById('day'+e),a=document.getElementById('year'+e),r=document.getElementById('month'+e),s=[31,28,31,30,31,30,31,31,30,31,30,31];s[1]=28;if(a.options[a.selectedIndex].value%4===0)s[1]=29;o=t.selectedIndex;while(t.options.length)t.options[0]=null;n=s[r.value-1];for(var i=1;i<=n;i++)t.options[t.length]=new Option(i,i);if(o<n)t.selectedIndex=o};function toggleLinked(e){e.board.disabled=!e.link_to_board.checked};function initSearch(){if(document.forms.searchform.search.value.indexOf('%u')!==-1)document.forms.searchform.search.value=decodeURI(document.forms.searchform.search.value)};function selectBoards(e,t,i){var s=!0,n=0;for(var o=0,a=document.forms.length;o<a;o++){if(document.forms[o].name==t){aForm=document.forms[o];break}};if(typeof aForm=='undefined')return;for(n=0;n<e.length;n++)s=s&&aForm[i+'['+e[n]+']'].checked;for(n=0;n<e.length;n++)aForm[i+'['+e[n]+']'].checked=!s};function expandCollapse(e,t,i){var n=$('#'+e);t=t||!1;i=i||300;if(t)$('#'+t).attr('src',elk_images_url+(n.is(':hidden')!==!0?'/selected.png':'/selected_open.png'));n.slideToggle(i)};function initHighlightSelection(e){$('#'+e+' [name="def_language"]').on('click',function(t){$('#'+e+' .standard_row').removeClass('highlight2');$(this).parent().parent().addClass('highlight2')})};function doAutoSubmit(e,t,i){var n=typeof(i)!=='undefined'?i:'autoSubmit';if(e===0)document.forms[n].submit();else if(e===-1)return;document.forms[n].cont.value=t+' ('+e+')';e--;setTimeout(function(){doAutoSubmit(e,t,n)},1000)};
/*!
 * @name      ElkArte Forum
 * @copyright ElkArte Forum contributors
 * @license   BSD http://opensource.org/licenses/BSD-3-Clause
 *
 * @version 1.1
 */
;function elk_codefix(){$('.bbc_code').each(function(){var e=$(this);if(e.get(0).scrollHeight>e.innerHeight()){e.css('height',e.height());e.css('max-height','none')}
else{e.css('resize','none')}})};function toggleButtonAJAX(e,t,i){$.ajax({type:'GET',url:e.href+';xml;api',context:document.body,beforeSend:ajax_indicator(!0)}).done(function(n){if(n==='')return;var o=$(n).find('elk')[0];if(o.getElementsByTagName('error').length===0){var a=o.getElementsByTagName('text'),r=o.getElementsByTagName('url'),l=o.getElementsByTagName('confirm');if(l.length===1)var s=l[0].firstChild.nodeValue.removeEntities();$('.'+e.className.replace(/(list|link)level\d/g,'').trim()).each(function(){if(a.length===1)$(this).html('<span>'+a[0].firstChild.nodeValue.removeEntities()+'</span>');if(r.length===1)$(this).attr('href',r[0].firstChild.nodeValue.removeEntities());if(typeof(s)!=='undefined')eval(t+'= \''+s.replace(/[\\']/g,'\\$&')+'\'')})}
else{if(o.getElementsByTagName('text').length!==0)alert(o.getElementsByTagName('text')[0].firstChild.nodeValue.removeEntities());if(o.getElementsByTagName('url').length!==0)window.location.href=o.getElementsByTagName('url')[0].firstChild.nodeValue};if(typeof(i)!=='undefined')i(e,n,o.getElementsByTagName('error'))}).fail(function(){}).always(function(){ajax_indicator(!1)});return!1};function toggleHeaderAJAX(e,t){ajax_indicator(!0);var i='<div class="board_row centertext">{body}</div>';$.ajax({type:'GET',url:e.href+';xml;api',context:document.body,beforeSend:ajax_indicator(!0)}).done(function(e){if(e==='')return;var n=$(e).find('elk')[0];if(n.getElementsByTagName('error').length===0){var o=n.getElementsByTagName('text'),s=n.getElementsByTagName('body');$('#'+t+' .pagesection').remove();$('#'+t+' .topic_listing').remove();$('#'+t+' .topic_sorting').remove();if(o.length===1)$('#'+t+' #unread_header').html(o[0].firstChild.nodeValue.removeEntities());if(s.length===1)$(i.replace('{body}',s[0].firstChild.nodeValue.removeEntities())).insertAfter('#unread_header')}}).fail(function(){}).always(function(){ajax_indicator(!1)})};function notifyButton(e){if(typeof(notification_topic_notice)!=='undefined'&&!confirm(notification_topic_notice))return!1;return toggleButtonAJAX(e,'notification_topic_notice',function(e,t,i){var n=0;if(i.length>0)return;if(e.href.indexOf('sa=on')!==-1)n=1;else n=0;$('input[name=\'notify\']').val(n)})};function notifyboardButton(e){if(typeof(notification_board_notice)!=='undefined'&&!confirm(notification_board_notice))return!1;toggleButtonAJAX(e,'notification_board_notice');return!1};function unwatchButton(e){toggleButtonAJAX(e);return!1};function markboardreadButton(e){if(!confirm(txt_mark_as_read_confirm)){return!1};toggleButtonAJAX(e);$('.new_posts').remove();return!1};function markallreadButton(e){if(!confirm(txt_mark_as_read_confirm)){return!1};toggleButtonAJAX(e);$('.new_posts').remove();$('.board_icon').each(function(){$(this).removeClass('i-board-new i-board-sub').addClass('i-board-off')});$('.board_new_posts').removeClass('board_new_posts');return!1};function markunreadButton(e){if(!confirm(txt_mark_as_read_confirm)){return!1};toggleHeaderAJAX(e,'main_content_section');return!1};var relative_time_refresh=0;function updateRelativeTime(){relative_time_refresh=3600000;$('time').each(function(){var e=new relativeTime($(this).data('timestamp')*1000,oRttime.referenceTime),t='';if(e.seconds()){$(this).text(oRttime.now);relative_time_refresh=Math.min(relative_time_refresh,10000)}
else if(e.minutes()){t=e.deltaTime>1?oRttime.minutes:oRttime.minute;$(this).text(t.replace('%s',e.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,60000)}
else if(e.hours()){t=e.deltaTime>1?oRttime.hours:oRttime.hour;$(this).text(t.replace('%s',e.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,3600000)}
else if(e.days()){t=e.deltaTime>1?oRttime.days:oRttime.day;$(this).text(t.replace('%s',e.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,3600000)}
else if(e.weeks()){t=e.deltaTime>1?oRttime.weeks:oRttime.week;$(this).text(t.replace('%s',e.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,3600000)}
else if(e.months()){t=e.deltaTime>1?oRttime.months:oRttime.month;$(this).text(t.replace('%s',e.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,3600000)}
else if(e.years()){t=e.deltaTime>1?oRttime.years:oRttime.year;$(this).text(t.replace('%s',e.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,3600000)}});oRttime.referenceTime+=relative_time_refresh;setTimeout(function(){updateRelativeTime()},relative_time_refresh)};function relativeTime(e,t){if(typeof t==='undefined'){this.dateTo=new Date()}
else if(parseInt(t)=='NaN'){var n=t.split(/\D/);this.dateTo=new Date(n[0],--n[1],n[2],n[3],n[4])}
else this.dateTo=new Date(t);if(parseInt(e)=='NaN'){var i=e.split(/\D/);this.dateFrom=new Date(i[0],--i[1],i[2],i[3],i[4])}
else this.dateFrom=new Date(e);this.time_text='';this.past_time=(this.dateTo-this.dateFrom)/1000;this.deltaTime=0};relativeTime.prototype.seconds=function(){if(this.past_time<60){this.deltaTime=this.past_time;return!0};return!1};relativeTime.prototype.minutes=function(){if(this.past_time>=60&&Math.round(this.past_time/60)<60){this.deltaTime=Math.round(this.past_time/60);return!0};return!1};relativeTime.prototype.hours=function(){if(Math.round(this.past_time/60)>=60&&Math.round(this.past_time/3600)<24){this.deltaTime=Math.round(this.past_time/3600);return!0};return!1};relativeTime.prototype.days=function(){if(Math.round(this.past_time/3600)>=24&&Math.round(this.past_time/(24*3600))<7){this.deltaTime=Math.round(this.past_time/(24*3600));return!0};return!1};relativeTime.prototype.weeks=function(){if(Math.round(this.past_time/(24*3600))>=7&&Math.round(this.past_time/(24*3600))<30){this.deltaTime=Math.round(this.past_time/(24*3600)/7);return!0};return!1};relativeTime.prototype.months=function(){if(Math.round(this.past_time/(24*3600))>=30&&Math.round(this.past_time/(30*24*3600))<12){this.deltaTime=Math.round(this.past_time/(30*24*3600));return!0};return!1};relativeTime.prototype.years=function(){if(Math.round(this.past_time/(30*24*3600))>=12){this.deltaTime=this.dateTo.getFullYear()-this.dateFrom.getFullYear();return!0};return!1};function revalidateMentions(e,t){var c,r,i,l,u=-1,p=/[ \.,;!\?'-\\\/="]/i;for(var n=0,m=all_elk_mentions.length;n<m;n++){if(all_elk_mentions[n].selector===t||all_elk_mentions[n].selector==='#'+t){if(all_elk_mentions[n].oOptions.isPlugin){var a=$editor_data[all_elk_mentions[n].selector];c=a.opts.mentionOptions.cache.names;r=a.opts.mentionOptions.cache.queries;i=a.getText().replace(/[\u00a0\r\n]/g,' ');l=$(a.opts.mentionOptions.cache.mentions)}
else{c=all_elk_mentions[n].oMention.cached_names;r=all_elk_mentions[n].oMention.cached_queries;i=document.forms[e][t].value.replace(/[\u00a0\r\n]/g,' ');l=$(all_elk_mentions[n].oMention.mentions)};i=' '+i+' ';$(l).find('input').each(function(e,t){var n=$(t).data('name'),o,s,a=i.indexOf(n);if(typeof(n)!=='undefined'){if(a===-1)$(t).remove();else{o=i.charAt(a+n.length);s=i.charAt(a-1);if(o!==''&&o.search(p)!==0)$(t).remove();else if(s!==''&&s.search(p)!==0)$(t).remove()}}});for(var d=0,f=r.length;d<f;d++){var s=c[r[d]];for(var o=0,h=s.length;o<h;o++){if(checkWordOccurrence(i,s[o].name)){u=i.indexOf(' @'+s[o].name);if(u!==-1&&i.charAt(u+2+s[o].name.length+1).search(p)===0)l.append($('<input type="hidden" name="uid[]" />').val(s[o].id))}}}}}};function checkWordOccurrence(e,t){return new RegExp('\\b'+t+'\\b','i').test(e)};var all_elk_mentions=[];function add_elk_mention(e,t){if(all_elk_mentions.hasOwnProperty(e))return;if(typeof t==='undefined')t={};t.selector=e;all_elk_mentions[all_elk_mentions.length]={selector:e,oOptions:t}}(function(e){'use strict';e.fn.elkSortable=function(t){e.fn.elkSortable.oDefaultsSettings={opacity:0.7,cursor:'move',axis:'y',scroll:!0,containment:'parent',delay:150,handle:'',href:'',tolerance:'intersect',setorder:'serialize',placeholder:'',preprocess:'',tag:'#table_grid_sortable',connect:'',sa:'',title:'',error:'',token:''};var i=e.extend({},e.fn.elkSortable.oDefaultsSettings,t||{});if(typeof i.infobar==='undefined'){i.infobar=new ElkInfoBar('sortable_bar',{error_class:'errorbox',success_class:'infobox'})};e('<div id=\'errorContainer\'><div/>').appendTo('body');e('#errorContainer').css({'display':'none'});e(i.tag).sortable({opacity:i.opacity,cursor:i.cursor,axis:i.axis,handle:i.handle,containment:i.containment,connectWith:i.connect,placeholder:i.placeholder,tolerance:i.tolerance,delay:i.delay,scroll:i.scroll,helper:function(t,n){var a=n.children(),s=n.clone(),o;s.children().each(function(){e(this).replaceWith(function(){return e('<span />',{html:e(this).html()})})});s.children().each(function(t){return e(this).width(a.eq(t).width()).css('display','inline-block')});e('body').append('<div id="clone" class="'+i.placeholder+'">'+s.html()+'</div>');o=e('#clone');o.hide();setTimeout(function(){o.appendTo(n.parent());o.show()},1);return o},update:function(t,n){var o='',a=n.item.attr('id'),s=[],r=n.item.parent().attr('id');if(i.preprocess!=='')window[i.preprocess]();if(i.setorder==='inorder'){e(i.tag).find('li').each(function(){var t=e(this).attr('id').split('_');s.push({name:t[0]+'[]',value:t[1]})});o=e.param(s)}
else{e(i.tag).each(function(){if(o==='')o+=e(this).sortable(i.setorder);else o+='&'+e(this).sortable(i.setorder)})};o+='&'+elk_session_var+'='+elk_session_id;o+='&order=reorder';o+='&moved='+a;o+='&received='+r;if(i.token!=='')o+='&'+i.token.token_var+'='+i.token.token_id;e.ajax({type:'POST',url:elk_scripturl+'?action=xmlhttp;sa='+i.sa+';xml',dataType:'xml',data:o}).fail(function(e,t,n){i.infobar.isError();i.infobar.changeText(t).showBar();if(i.href!=='')setTimeout(function(){window.location.href=elk_scripturl+i.href},1000)}).done(function(t,n,o){var s=e('#errorContent'),a=e('#errorContainer');if(e(t).find('error').length!==0){a.append('<p id="errorContent"></p>');s.html(e(t).find('error').text());s.dialog({autoOpen:!0,title:i.title,modal:!0,close:function(e,t){if(i.href!=='')window.location.href=elk_scripturl+i.href}})}
else if(e(t).find('elk').length!==0){i.infobar.isSuccess();i.infobar.changeText(e(t).find('elk > orders > order').text()).showBar()}
else{a.append('<p id="errorContent"></p>');s.html(i.error+' : '+n);s.dialog({autoOpen:!0,title:i.title,modal:!0})}}).always(function(t,n,o){if(e(t).find('elk > tokens > token').length!==0){i.token.token_id=e(t).find('tokens').find('[type="token"]').text();i.token.token_var=e(t).find('tokens').find('[type="token_var"]').text()}})}})}})(jQuery);function setBoardIds(){$('[id^=category_]').each(function(){var t=$(this).attr('id').split('category_'),e=$(this).find('ul');if(e.length===1){if($(e).find('li').length===0)$(e).append('<li id="cbp_'+t+',-1,-1"></li>');else $(e).find('li:not(:has(ul))').append('<ul class="nolist elk_droppings"></ul>')}
else $(e).find('li:not(:has(ul))').append('<ul class="nolist elk_droppings"></ul>');$(this).find('ul:parent').each(function(e,i){var o=$(this).parent('li').attr('id'),n=0;if(typeof(o)!=='undefined'){n=o.split(',');n=n[1]};$(this).find('li').each(function(e,i){var s=$(i).attr('id'),o=s.split(',');$(i).removeAttr('id');o='cbp_'+t[1]+','+o[1]+','+n;$(i).attr('id',o)})})})};(function(e){e.fn.expand_pages=function(){function t(i){var r=e(i.closest('.linavPages')),h=r.prev().clone(),m=h.find('a').clone(),l=i.clone(),n=i.data('perpage'),d=i.data('firstpage'),o=i.data('lastpage'),g=i.data('baseurl'),v=eval(i.data('baseurl')),c,s=0,u=0,f=10;if((o-d)/n>f){u=o;o=d+f*n};for(s=o;s>d;s-=n){var p=m.clone(),a=h.clone();p.attr('href',v.replace('%1$d',s-n)).text(s/n);a.find('a').each(function(){e(this).replaceWith(p[0])});r.after(a);if(typeof c==='undefined')c=a};r.remove();if(u>0){l.find('#expanded_pages_container').each(function(){e(this).remove()});l.on('click',function(i){var n=e(this);i.preventDefault();t(n);n.off('mouseenter focus')}).on('mouseenter focus',function(){hover_expand(e(this))}).data('perpage',n).data('firstpage',o).data('lastpage',u).data('baseurl',g);c.after(l)}};this.attr('tabindex',0).on('click',function(i){var n=e(this);i.preventDefault();t(n)})}})(jQuery);(function(e){'use strict';e.fn.SiteTooltip=function(t){e.fn.SiteTooltip.oDefaultsSettings={followMouse:1,hoverIntent:{sensitivity:10,interval:650,timeout:50},positionTop:12,positionLeft:12,tooltipID:'site_tooltip',tooltipTextID:'site_tooltipText',tooltipClass:'tooltip',tooltipSwapClass:'site_swaptip',tooltipContent:'html'};var i=e.extend({},e.fn.SiteTooltip.oDefaultsSettings,t||{});e(this).each(function(){var t=e('<span class="'+i.tooltipSwapClass+'">'+this.title+'</span>').hide();e(this).append(t).attr('title','')});var n=function(t){var s=0,a=0,r=e('#'+i.tooltipID);if(!t)t=window.event;if(t.pageX||t.pageY){s=t.pageX;a=t.pageY}
else if(t.clientX||t.clientY){s=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;a=t.clientY+document.body.scrollTop+document.documentElement.scrollTop};var n={x:s+i.positionLeft,y:a+i.positionTop,w:r.width(),h:r.height()};var o={x:e(window).scrollLeft(),y:e(window).scrollTop(),w:e(window).width()-24,h:e(window).height()-24};if((n.y+n.h>o.y+o.h)&&(n.x+n.w>o.x+o.w)){n.x=(n.x-n.w)-45;n.y=(n.y-n.h)-45}
else if((n.x+n.w)>(o.x+o.w)){n.x-=(((n.x+n.w)-(o.x+o.w))+24)}
else if(n.y+n.h>o.y+o.h){n.y-=(((n.y+n.h)-(o.y+o.h))+24)};r.css({'left':n.x+'px','top':n.y+'px'})},s=function(){e('#'+i.tooltipID+' #'+i.tooltipTextID).slideDown(150)},o=function(){var t=e('#'+i.tooltipID);t.fadeOut(175,function(){e(this).trigger('unload').remove()})};function a(t){return e('<span>').text(t).html()};return this.each(function(){if(e.fn.hoverIntent){e(this).hoverIntent({sensitivity:i.hoverIntent.sensitivity,interval:i.hoverIntent.interval,over:t,timeout:i.hoverIntent.timeout,out:a})}
else{e(this).hover(t,a)};function t(t){if(e(this).children('.'+i.tooltipSwapClass).text()){e('body').append('<div id="'+i.tooltipID+'" class="'+i.tooltipClass+'"><div id="'+i.tooltipTextID+'" class="hide"></div></div>');var o=e('#'+i.tooltipTextID);if(i.tooltipContent==='html')o.html(e(this).children('.'+i.tooltipSwapClass).html());else o.text(e(this).children('.'+i.tooltipSwapClass).text());s();n(t)};return!1};function a(e){o(this);return!1};if(i.followMouse){e(this).on('mousemove',function(e){n(e);return!1})};e(this).on('click',function(){o(this);return!0})})}})(jQuery);var error_txts={};function errorbox_handler(e){this.opt=e;this.oError_box=null;this.oErrorHandle=window;this.evaluate=!1;this.init()};errorbox_handler.prototype.init=function(){if(this.opt.check_id!==undefined)this.oChecks_on=$(document.getElementById(this.opt.check_id));else if(this.opt.selector!==undefined)this.oChecks_on=this.opt.selector;else if(this.opt.editor!==undefined){this.oChecks_on=eval(this.opt.editor);this.evaluate=!0};this.oErrorHandle.instanceRef=this;if(this.oError_box===null)this.oError_box=$(document.getElementById(this.opt.error_box_id));if(this.evaluate===!1){this.oChecks_on.attr('onblur',this.opt.self+'.checkErrors()');this.oChecks_on.attr('onkeyup',this.opt.self+'.checkErrors()')}
else{var e=this.opt.self;$(function(){var t=eval(e);$editor_data[t.opt.editor_id].addEvent(t.opt.editor_id,'keyup',function(){t.checkErrors()})})}};errorbox_handler.prototype.boxVal=function(){if(this.evaluate===!1)return this.oChecks_on.val();else return this.oChecks_on()};errorbox_handler.prototype.checkErrors=function(){var i=this.opt.error_checks.length;if(i!==0){for(var e=0;e<i;e++){var t=$(document.getElementById(this.opt.error_box_id+'_'+this.opt.error_checks[e].code));if(this.opt.error_checks[e].efunction(this.boxVal()))this.addError(t,this.opt.error_checks[e].code);else this.removeError(this.oError_box,t)};this.oError_box.attr('class','errorbox')};if(this.oError_box.find('li').length===0)this.oError_box.slideUp();else this.oError_box.slideDown()};errorbox_handler.prototype.addError=function(e,t){if(e.length===0){if($.trim(this.oError_box.children('#'+this.opt.error_box_id+'_list').html())==='')this.oError_box.append('<ul id=\''+this.opt.error_box_id+'_list\'></ul>');$(document.getElementById(this.opt.error_box_id+'_list')).append('<li style="display:none;" id=\''+this.opt.error_box_id+'_'+t+'\' class=\'error\'>'+error_txts[t]+'</li>');$(document.getElementById(this.opt.error_box_id+'_'+t)).slideDown()}};errorbox_handler.prototype.removeError=function(e,t){if(t.length!==0){t.slideUp(function(){t.remove();if(e.find('li').length===0)e.slideUp()})}};function addAnotherOption(e,t,i,n){t['type']=t.type||'text';t['class']=t['class']||'input_text';t['size']=t.size||'20';i['type']=i.type||'text';i['class']=i['class']||'input_text';i['size']=i.size||'20';n=n||'';var c=document.createElement('dt'),o=document.createElement('input');o.name=t.name;o.type=t.type;o.setAttribute('class',t['class']);o.size=t.size;c.appendChild(o);var d=document.createElement('dd');if(n==='')o=document.createElement('input');else o=document.createElement('select');o.name=i.name;o.type=i.type;o.size=i.size;o.setAttribute('class',i['class']);d.appendChild(o);if(n!==''){var s,l,r;for(l in n){r=n[l];s=document.createElement('option');s.name='option';s.value=r.id;s.innerHTML=r.name;o.appendChild(s)}};var a=document.getElementById(e);a.parentNode.insertBefore(c,a);a.parentNode.insertBefore(d,a)};function toggle_mlsearch_opt(){var e=$('#mlsearch_options');if(e.is(':visible'))return;e.fadeIn('fast');$('body').on('click',mlsearch_opt_hide);$('#mlsearch_options, #mlsearch_input').off('click',mlsearch_opt_hide).on('click',function(e){e.stopPropagation()})};function mlsearch_opt_hide(){$('body').off('click',mlsearch_opt_hide);$('#mlsearch_options').slideToggle('fast')};function loadAddNewPoll(e,t,i){if(typeof t==='undefined')return!0;var n=$('#post_header').closest('form'),o=$('#poll_main, #poll_options');if($(e).val()===poll_add){$(e).val(poll_remove);var a=$('#icon');if(a.val()==='xx')a.val('poll').change();n.attr('action',n.attr('action')+';poll');if($('#poll_main').length>0){o.find('input').each(function(){if($(this).data('required')==='required')$(this).attr('required','required')});o.toggle();return!1}}
else{var s=$('#icon');if(s.val()==='poll')s.val('xx').change();n.attr('action',n.attr('action').replace(';poll',''));o.hide().find('input').each(function(){if($(this).attr('required')==='required'){$(this).data('required','required');$(this).removeAttr('required')}});$(e).val(poll_add);return!1};$.ajax({url:elk_scripturl+'?action=poll;sa=interface;xml;board='+t,type:'GET',dataType:'html',beforeSend:ajax_indicator(!0)}).done(function(e,t,n){var s=0;for(var o=0,a=document.forms[i].elements.length;o<a;o++)s=Math.max(s,document.forms[i].elements[o].tabIndex);$('#post_header').after(e);$('#poll_main input, #poll_options input').each(function(){$(this).attr('tabindex',++s)});$('#poll_main legend, #poll_options legend').on('click',function(){$(this).siblings().slideToggle('fast');$(this).parent().toggleClass('collapsed')}).each(function(){if($(this).data('collapsed')){$(this).siblings().css({display:'none'});$(this).parent().toggleClass('collapsed')}})}).always(function(){ajax_indicator(!1)});return!1};function disableAutoComplete(){window.onload=function(){$('input[type=email], input[type=password], .input_text, .input_clear').attr('autocomplete','off');setTimeout(function(){$('input[type=password], .input_clear').val(' ').val('')},1)}}(function(){var e=(function(e){'use strict';e=(e)?e:{};var t=[],o=!0,i=0,s=function(e){if(typeof e.delay==='undefined'){o=!1;e.delay=15000};setTimeout(function(){n()},e.delay)},a=function(e){t.push(e)},r=function(e){for(var i=0;i<t.length;i++){t[i].send(e)}},n=function(){if(t.length===0)return;$.ajax({url:elk_scripturl+'?action=mentions;sa=fetch;api=json;lastsent='+i}).done(function(t){if(t!==''){r(t);i=t.timelast};setTimeout(function(){n()},e.delay)})};s(e);return{add:a}});if(typeof define!=='undefined'&&define.amd){define([],function(){return e})}
else if(typeof module!=='undefined'&&module.exports){module.exports=e}
else{this.ElkNotifications=e}})();var ElkNotifier=new ElkNotifications();(function(){var e=(function(e,t,i){'use strict';$.extend(i,{inlineSelector:'.inline_insert',data:'attachid',addAfter:'label'});var n=[],o=function(e){},s=function(e,o){var s;if(typeof i.trigger!=='undefined')s=i.trigger.clone();else{s=$('<a />');if(typeof i.triggerClass!=='undefined')s.addClass(i.triggerClass)};s.on('click',function(e){e.preventDefault();var i='[attach]'+o+'[/attach]';$editor_data[t].insertText(i,!1,!0)}).attr('id','inline_attach_'+o).data('attachid',o);e.after(s);n.push(s)},a=function(e){var i=[],t;for(t=0;t<n.length;t++){if(n[t].data('attachid')==e)break;i.push(n[t])};t++;for(;t<n.length;t++){i.push(n[t])};n=i;$('#inline_attach_'+e).remove()};o(i);return{addInterface:s,removeAttach:a}});if(typeof define!=='undefined'&&define.amd){define([],function(){return e})}
else if(typeof module!=='undefined'&&module.exports){module.exports=e}
else{this.ElkInlineAttachments=e}})();(function(){var e=(function(e,t){'use strict';t=$.extend({text:'',class:'ajax_infobar',hide_delay:4000,error_class:'error',success_class:'success'},t);var i=$('#'+e),n=null,r=function(e,t){clearTimeout(n);if(i.length===0){i=$('<div id="'+e+'" class="'+t.class+' hide" />');$('body').append(i);i.attr('id',e);i.addClass(t.class);i.text(t.text)}},l=function(e){clearTimeout(n);i.html(e);return this},o=function(e){i.addClass(e);return this},s=function(e){i.removeClass(e);return this},d=function(){clearTimeout(n);i.fadeIn();if(t.hide_delay!==0){n=setTimeout(function(){a()},t.hide_delay)};return this},c=function(){s(t.success_class);o(t.error_class)},u=function(){s(t.error_class);o(t.success_class)},a=function(){clearTimeout(n);i.slideUp();return this};r(e,t);return{changeText:l,addClass:o,removeClass:s,showBar:d,isError:c,isSuccess:u,hide:a}});if(typeof define!=='undefined'&&define.amd){define([],function(){return e})}
else if(typeof module!=='undefined'&&module.exports){module.exports=e}
else{this.ElkInfoBar=e}})();
/*!
 * @name      ElkArte Forum
 * @copyright ElkArte Forum contributors
 * @license   BSD http://opensource.org/licenses/BSD-3-Clause
 *
 * This file contains code covered by:
 * copyright:	2011 Simple Machines (http://www.simplemachines.org)
 * license:		BSD, See included LICENSE.TXT for terms and conditions.
 *
 * @version 1.1
 */
;$(function(){if(use_click_menu)$('#main_menu, ul.admin_menu, ul.sidebar_menu, ul.poster, ul.quickbuttons, #sort_by').superclick({speed:150,animation:{opacity:'show',height:'toggle'},speedOut:0,activeClass:'sfhover'});else $('#main_menu, ul.admin_menu, ul.sidebar_menu, ul.poster, ul.quickbuttons, #sort_by').superfish({delay:300,speed:175,hoverClass:'sfhover'});$('a[href=\'#top\']').on('click',function(e){e.preventDefault();$('html,body').animate({scrollTop:0},1200)});$('a[href=\'#bot\']').on('click',function(e){e.preventDefault();var t=$('#bot'),i=t.height();$('html,body').animate({scrollTop:t.offset().top+i-$(window).height()},1200)});if((!is_mobile&&!is_touch)||use_click_menu)$('.preview').SiteTooltip({hoverIntent:{sensitivity:10,interval:750,timeout:50}});$('a.bbc_link img.bbc_img').parent().css('border','0');if(typeof elk_codefix==='function')elk_codefix();$('.expand_pages').expand_pages();$(document).on('click','legend',function(){$(this).siblings().slideToggle('fast');$(this).parent().toggleClass('collapsed')});$('legend',function(){if($(this).data('collapsed'))$(this).click()});$('.spoilerheader').click(function(){$(this).next().children().slideToggle('fast')});$('[data-lightboximage]').on('click.elk_lb',function(e){e.preventDefault();expandThumbLB($(this).data('lightboximage'),$(this).data('lightboxmessage'))});$('img').each(function(){if($(this).hasClass('bbc_img resized')===!1)return!0;$(this).css({'cursor':'pointer'});$(this).on('click.elk_bbc',function(){var e=$(this);if($.isEmptyObject(e.data('bbc_img'))){e.data('bbc_img',{width:e.css('width'),height:e.css('height'),'max-width':e.css('max-width'),'max-height':e.css('max-height')});e.css({'width':e.css('width')==='auto'?null:'auto'});e.css({'height':e.css('height')==='auto'?null:'auto'});e.css({'max-height':'none'});e.css({'max-width':'100%'});e.wrap('<div style="overflow:auto;display:inline-block;"></div>')}
else{e.css({'width':e.data('bbc_img').width});e.css({'height':e.data('bbc_img').height});e.css({'max-width':e.data('bbc_img')['max-width']});e.css({'max-height':e.data('bbc_img')['max-height']});e.removeData('bbc_img');e.unwrap();e.css({'max-width':'100%'})}})});$('.hamburger_30').click(function(e){e.preventDefault();var t=$(this).data('id');$('#'+t).addClass('visible');$(this).addClass('visible')})});function elk_addButton(e,t,i){var r=document.getElementById(e),o=r.getElementsByTagName('span');if(o.length>0){var a=o[o.length-1];a.className=a.className.replace(/\s*last/,'position_holder')};var l=r.getElementsByTagName('ul')[0],n=document.createElement('li'),s=document.createAttribute('role');s.value='menuitem';n.setAttributeNode(s);if('sId' in i)n.id=i.sId;n.innerHTML='<a class="linklevel1" href="'+i.sUrl+'" '+('sCustom' in i?i.sCustom:'')+'><span class="last"'+('sId' in i?' id="'+i.sId+'_text"':'')+'>'+i.sText+'</span></a>';l.appendChild(n)};
/*!
 * @name      ElkArte Forum
 * @copyright ElkArte Forum contributors
 * @license   BSD http://opensource.org/licenses/BSD-3-Clause
 *
 * This file contains code covered by:
 * copyright:	2011 Simple Machines (http://www.simplemachines.org)
 * license:		BSD, See included LICENSE.TXT for terms and conditions.
 *
 * @version 1.1.1
 */
;function QuickModifyTopic(e){this.opt=e;this.aHidePrefixes=this.opt.aHidePrefixes;this.iCurTopicId=0;this.sCurMessageId='';this.sBuffSubject='';this.oSavetipElem=!1;this.oCurSubjectDiv=null;this.oTopicModHandle=document;this.bInEditMode=!1;this.bMouseOnDiv=!1;this.init()};QuickModifyTopic.prototype.init=function(){this.oTopicModHandle.instanceRef=this;this.oTopicModHandle.onkeydown=function(e){return this.instanceRef.modify_topic_keypress(e)};this.oTopicModHandle.onclick=function(e){return this.instanceRef.modify_topic_click(e)}};QuickModifyTopic.prototype.modify_topic=function(e,t){if(this.bInEditMode){if(this.iCurTopicId===e)return;else this.modify_topic_cancel()};this.bInEditMode=!0;this.bMouseOnDiv=!0;this.iCurTopicId=e;ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+'action=quotefast;quote='+t+';modify;xml','',this.onDocReceived_modify_topic)};QuickModifyTopic.prototype.onDocReceived_modify_topic=function(e){if(!e||!e.getElementsByTagName('message')){this.modify_topic_cancel();return!0};this.sCurMessageId=e.getElementsByTagName('message')[0].getAttribute('id');this.oCurSubjectDiv=document.getElementById('msg_'+this.sCurMessageId.substr(4));this.sBuffSubject=this.oCurSubjectDiv.innerHTML;if($.isFunction($.fn.SiteTooltip)){this.oSavetipElem=this.oCurSubjectDiv.nextSibling;this.sSavetip=this.oSavetipElem.innerHTML;this.oSavetipElem.innerHTML=''};this.set_hidden_topic_areas('none');ajax_indicator(!1);this.modify_topic_show_edit(e.getElementsByTagName('subject')[0].childNodes[0].nodeValue)};QuickModifyTopic.prototype.modify_topic_cancel=function(){this.oCurSubjectDiv.innerHTML=this.sBuffSubject;this.set_hidden_topic_areas('');this.bInEditMode=!1;if(this.oSavetipElem!==!1)this.oSavetipElem.innerHTML=this.sSavetip;return!1};QuickModifyTopic.prototype.set_hidden_topic_areas=function(e){for(var t=0;t<this.aHidePrefixes.length;t++){if(document.getElementById(this.aHidePrefixes[t]+this.sCurMessageId.substr(4))!==null)document.getElementById(this.aHidePrefixes[t]+this.sCurMessageId.substr(4)).style.display=e}};QuickModifyTopic.prototype.modify_topic_show_edit=function(e){this.oCurSubjectDiv.innerHTML='<input type="text" name="subject" value="'+e+'" size="60" style="width: 95%;" maxlength="80" class="input_text" autocomplete="off" /><input type="hidden" name="topic" value="'+this.iCurTopicId+'" /><input type="hidden" name="msg" value="'+this.sCurMessageId.substr(4)+'" />';this.oCurSubjectDiv.instanceRef=this;this.oCurSubjectDiv.onmouseout=function(e){return this.instanceRef.modify_topic_mouseout(e)};this.oCurSubjectDiv.onmouseover=function(e){return this.instanceRef.modify_topic_mouseover(e)}};QuickModifyTopic.prototype.modify_topic_save=function(e,t){if(!this.bInEditMode)return!0;var i=[];i[i.length]='subject='+document.forms.quickModForm.subject.value.replace(/&#/g,'&#38;#').php_urlencode();i[i.length]='topic='+parseInt(document.forms.quickModForm.elements.topic.value);i[i.length]='msg='+parseInt(document.forms.quickModForm.elements.msg.value);ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+'action=jsmodify;topic='+parseInt(document.forms.quickModForm.elements.topic.value)+';'+t+'='+e+';xml',i.join('&'),this.modify_topic_done);return!1};QuickModifyTopic.prototype.modify_topic_done=function(e){ajax_indicator(!1);if(!e||!e.getElementsByTagName('subject')){this.modify_topic_cancel();return!0};var t=e.getElementsByTagName('elk')[0].getElementsByTagName('message')[0],i=t.getElementsByTagName('subject')[0],n=t.getElementsByTagName('error')[0];if(!i||n)return!1;this.modify_topic_hide_edit(i.childNodes[0].nodeValue);this.set_hidden_topic_areas('');this.bInEditMode=!1;if($.isFunction($.fn.SiteTooltip)){this.oSavetipElem.innerHTML=this.sSavetip;$('.preview').SiteTooltip()};return!1};QuickModifyTopic.prototype.modify_topic_hide_edit=function(e){this.oCurSubjectDiv.innerHTML='<a href="'+elk_scripturl+'?topic='+this.iCurTopicId+'.0">'+e+'</a>'};QuickModifyTopic.prototype.modify_topic_keypress=function(e){if(typeof(e.keyCode)!=='undefined'&&this.bInEditMode){if(e.keyCode===27){this.modify_topic_cancel();if(typeof(e.preventDefault)==='undefined')e.returnValue=!1;else e.preventDefault()}
else if(e.keyCode===13){this.modify_topic_save(elk_session_id,elk_session_var);if(typeof(e.preventDefault)==='undefined')e.returnValue=!1;else e.preventDefault()}}};QuickModifyTopic.prototype.modify_topic_click=function(e){if(this.bInEditMode&&!this.bMouseOnDiv)this.modify_topic_save(elk_session_id,elk_session_var)};QuickModifyTopic.prototype.modify_topic_mouseout=function(e){this.bMouseOnDiv=!1};QuickModifyTopic.prototype.modify_topic_mouseover=function(e){this.bMouseOnDiv=!0;e.preventDefault()};function QuickReply(e){this.opt=e;this.bCollapsed=this.opt.bDefaultCollapsed;this.bIsFull=this.opt.bIsFull;if(this.bCollapsed)this.swap(!0)};QuickReply.prototype.quote=function(e,t){ajax_indicator(!0);if(this.bCollapsed){window.location.href=elk_prepareScriptUrl(this.opt.sScriptUrl)+'action=post;quote='+e+';topic='+this.opt.iTopicId+'.'+this.opt.iStart;return!1};if(this.bIsFull)insertQuoteFast(e);else getXMLDocument(elk_prepareScriptUrl(this.opt.sScriptUrl)+'action=quotefast;quote='+e+';xml',this.onQuoteReceived);if(navigator.appName==='Microsoft Internet Explorer')window.location.hash=this.opt.sJumpAnchor;else window.location.hash='#'+this.opt.sJumpAnchor;return!1};QuickReply.prototype.onQuoteReceived=function(e){var i='';for(var t=0;t<e.getElementsByTagName('quote')[0].childNodes.length;t++)i+=e.getElementsByTagName('quote')[0].childNodes[t].nodeValue;replaceText(i,document.forms.postmodify.message);ajax_indicator(!1)};QuickReply.prototype.swap=function(e,t){var i=document.getElementById(this.opt.sClassId),o=this.opt.sContainerId,s=this.opt.bIsFull;e=typeof(e)!=='undefined';t=typeof(t)==='undefined';if(!e)this.bCollapsed=!this.bCollapsed;var n=!this.bCollapsed?this.opt.sClassCollapsed:this.opt.sClassExpanded;if(i.className!==n)i.className=n;i.title=i.title=this.bCollapsed?this.opt.sTitleCollapsed:this.opt.sTitleExpanded;if(this.bCollapsed)$('#'+this.opt.sContainerId).slideUp();else{$('#'+this.opt.sContainerId).slideDown();if(s)$('#'+o).resize()};if(t&&'oCookieOptions' in this.opt&&this.opt.oCookieOptions.bUseCookie)this.oCookie.set(this.opt.oCookieOptions.sCookieName,this.bCollapsed?'1':'0');if(!e&&t&&'oThemeOptions' in this.opt&&this.opt.oThemeOptions.bUseThemeSettings)elk_setThemeOption(this.opt.oThemeOptions.sOptionName,this.bCollapsed?'1':'0','sThemeId' in this.opt.oThemeOptions?this.opt.oThemeOptions.sThemeId:null,'sAdditionalVars' in this.opt.oThemeOptions?this.opt.oThemeOptions.sAdditionalVars:null)};function QuickModify(e){this.opt=e;this.bInEditMode=!1;this.sCurMessageId='';this.oCurMessageDiv=null;this.oCurInfoDiv=null;this.oCurSubjectDiv=null;this.oMsgIcon=null;this.sMessageBuffer='';this.sSubjectBuffer='';this.sInfoBuffer='';this.aAccessKeys=[];var i=document.getElementsByClassName(this.opt.sClassName);for(var t=0,n=i.length;t<n;t++)i[t].style.display='inline'};QuickModify.prototype.modifyMsg=function(e){if(typeof(this.opt.sFormRemoveAccessKeys)!=='undefined'){if(typeof(document.forms[this.opt.sFormRemoveAccessKeys])){var i=document.forms[this.opt.sFormRemoveAccessKeys].getElementsByTagName('input');for(var t=0;t<i.length;t++){if(i[t].accessKey!==''){this.aAccessKeys[i[t].name]=i[t].accessKey;i[t].accessKey=''}}}};if(this.bInEditMode)this.modifyCancel();this.bInEditMode=!0;ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+'action=quotefast;quote='+e+';modify;xml','',this.onMessageReceived)};QuickModify.prototype.onMessageReceived=function(e){var t='',n;ajax_indicator(!1);this.sCurMessageId=e.getElementsByTagName('message')[0].getAttribute('id');if(this.opt.sIconHide!==null){this.oMsgIcon=document.getElementById('messageicon_'+this.sCurMessageId.replace('msg_',''));if(this.oMsgIcon!==null&&getComputedStyle(this.oMsgIcon).getPropertyValue('display')==='none')this.oMsgIcon.style.display='inline'};if(!document.getElementById(this.sCurMessageId))return this.modifyCancel();for(var i=0;i<e.getElementsByTagName('message')[0].childNodes.length;i++)t+=e.getElementsByTagName('message')[0].childNodes[i].nodeValue;this.oCurMessageDiv=document.getElementById(this.sCurMessageId);this.sMessageBuffer=this.oCurMessageDiv.innerHTML;t=t.replace(/\$/g,'{&dollarfix;$}');this.oCurMessageDiv.innerHTML=this.opt.sTemplateBodyEdit.replace(/%msg_id%/g,this.sCurMessageId.substr(4)).replace(/%body%/,t).replace(/\{&dollarfix;\$\}/g,'$');if(this.opt.sIDSubject!==null){this.oCurSubjectDiv=document.getElementById(this.opt.sIDSubject+this.sCurMessageId.substr(4));if(this.oCurSubjectDiv!==null){this.oCurSubjectDiv.style.display='none';this.sSubjectBuffer=this.oCurSubjectDiv.innerHTML}};n=e.getElementsByTagName('subject')[0].childNodes[0].nodeValue.replace(/\$/g,'{&dollarfix;$}');if(this.opt.sIDInfo!==null){this.oCurInfoDiv=document.getElementById(this.opt.sIDInfo+this.sCurMessageId.substr(4));if(this.oCurInfoDiv!==null){this.sInfoBuffer=this.oCurInfoDiv.innerHTML;this.oCurInfoDiv.innerHTML=this.opt.sTemplateSubjectEdit.replace(/%subject%/,n).replace(/\{&dollarfix;\$\}/g,'$')}};location.hash='#info_'+this.sCurMessageId.substr(this.sCurMessageId.lastIndexOf('_')+1);if('funcOnAfterCreate' in this.opt){this.tmpMethod=this.opt.funcOnAfterCreate;this.tmpMethod(this);delete this.tmpMethod};return!0};QuickModify.prototype.modifyCancel=function(){if(this.oCurMessageDiv){this.oCurMessageDiv.innerHTML=this.sMessageBuffer;this.oCurInfoDiv.innerHTML=this.sInfoBuffer;this.oCurSubjectDiv.innerHTML=this.sSubjectBuffer;if(this.oCurSubjectDiv!==null){this.oCurSubjectDiv.style.display=''}};if(this.opt.sIconHide){var i=document.getElementById('msg_icon_'+this.sCurMessageId.replace('msg_',''));if(i!==null&&i.src.indexOf(this.opt.sIconHide)>0)this.oMsgIcon.style.display='none'};this.bInEditMode=!1;if(typeof(this.opt.sFormRemoveAccessKeys)!=='undefined'){if(typeof(document.forms[this.opt.sFormRemoveAccessKeys])){var t=document.forms[this.opt.sFormRemoveAccessKeys].getElementsByTagName('input');for(var e=0;e<t.length;e++){if(typeof(this.aAccessKeys[t[e].name])!=='undefined'){t[e].accessKey=this.aAccessKeys[t[e].name]}}}};return!1};QuickModify.prototype.modifySave=function(e,t){var i=0,n=[],a=[];if(!this.bInEditMode)return!0;this.bInEditMode=!1;if(typeof(this.opt.sFormRemoveAccessKeys)!=='undefined'){if(typeof(document.forms[this.opt.sFormRemoveAccessKeys])){var o=document.forms[this.opt.sFormRemoveAccessKeys].getElementsByTagName('input');for(i=0;i<o.length;i++){if(typeof(this.aAccessKeys[o[i].name])!=='undefined'){o[i].accessKey=this.aAccessKeys[o[i].name]}}}};var s=document.forms.quickModForm.getElementsByTagName('input');for(i=0;i<s.length;i++){if(s[i].name==='uid[]'){a.push('uid['+i+']='+parseInt(s[i].value))}};n[n.length]='subject='+document.forms.quickModForm.subject.value.replace(/&#/g,'&#38;#').php_urlencode();n[n.length]='message='+document.forms.quickModForm.message.value.replace(/&#/g,'&#38;#').php_urlencode();n[n.length]='topic='+parseInt(document.forms.quickModForm.elements.topic.value);n[n.length]='msg='+parseInt(document.forms.quickModForm.elements.msg.value);if(a.length>0)n[n.length]=a.join('&');ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(this.opt.sScriptUrl)+'action=jsmodify;topic='+this.opt.iTopicId+';'+elk_session_var+'='+elk_session_id+';xml',n.join('&'),this.onModifyDone);return!1};QuickModify.prototype.onModifyDone=function(e){var t;ajax_indicator(!1);if(!e||!e.getElementsByTagName('elk')[0]){if(typeof e.childNodes!=='undefined'&&e.childNodes.length>0&&e.firstChild.nodeName==='parsererror'){t=document.getElementById('error_box');t.innerHTML=e.firstChild.textContent;t.style.display=''}
else this.modifyCancel();return};var i=e.getElementsByTagName('elk')[0].getElementsByTagName('message')[0],s=i.getElementsByTagName('body')[0],n=i.getElementsByTagName('error')[0];$(document.forms.quickModForm.message).removeClass('border_error');$(document.forms.quickModForm.subject).removeClass('border_error');if(s){var l='';for(var o=0;o<s.childNodes.length;o++)l+=s.childNodes[o].nodeValue;this.sMessageBuffer=this.opt.sTemplateBodyNormal.replace(/%body%/,l.replace(/\$/g,'{&dollarfix;$}')).replace(/\{&dollarfix;\$\}/g,'$');this.oCurMessageDiv.innerHTML=this.sMessageBuffer;var d=i.getElementsByTagName('subject')[0],c=d.childNodes[0].nodeValue.replace(/\$/g,'{&dollarfix;$}');this.sSubjectBuffer=this.opt.sTemplateSubjectNormal.replace(/%subject%/,c).replace(/\{&dollarfix;\$\}/g,'$');this.oCurSubjectDiv.innerHTML=this.sSubjectBuffer;this.oCurSubjectDiv.style.display='';this.oCurInfoDiv.innerHTML=this.sInfoBuffer;if(this.opt.bShowModify){var r=document.getElementById('modified_'+this.sCurMessageId.substr(4));r.innerHTML=i.getElementsByTagName('modified')[0].childNodes[0].nodeValue;r.style.display='block'};if(this.opt.sIconHide!==null){var a=document.getElementById('msg_icon_'+this.sCurMessageId.replace('msg_',''));if(a!==null&&a.src.indexOf(this.opt.sIconHide)>0)this.oMsgIcon.style.display='none'};if($.isFunction($.fn.linkifyvideo))$().linkifyvideo(oEmbedtext,this.sCurMessageId);$('#'+this.sCurMessageId+' .spoilerheader').click(function(){$(this).next().children().slideToggle('fast')});if(typeof elk_codefix==='function')elk_codefix();if(typeof prettyPrint==='function')prettyPrint()}
else if(n){t=document.getElementById('error_box');t.innerHTML=n.childNodes[0].nodeValue;t.style.display='';if(n.getAttribute('in_body')==='1')$(document.forms.quickModForm.message).addClass('border_error');if(n.getAttribute('in_subject')==='1')$(document.forms.quickModForm.subject).addClass('border_error')}};function InTopicModeration(e){this.opt=e;this.bButtonsShown=!1;this.iNumSelected=0;if(typeof(this.opt.sSessionVar)==='undefined')this.opt.sSessionVar='sesc';this.init()};InTopicModeration.prototype.init=function(){for(var t=0,n=this.opt.aMessageIds.length;t<n;t++){var e=document.createElement('input');e.type='checkbox';e.className='input_check';e.name='msgs[]';e.value=this.opt.aMessageIds[t];e.instanceRef=this;e.onclick=function(){this.instanceRef.handleClick(this)};var i=document.getElementById(this.opt.sCheckboxContainerMask+this.opt.aMessageIds[t]);i.appendChild(e);i.style.display=''}};InTopicModeration.prototype.handleClick=function(e){if(!this.bButtonsShown&&this.opt.sButtonStripDisplay){var s=document.getElementById(this.opt.sButtonStrip),n=document.getElementById(this.opt.sButtonStripDisplay);if(typeof(n)==='object'&&n!==null)n.style.display='';else{var i=document.createElement('div'),o=document.createElement('ul');i.id=this.opt.sButtonStripDisplay;i.className=this.opt.sButtonStripClass?this.opt.sButtonStripClass:'buttonlist floatbottom';i.appendChild(o);s.appendChild(i)};if(this.opt.bCanRemove)elk_addButton(this.opt.sButtonStrip,this.opt.bUseImageButton,{sId:this.opt.sSelf+'_remove_button',sText:this.opt.sRemoveButtonLabel,sImage:this.opt.sRemoveButtonImage,sUrl:'#',sCustom:' onclick="return '+this.opt.sSelf+'.handleSubmit(\'remove\')"'});if(this.opt.bCanRestore)elk_addButton(this.opt.sButtonStrip,this.opt.bUseImageButton,{sId:this.opt.sSelf+'_restore_button',sText:this.opt.sRestoreButtonLabel,sImage:this.opt.sRestoreButtonImage,sUrl:'#',sCustom:' onclick="return '+this.opt.sSelf+'.handleSubmit(\'restore\')"'});if(this.opt.bCanSplit)elk_addButton(this.opt.sButtonStrip,this.opt.bUseImageButton,{sId:this.opt.sSelf+'_split_button',sText:this.opt.sSplitButtonLabel,sImage:this.opt.sSplitButtonImage,sUrl:'#',sCustom:' onclick="return '+this.opt.sSelf+'.handleSubmit(\'split\')"'});this.bButtonsShown=!0};this.iNumSelected+=e.checked?1:-1;if(this.opt.bCanRemove&&!this.opt.bUseImageButton){document.getElementById(this.opt.sSelf+'_remove_button_text').innerHTML=this.opt.sRemoveButtonLabel+' ['+this.iNumSelected+']';document.getElementById(this.opt.sSelf+'_remove_button').style.display=this.iNumSelected<1?'none':''};if(this.opt.bCanRestore&&!this.opt.bUseImageButton){document.getElementById(this.opt.sSelf+'_restore_button_text').innerHTML=this.opt.sRestoreButtonLabel+' ['+this.iNumSelected+']';document.getElementById(this.opt.sSelf+'_restore_button').style.display=this.iNumSelected<1?'none':''};if(this.opt.bCanSplit&&!this.opt.bUseImageButton){document.getElementById(this.opt.sSelf+'_split_button_text').innerHTML=this.opt.sSplitButtonLabel+' ['+this.iNumSelected+']';document.getElementById(this.opt.sSelf+'_split_button').style.display=this.iNumSelected<1?'none':''};var t=document.getElementById(this.opt.sButtonStrip).getElementsByTagName('span');if(t.length>3){if(this.iNumSelected<1){t[t.length-3].className=t[t.length-3].className.replace(/\s*position_holder/,'last');t[t.length-2].className=t[t.length-2].className.replace(/\s*position_holder/,'last')}
else{t[t.length-2].className=t[t.length-2].className.replace(/\s*last/,'position_holder');t[t.length-3].className=t[t.length-3].className.replace(/\s*last/,'position_holder')}}};InTopicModeration.prototype.handleSubmit=function(e){var t=document.getElementById(this.opt.sFormId),i=document.createElement('input');i.type='hidden';i.name=this.opt.sSessionVar;i.value=this.opt.sSessionId;t.appendChild(i);switch(e){case'remove':if(!confirm(this.opt.sRemoveButtonConfirm))return!1;t.action=t.action.replace(/;split_selection=1/,'');t.action=t.action.replace(/;restore_selected=1/,'');break;case'restore':if(!confirm(this.opt.sRestoreButtonConfirm))return!1;t.action=t.action.replace(/;split_selection=1/,'');t.action+=';restore_selected=1';break;case'split':if(!confirm(this.opt.sRestoreButtonConfirm))return!1;t.action=t.action.replace(/;restore_selected=1/,'');t.action+=';split_selection=1';break;default:return!1;break};t.submit();return!0};function expandThumbLB(e,t){var c=document.getElementById('link_'+e),v=$('a[data-lightboxmessage="'+t+'"]'),i=[],a=null,r=null,n=$('<span id="elk_lb_expand"></span>'),o=$('#elk_lightbox'),s=$('#elk_lb_content'),u=function(){$('<div id="lightbox-loading"><i class="icon icon-spin icon-xl i-spinner"></i><div>').appendTo(s);$('html, body').addClass('elk_lb_no_scrolling')},p=function(){$('#lightbox-loading').remove()},d=function(){n.off('click');o.hide();s.html('').removeAttr('style').removeClass('expand');$('html, body').removeClass('elk_lb_no_scrolling');$(window).off('resize.lb');$(window).off('keydown.lb');$(window).off('touchstart.lb');$(window).off('touchmove.lb')},h=function(){$('<img id="elk_lb_img" src="'+c.href+'">').on('load',function(){var e=(window.innerWidth?window.innerWidth:$(window).width())*(is_mobile?0.8:0.9),t=(window.innerHeight?window.innerHeight:$(window).height())*0.9;$(this).css({'max-width':Math.floor(e)+'px','max-height':Math.floor(t)+'px'});s.html($(this)).append(n);p()}).on('error',function(){setTimeout(function(){p();d()},1500)})},f=function(){e=i[($.inArray(e,i)+1)%i.length]},m=function(){e=i[($.inArray(e,i)-1+i.length)%i.length]},l=function(){s.html('').removeAttr('style').removeClass('expand');u();n.off('click');c=document.getElementById('link_'+e);h();g()},g=function(){n.on('click',function(){$('#elk_lb_content').addClass('expand').css({'height':Math.floor(window.innerHeight*0.95)+'px','width':Math.floor(window.innerWidth*0.9)+'px','left':'0'});$('#elk_lb_img').removeAttr('style');n.hide();$(window).off('keydown.lb');$(window).off('touchmove.lb')})};if(o.length<=0){o=$('<div id="elk_lightbox"></div>');s=$('<div id="elk_lb_content"></div>');$('body').append(o.append(s))};v.each(function(){i[i.length]=$(this).data('lightboximage')});if(i.length===0){i[i.length]=e};u();o.fadeIn(200);h();g();o.on('click',function(e){if(e.target.id!==n.attr('id')){e.preventDefault();d()}});$(window).on('keydown.lb',function(e){e.preventDefault();if(e.keyCode===27){d()};if(e.keyCode===37){m();l()};if(e.keyCode===39){f();l()}});$(window).on('resize.lb',function(){var e=$('#elk_lb_content');if(e.hasClass('expand'))e.css({'height':window.innerHeight*0.85,'width':window.innerWidth*0.9});else $('#elk_lb_img').css({'max-height':window.innerHeight*0.9,'max-width':window.innerWidth*0.8})});$(window).on('touchstart.lb',function(e){a=e.originalEvent.touches[0].clientX;r=e.originalEvent.touches[0].clientY});$(window).on('touchmove.lb',function(e){if(!a||!r)return;var i=e.originalEvent.touches[0].clientX,n=e.originalEvent.touches[0].clientY,t=a-i,o=r-n;if(Math.abs(t)>Math.abs(o)){if(t>0){m();l()}
else{f();l()}};a=null;r=null});return!1};function expandThumb(e){var o=document.getElementById('thumb_'+e),t=document.getElementById('link_'+e),i=t.nextSibling;while(i&&i.nodeType!==1){i=i.nextSibling};var n=i.nextSibling;while(n&&n.nodeType!==1){n=n.nextSibling};var s=o.src,a=o.style.height,r=o.style.width;o.src=t.href;o.style.width=t.style.width;o.style.height=t.style.height;i.className=i.className.includes('_exp')?'attachment_name':'attachment_name attachment_name_exp';n.className=n.className.includes('_exp')?'attachment_details':'attachment_details attachment_details_exp';t.href=s;t.style.width=r;t.style.height=a;return!1};function ignore_toggles(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=new elk_Toggle({bToggleEnabled:!0,bCurrentlyCollapsed:!0,aSwappableContainers:['msg_'+i+'_extra_info','msg_'+i,'msg_'+i+'_footer','msg_'+i+'_quick_mod','modify_button_'+i,'msg_'+i+'_signature'],aSwapLinks:[{sId:'msg_'+i+'_ignored_link',msgExpanded:'',msgCollapsed:t}]})}};function sendtopicOverlayDiv(e,t,i){var o='<div class="centertext"><i class="icon icon-spin i-spinner"></i></div>',n;i=typeof(i)==='string'?i:'i-envelope';t=typeof(t)==='string'?t:help_popup_heading_text;$.ajax({url:e,type:'GET',dataType:'html'}).done(function(e){var s=$('<div id="temp_help">').html(e).find('#send_topic'),a='';s.find('h3').each(function(){a=$(this).text();$(this).remove()});var d=s.find('form'),l=s.find('form').attr('action'),r=new smc_Popup({heading:(a!==''?a:t),content:o,icon:i});n=$('#'+r.popup_id).find('.popup_content');n.html(s.html());$('.popup_window').css({'width':'640px'});sendtopicForm(n,l,r)}).fail(function(e,t,i){n.html(t)});return!1};function addRequiredElem(e,t,i){if(typeof(i)==='undefined')i=!1;e.find('input[name="'+t+'"]').after($('<span class="requiredfield" />').text(required_field).fadeIn());e.find('input[name="'+t+'"]').keyup(function(){e.find('.'+t+' .requiredfield').fadeOut(function(){$(this).remove()})});if(!i){e.find('input[name="'+t+'"]').focus();i=!0}};function sendtopicForm(e,t,i){if(typeof(this_body)!=='undefined')e.html(this_body);var n=$(e).find('form');if(typeof(send_comment)!=='undefined'){n.find('input[name="comment"]').val(send_comment);n.find('input[name="y_name"]').val(sender_name);n.find('input[name="y_email"]').val(sender_mail);n.find('input[name="r_name"]').val(recipient_name);n.find('input[name="r_email"]').val(recipient_mail)};e.find('input[name="send"]').on('click',function(o){o.preventDefault();var a=n.serialize()+'&send=1',r=n.find('input[name="y_name"]').val(),l=n.find('input[name="y_email"]').val,d=n.find('input[name="r_name"]').val(),c=n.find('input[name="r_email"]').val(),s=!1;if(r===''){addRequiredElem(n,'y_name',s);s=!0};if(l===''){addRequiredElem(n,'y_email',s);s=!0};if(d===''){addRequiredElem(n,'r_name',s);s=!0};if(c===''){addRequiredElem(n,'r_email',s);s=!0};if(s)return;$.ajax({type:'post',url:t+';api',data:a}).done(function(n){var o=$(n).find('elk')[0],s=null;if(o.getElementsByTagName('error').length===0){s=o.getElementsByTagName('text')[0].firstChild.nodeValue.removeEntities();s+='<br /><br /><input type="submit" name="send" value="'+sendtopic_back+'" class="button_submit"/><input type="submit" name="cancel" value="'+sendtopic_close+'" class="button_submit"/>';e.html(s);e.find('input[name="cancel"]').each(function(){$(this).on('click',function(e){e.preventDefault();i.hide()})})}
else{if(o.getElementsByTagName('text').length!==0){s=o.getElementsByTagName('text')[0].firstChild.nodeValue.removeEntities();s+='<br /><br /><input type="submit" name="send" value="'+sendtopic_back+'" class="button_submit"/><input type="submit" name="cancel" value="'+sendtopic_close+'" class="button_submit"/>';e.html(s);e.find('input[name="send"]').each(function(){$(this).on('click',function(n){n.preventDefault();a=$(e).find('form').serialize()+'&send=1';sendtopicForm(e,t,i)})});e.find('input[name="cancel"]').each(function(){$(this).on('click',function(e){e.preventDefault();i.hide()})})};if(o.getElementsByTagName('url').length!==0){var r=o.getElementsByTagName('url')[0].firstChild.nodeValue;e.html(sendtopic_error.replace('{href}',r))}}}).fail(function(){e.html(sendtopic_error.replace('{href}',t))})})};function topicSplitselect(e,t){getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+'action=splittopics;sa=selectTopics;subname='+topic_subject+';topic='+topic_id+'.'+start[0]+';start2='+start[1]+';move='+e+';msg='+t+';xml',onTopicSplitReceived);return!1};function onTopicSplitReceived(e){var i,a,c;for(i=0;i<2;i++){c=e.getElementsByTagName('pageIndex')[i];document.getElementById('pageindex_'+c.getAttribute('section')).innerHTML=c.firstChild.nodeValue;start[i]=c.getAttribute('startFrom')};var p=e.getElementsByTagName('change').length,n,t,u,o,r,s,d,l,h='<i class="icon icon-lg i-chevron-circle-right"></i>',f='<i class="icon icon-lg i-chevron-circle-left"></i>';for(i=0;i<p;i++){n=e.getElementsByTagName('change')[i];t=n.getAttribute('section');u=n.getAttribute('curAction');o=n.getAttribute('id');r=document.getElementById('messages_'+t);if(u==='remove')r.removeChild(document.getElementById(t+'_'+o));else{d=null;l=r.getElementsByTagName('li');for(a=0;a<l.length;a++){if(parseInt(l[a].id.substr(t.length+1))<o){d=l[a].id;a=l.length+1}};s=document.createElement('li');s.className='';s.id=t+'_'+o;s.innerHTML='<div class="content"><div class="message_header"><a class="split_icon float'+(t==='selected'?'left':'right')+'" href="'+elk_prepareScriptUrl(elk_scripturl)+'action=splittopics;sa=selectTopics;subname='+topic_subject+';topic='+topic_id+'.'+not_selected_start+';start2='+selected_start+';move='+(t==='selected'?'up':'down')+';msg='+o+'" onclick="return topicSplitselect(\''+(t==='selected'?'up':'down')+'\', '+o+');">'+(t==='selected'?f:h)+'</a><strong>'+n.getElementsByTagName('subject')[0].firstChild.nodeValue+'</strong> '+txt_by+' <strong>'+n.getElementsByTagName('poster')[0].firstChild.nodeValue+'</strong><br /><em>'+n.getElementsByTagName('time')[0].firstChild.nodeValue+'</em></div><div class="post">'+n.getElementsByTagName('body')[0].firstChild.nodeValue+'</div></div>';if(typeof d==='string')r.insertBefore(s,document.getElementById(d));else r.appendChild(s)}}};
/*!
 * @name      ElkArte Forum
 * @copyright ElkArte Forum contributors
 * @license   BSD http://opensource.org/licenses/BSD-3-Clause
 *
 * @version 1.1
 */
;function elk_mentions(e){this.last_call=0;this.names=[];this.cached_names=[];this.cached_queries=[];this.mentions=null;this.$atwho=null;this.opt=e;this.attachAtWho()};elk_mentions.prototype.attachAtWho=function(){var e=this;e.$atwho=$(this.opt.selector);e.mentions=$('<div style="display:none" />');e.$atwho.after(this.mentions);e.$atwho.atwho({at:'@',limit:7,maxLen:25,displayTpl:'<li data-value=\'${atwho-at}${name}\' data-id=\'${id}\'>${name}</li>',callbacks:{filter:function(t,i,n){var o=parseInt(new Date().getTime()/1000);if(t.length<2)return[];if(e.last_call!==0&&e.last_call+1>o)return e.names;if(typeof(e.cached_names[t])!=='undefined')return e.cached_names[t];if(elk_formSubmitted)return[];e.names=[];var s={'suggest_type':'member','search':t.php_urlencode(),'time':o};s[elk_session_var]=elk_session_id;$.ajax({url:elk_scripturl+'?action=suggest;xml',data:s,type:'post',async:!1}).done(function(t){$(t).find('item').each(function(t,i){if(typeof(e.names[e.names.length])==='undefined')e.names[e.names.length]={};e.names[e.names.length-1].id=$(i).attr('id');e.names[e.names.length-1].name=$(i).text()})}).fail(function(e,t,i){if('console' in window){window.console.info('Error:',t,i.name);window.console.info(e.responseText)}});e.last_call=o;e.cached_names[t]=e.names;e.cached_queries[e.cached_queries.length]=t;return e.names},beforeInsert:function(t,i){e.mentions.append($('<input type="hidden" name="uid[]" />').val(i.data('id')).attr('data-name',i.data('value')));return t},matcher:function(e,t,i){var n,o;e=e.replace(/[\-\[\]\/\{}\(\)\*\+\?\.\\\^\$\|]/g,'\\$&');if(i)e='(?:^|\\s)'+e;o=new RegExp(e+'([^ <>&"\'=\\\\\n]*)$|'+e+'([^\\x00-\\xff]*)$','gi');n=o.exec(t.replace());if(n)return n[2]||n[1];else return null},highlighter:function(e,t){var i;if(!t)return e;t=(t+'').replace(new RegExp('[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]','g'),'\\$&');i=new RegExp('>\\s*(\\w*)('+t.replace('+','\\+')+')(\\w*)\\s*<','ig');return e.replace(i,function(e,t,i,n){return'> '+t+'<strong>'+i+'</strong>'+n+' <'})}}})};