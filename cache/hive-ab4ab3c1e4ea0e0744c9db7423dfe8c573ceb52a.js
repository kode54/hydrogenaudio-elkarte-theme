// https://hydrogenaud.io/themes/default/portal.js elk_jquery_plugins.js script.js topic.js jquery.atwho.min.js jquery.caret.min.js mentioning.js
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){var e,i;i={ESC:27,TAB:9,ENTER:13,CTRL:17,A:65,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32},e={beforeSave:function(t){return r.arrayToDefaultHash(t)},matcher:function(t,e,i,n){var r,o,s,a,h;return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i&&(t="(?:^|\\s)"+t),r=decodeURI("%C3%80"),o=decodeURI("%C3%BF"),h=n?" ":"",a=new RegExp(t+"([A-Za-z"+r+"-"+o+"0-9_"+h+"'.+-]*)$|"+t+"([^\\x00-\\xff]*)$","gi"),s=a.exec(e),s?s[2]||s[1]:null},filter:function(t,e,i){var n,r,o,s;for(n=[],r=0,s=e.length;r<s;r++)o=e[r],~new String(o[i]).toLowerCase().indexOf(t.toLowerCase())&&n.push(o);return n},remoteFilter:null,sorter:function(t,e,i){var n,r,o,s;if(!t)return e;for(n=[],r=0,s=e.length;r<s;r++)o=e[r],o.atwho_order=new String(o[i]).toLowerCase().indexOf(t.toLowerCase()),o.atwho_order>-1&&n.push(o);return n.sort(function(t,e){return t.atwho_order-e.atwho_order})},tplEval:function(t,e){var i,n;n=t;try{return"string"!=typeof t&&(n=t(e)),n.replace(/\$\{([^\}]*)\}/g,function(t,i,n){return e[i]})}catch(r){return i=r,""}},highlighter:function(t,e){var i;return e?(i=new RegExp(">\\s*([^<]*?)("+e.replace("+","\\+")+")([^<]*)\\s*<","ig"),t.replace(i,function(t,e,i,n){return"> "+e+"<strong>"+i+"</strong>"+n+" <"})):t},beforeInsert:function(t,e,i){return t},beforeReposition:function(t){return t},afterMatchFailed:function(t,e){}};var n;n=function(){function e(e){this.currentFlag=null,this.controllers={},this.aliasMaps={},this.$inputor=t(e),this.setupRootElement(),this.listen()}return e.prototype.createContainer=function(e){var i;return null!=(i=this.$el)&&i.remove(),t(e.body).append(this.$el=t("<div class='atwho-container'></div>"))},e.prototype.setupRootElement=function(e,i){var n;if(null==i&&(i=!1),e)this.window=e.contentWindow,this.document=e.contentDocument||this.window.document,this.iframe=e;else{this.document=this.$inputor[0].ownerDocument,this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(r){if(n=r,this.iframe=null,t.fn.atwho.debug)throw new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.\n"+n)}}return this.createContainer((this.iframeAsRoot=i)?this.document:document)},e.prototype.controller=function(t){var e,i,n,r;if(this.aliasMaps[t])i=this.controllers[this.aliasMaps[t]];else{r=this.controllers;for(n in r)if(e=r[n],n===t){i=e;break}}return i?i:this.controllers[this.currentFlag]},e.prototype.setContextFor=function(t){return this.currentFlag=t,this},e.prototype.reg=function(t,e){var i,n;return n=(i=this.controllers)[t]||(i[t]=this.$inputor.is("[contentEditable]")?new l(this,t):new s(this,t)),e.alias&&(this.aliasMaps[e.alias]=t),n.init(e),this},e.prototype.listen=function(){return this.$inputor.on("compositionstart",function(t){return function(e){var i;return null!=(i=t.controller())&&i.view.hide(),t.isComposing=!0,null}}(this)).on("compositionend",function(t){return function(e){return t.isComposing=!1,setTimeout(function(e){return t.dispatch(e)}),null}}(this)).on("keyup.atwhoInner",function(t){return function(e){return t.onKeyup(e)}}(this)).on("keydown.atwhoInner",function(t){return function(e){return t.onKeydown(e)}}(this)).on("blur.atwhoInner",function(t){return function(e){var i;if(i=t.controller())return i.expectedQueryCBId=null,i.view.hide(e,i.getOpt("displayTimeout"))}}(this)).on("click.atwhoInner",function(t){return function(e){return t.dispatch(e)}}(this)).on("scroll.atwhoInner",function(t){return function(){var e;return e=t.$inputor.scrollTop(),function(i){var n,r;return n=i.target.scrollTop,e!==n&&null!=(r=t.controller())&&r.view.hide(i),e=n,!0}}}(this)())},e.prototype.shutdown=function(){var t,e,i;i=this.controllers;for(t in i)e=i[t],e.destroy(),delete this.controllers[t];return this.$inputor.off(".atwhoInner"),this.$el.remove()},e.prototype.dispatch=function(t){var e,i,n,r;n=this.controllers,r=[];for(e in n)i=n[e],r.push(i.lookUp(t));return r},e.prototype.onKeyup=function(e){var n;switch(e.keyCode){case i.ESC:e.preventDefault(),null!=(n=this.controller())&&n.view.hide();break;case i.DOWN:case i.UP:case i.CTRL:case i.ENTER:t.noop();break;case i.P:case i.N:e.ctrlKey||this.dispatch(e);break;default:this.dispatch(e)}},e.prototype.onKeydown=function(e){var n,r;if(r=null!=(n=this.controller())?n.view:void 0,r&&r.visible())switch(e.keyCode){case i.ESC:e.preventDefault(),r.hide(e);break;case i.UP:e.preventDefault(),r.prev();break;case i.DOWN:e.preventDefault(),r.next();break;case i.P:if(!e.ctrlKey)return;e.preventDefault(),r.prev();break;case i.N:if(!e.ctrlKey)return;e.preventDefault(),r.next();break;case i.TAB:case i.ENTER:case i.SPACE:if(!r.visible())return;if(!this.controller().getOpt("spaceSelectsMatch")&&e.keyCode===i.SPACE)return;if(!this.controller().getOpt("tabSelectsMatch")&&e.keyCode===i.TAB)return;r.highlighted()?(e.preventDefault(),r.choose(e)):r.hide(e);break;default:t.noop()}},e}();var r,o=[].slice;r=function(){function i(e,i){this.app=e,this.at=i,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||this.uid(),this.expectedQueryCBId=null,this.setting=null,this.query=null,this.pos=0,this.range=null,0===(this.$el=t("#atwho-ground-"+this.id,this.app.$el)).length&&this.app.$el.append(this.$el=t("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new u(this),this.view=new c(this)}return i.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},i.prototype.init=function(e){return this.setting=t.extend({},this.setting||t.fn.atwho["default"],e),this.view.init(),this.model.reload(this.setting.data)},i.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},i.prototype.callDefault=function(){var i,n,r;r=arguments[0],i=2<=arguments.length?o.call(arguments,1):[];try{return e[r].apply(this,i)}catch(s){return n=s,t.error(n+" Or maybe At.js doesn't have function "+r)}},i.prototype.trigger=function(t,e){var i,n;return null==e&&(e=[]),e.push(this),i=this.getOpt("alias"),n=i?t+"-"+i+".atwho":t+".atwho",this.$inputor.trigger(n,e)},i.prototype.callbacks=function(t){return this.getOpt("callbacks")[t]||e[t]},i.prototype.getOpt=function(t,e){var i;try{return this.setting[t]}catch(n){return i=n,null}},i.prototype.insertContentFor=function(e){var i,n;return n=this.getOpt("insertTpl"),i=t.extend({},e.data("item-data"),{"atwho-at":this.at}),this.callbacks("tplEval").call(this,n,i,"onInsert")},i.prototype.renderView=function(t){var e;return e=this.getOpt("searchKey"),t=this.callbacks("sorter").call(this,this.query.text,t.slice(0,1001),e),this.view.render(t.slice(0,this.getOpt("limit")))},i.arrayToDefaultHash=function(e){var i,n,r,o;if(!t.isArray(e))return e;for(o=[],i=0,r=e.length;i<r;i++)n=e[i],t.isPlainObject(n)?o.push(n):o.push({name:n});return o},i.prototype.lookUp=function(t){var e,i;if((!t||"click"!==t.type||this.getOpt("lookUpOnClick"))&&(!this.getOpt("suspendOnComposing")||!this.app.isComposing))return(e=this.catchQuery(t))?(this.app.setContextFor(this.at),(i=this.getOpt("delay"))?this._delayLookUp(e,i):this._lookUp(e),e):(this.expectedQueryCBId=null,e)},i.prototype._delayLookUp=function(t,e){var i,n;return i=Date.now?Date.now():(new Date).getTime(),this.previousCallTime||(this.previousCallTime=i),n=e-(i-this.previousCallTime),0<n&&n<e?(this.previousCallTime=i,this._stopDelayedCall(),this.delayedCallTimeout=setTimeout(function(e){return function(){return e.previousCallTime=0,e.delayedCallTimeout=null,e._lookUp(t)}}(this),e)):(this._stopDelayedCall(),this.previousCallTime!==i&&(this.previousCallTime=0),this._lookUp(t))},i.prototype._stopDelayedCall=function(){if(this.delayedCallTimeout)return clearTimeout(this.delayedCallTimeout),this.delayedCallTimeout=null},i.prototype._generateQueryCBId=function(){return{}},i.prototype._lookUp=function(e){var i;return i=function(t,e){if(t===this.expectedQueryCBId)return e&&e.length>0?this.renderView(this.constructor.arrayToDefaultHash(e)):this.view.hide()},this.expectedQueryCBId=this._generateQueryCBId(),this.model.query(e.text,t.proxy(i,this,this.expectedQueryCBId))},i}();var s,a=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;s=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return a(i,e),i.prototype.catchQuery=function(){var t,e,i,n,r,o,s;if(e=this.$inputor.val(),t=this.$inputor.caret("pos",{iframe:this.app.iframe}),s=e.slice(0,t),r=this.callbacks("matcher").call(this,this.at,s,this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),n="string"==typeof r,!(n&&r.length<this.getOpt("minLen",0)))return n&&r.length<=this.getOpt("maxLen",20)?(o=t-r.length,i=o+r.length,this.pos=o,r={text:r,headPos:o,endPos:i},this.trigger("matched",[this.at,r.text])):(r=null,this.view.hide()),this.query=r},i.prototype.rect=function(){var e,i,n;if(e=this.$inputor.caret("offset",this.pos-1,{iframe:this.app.iframe}))return this.app.iframe&&!this.app.iframeAsRoot&&(i=t(this.app.iframe).offset(),e.left+=i.left,e.top+=i.top),n=this.app.document.selection?0:2,{left:e.left,top:e.top,bottom:e.top+e.height+n}},i.prototype.insert=function(t,e){var i,n,r,o,s;return i=this.$inputor,n=i.val(),r=n.slice(0,Math.max(this.query.headPos-this.at.length,0)),o=""===(o=this.getOpt("suffix"))?o:o||" ",t+=o,s=""+r+t+n.slice(this.query.endPos||0),i.val(s),i.caret("pos",r.length+t.length,{iframe:this.app.iframe}),i.is(":focus")||i.focus(),i.change()},i}(r);var l,a=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;l=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return a(n,e),n.prototype._getRange=function(){var t;if(t=this.app.window.getSelection(),t.rangeCount>0)return t.getRangeAt(0)},n.prototype._setRange=function(e,i,n){if(null==n&&(n=this._getRange()),n&&i)return i=t(i)[0],"after"===e?(n.setEndAfter(i),n.setStartAfter(i)):(n.setEndBefore(i),n.setStartBefore(i)),n.collapse(!1),this._clearRange(n)},n.prototype._clearRange=function(t){var e;if(null==t&&(t=this._getRange()),e=this.app.window.getSelection(),null==this.ctrl_a_pressed)return e.removeAllRanges(),e.addRange(t)},n.prototype._movingEvent=function(t){var e;return"click"===t.type||(e=t.which)===i.RIGHT||e===i.LEFT||e===i.UP||e===i.DOWN},n.prototype._unwrap=function(e){var i;return e=t(e).unwrap().get(0),(i=e.nextSibling)&&i.nodeValue&&(e.nodeValue+=i.nodeValue,t(i).remove()),e},n.prototype.catchQuery=function(e){var n,r,o,s,a,h,l,u,c,p,f,d;if((d=this._getRange())&&d.collapsed){if(e.which===i.ENTER)return(r=t(d.startContainer).closest(".atwho-query")).contents().unwrap(),r.is(":empty")&&r.remove(),(r=t(".atwho-query",this.app.document)).text(r.text()).contents().last().unwrap(),void this._clearRange();if(/firefox/i.test(navigator.userAgent)){if(t(d.startContainer).is(this.$inputor))return void this._clearRange();e.which===i.BACKSPACE&&d.startContainer.nodeType===document.ELEMENT_NODE&&(c=d.startOffset-1)>=0?(o=d.cloneRange(),o.setStart(d.startContainer,c),t(o.cloneContents()).contents().last().is(".atwho-inserted")&&(a=t(d.startContainer).contents().get(c),this._setRange("after",t(a).contents().last()))):e.which===i.LEFT&&d.startContainer.nodeType===document.TEXT_NODE&&(n=t(d.startContainer.previousSibling),n.is(".atwho-inserted")&&0===d.startOffset&&this._setRange("after",n.contents().last()))}if(t(d.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),(r=t(".atwho-query",this.app.document)).length>0&&r.is(":empty")&&0===r.text().length&&r.remove(),this._movingEvent(e)||r.removeClass("atwho-inserted"),r.length>0)switch(e.which){case i.LEFT:return this._setRange("before",r.get(0),d),void r.removeClass("atwho-query");case i.RIGHT:return this._setRange("after",r.get(0).nextSibling,d),void r.removeClass("atwho-query")}if(r.length>0&&(f=r.attr("data-atwho-at-query"))&&(r.empty().html(f).attr("data-atwho-at-query",null),this._setRange("after",r.get(0),d)),o=d.cloneRange(),o.setStart(d.startContainer,0),u=this.callbacks("matcher").call(this,this.at,o.toString(),this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),h="string"==typeof u,0===r.length&&h&&(s=d.startOffset-this.at.length-u.length)>=0&&(d.setStart(d.startContainer,s),r=t("<span/>",this.app.document).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),d.surroundContents(r.get(0)),l=r.contents().last().get(0),l&&(/firefox/i.test(navigator.userAgent)?(d.setStart(l,l.length),d.setEnd(l,l.length),this._clearRange(d)):this._setRange("after",l,d))),!(h&&u.length<this.getOpt("minLen",0)))return h&&u.length<=this.getOpt("maxLen",20)?(p={text:u,el:r},this.trigger("matched",[this.at,p.text]),this.query=p):(this.view.hide(),this.query={el:r},r.text().indexOf(this.at)>=0&&(this._movingEvent(e)&&r.hasClass("atwho-inserted")?r.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,r)&&this._setRange("after",this._unwrap(r.text(r.text()).contents().first()))),null)}},n.prototype.rect=function(){var e,i,n;if(n=this.query.el.offset())return this.app.iframe&&!this.app.iframeAsRoot&&(i=(e=t(this.app.iframe)).offset(),n.left+=i.left-this.$inputor.scrollLeft(),n.top+=i.top-this.$inputor.scrollTop()),n.bottom=n.top+this.query.el.height(),n},n.prototype.insert=function(t,e){var i,n,r,o,s;return this.$inputor.is(":focus")||this.$inputor.focus(),n=this.getOpt("functionOverrides"),n.insert?n.insert.bind(this)(t,e):(o=""===(o=this.getOpt("suffix"))?o:o||" ",i=e.data("item-data"),this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(t).attr("data-atwho-at-query",""+i["atwho-at"]+this.query.text).attr("contenteditable","false"),(r=this._getRange())&&(this.query.el.length&&r.setEndAfter(this.query.el[0]),r.collapse(!1),r.insertNode(s=this.app.document.createTextNode("‍"+o)),this._setRange("after",s,r)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change())},n}(r);var u;u=function(){function e(t){this.context=t,this.at=this.context.at,this.storage=this.context.$inputor}return e.prototype.destroy=function(){return this.storage.data(this.at,null)},e.prototype.saved=function(){return this.fetch()>0},e.prototype.query=function(t,e){var i,n,r;return n=this.fetch(),r=this.context.getOpt("searchKey"),n=this.context.callbacks("filter").call(this.context,t,n,r)||[],i=this.context.callbacks("remoteFilter"),n.length>0||!i&&0===n.length?e(n):i.call(this.context,t,e)},e.prototype.fetch=function(){return this.storage.data(this.at)||[]},e.prototype.save=function(t){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,t||[]))},e.prototype.load=function(t){if(!this.saved()&&t)return this._load(t)},e.prototype.reload=function(t){return this._load(t)},e.prototype._load=function(e){return"string"==typeof e?t.ajax(e,{dataType:"json"}).done(function(t){return function(e){return t.save(e)}}(this)):this.save(e)},e}();var c;c=function(){function e(e){this.context=e,this.$el=t("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.$elUl=this.$el.children(),this.timeoutID=null,this.context.$el.append(this.$el),this.bindEvent()}return e.prototype.init=function(){var t,e;return e=this.context.getOpt("alias")||this.context.at.charCodeAt(0),t=this.context.getOpt("headerTpl"),t&&1===this.$el.children().length&&this.$el.prepend(t),this.$el.attr({id:"at-view-"+e})},e.prototype.destroy=function(){return this.$el.remove()},e.prototype.bindEvent=function(){var e,i,n;return e=this.$el.find("ul"),i=0,n=0,e.on("mousemove.atwho-view","li",function(r){return function(r){var o;if((i!==r.clientX||n!==r.clientY)&&(i=r.clientX,n=r.clientY,o=t(r.currentTarget),!o.hasClass("cur")))return e.find(".cur").removeClass("cur"),o.addClass("cur")}}(this)).on("click.atwho-view","li",function(i){return function(n){return e.find(".cur").removeClass("cur"),t(n.currentTarget).addClass("cur"),i.choose(n),n.preventDefault()}}(this))},e.prototype.visible=function(){return t.expr.pseudos.visible(this.$el[0])},e.prototype.highlighted=function(){return this.$el.find(".cur").length>0},e.prototype.choose=function(t){var e,i;if((e=this.$el.find(".cur")).length&&(i=this.context.insertContentFor(e),this.context._stopDelayedCall(),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,i,e,t),e),this.context.trigger("inserted",[e,t]),this.hide(t)),this.context.getOpt("hideWithoutSuffix"))return this.stopShowing=!0},e.prototype.reposition=function(e){var i,n,r,o;return i=this.context.app.iframeAsRoot?this.context.app.window:window,e.bottom+this.$el.height()-t(i).scrollTop()>t(i).height()&&(e.bottom=e.top-this.$el.height()),e.left>(r=t(i).width()-this.$el.width()-5)&&(e.left=r),n={left:e.left,top:e.bottom},null!=(o=this.context.callbacks("beforeReposition"))&&o.call(this.context,n),this.$el.offset(n),this.context.trigger("reposition",[n])},e.prototype.next=function(){var t,e,i,n;return t=this.$el.find(".cur").removeClass("cur"),e=t.next(),e.length||(e=this.$el.find("li:first")),e.addClass("cur"),i=e[0],n=i.offsetTop+i.offsetHeight+(i.nextSibling?i.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,n-this.$el.height()))},e.prototype.prev=function(){var t,e,i,n;return t=this.$el.find(".cur").removeClass("cur"),i=t.prev(),i.length||(i=this.$el.find("li:last")),i.addClass("cur"),n=i[0],e=n.offsetTop+n.offsetHeight+(n.nextSibling?n.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,e-this.$el.height()))},e.prototype.scrollTop=function(t){var e;return e=this.context.getOpt("scrollDuration"),e?this.$elUl.animate({scrollTop:t},e):this.$elUl.scrollTop(t)},e.prototype.show=function(){var t;return this.stopShowing?void(this.stopShowing=!1):(this.visible()||(this.$el.show(),this.$el.scrollTop(0),this.context.trigger("shown")),(t=this.context.rect())?this.reposition(t):void 0)},e.prototype.hide=function(t,e){var i;if(this.visible())return isNaN(e)?(this.$el.hide(),this.context.trigger("hidden",[t])):(i=function(t){return function(){return t.hide()}}(this),clearTimeout(this.timeoutID),this.timeoutID=setTimeout(i,e))},e.prototype.render=function(e){var i,n,r,o,s,a,h;if(!(t.isArray(e)&&e.length>0))return void this.hide();for(this.$el.find("ul").empty(),n=this.$el.find("ul"),h=this.context.getOpt("displayTpl"),r=0,s=e.length;r<s;r++)o=e[r],o=t.extend({},o,{"atwho-at":this.context.at}),a=this.context.callbacks("tplEval").call(this.context,h,o,"onDisplay"),i=t(this.context.callbacks("highlighter").call(this.context,a,this.context.query.text)),i.data("item-data",o),n.append(i);return this.show(),this.context.getOpt("highlightFirst")?n.find("li:first").addClass("cur"):void 0},e}();var p;p={load:function(t,e){var i;if(i=this.controller(t))return i.model.load(e)},isSelecting:function(){var t;return!!(null!=(t=this.controller())?t.view.visible():void 0)},hide:function(){var t;return null!=(t=this.controller())?t.view.hide():void 0},reposition:function(){var t;if(t=this.controller())return t.view.reposition(t.rect())},setIframe:function(t,e){return this.setupRootElement(t,e),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},t.fn.atwho=function(e){var i,r;return i=arguments,r=null,this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each(function(){var o,s;return(s=(o=t(this)).data("atwho"))||o.data("atwho",s=new n(this)),"object"!=typeof e&&e?p[e]&&s?r=p[e].apply(s,Array.prototype.slice.call(i,1)):t.error("Method "+e+" does not exist on jQuery.atwho"):s.reg(e.at,e)}),null!=r?r:this},t.fn.atwho["default"]={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}</li>",insertTpl:"${atwho-at}${name}",headerTpl:null,callbacks:e,functionOverrides:{},searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,acceptSpaceBar:!1,highlightFirst:!0,limit:5,maxLen:20,minLen:0,displayTimeout:300,delay:null,spaceSelectsMatch:!1,tabSelectsMatch:!0,editableAtwhoQueryAttrs:{},scrollDuration:150,suspendOnComposing:!0,lookUpOnClick:!0},t.fn.atwho.debug=!1});
/*! jquery.caret 2015-02-01 */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return a.returnExportsGlobal=b(c)}):"object"==typeof exports?module.exports=b(require("jquery")):b(jQuery)}(this,function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l;k="caret",b=function(){function b(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return b.prototype.setPos=function(){return this.domInputor},b.prototype.getIEPosition=function(){return this.getPosition()},b.prototype.getPosition=function(){var a,b;return b=this.getOffset(),a=this.$inputor.offset(),b.left-=a.left,b.top-=a.top,b},b.prototype.getOldIEPos=function(){var a,b;return b=h.selection.createRange(),a=h.body.createTextRange(),a.moveToElementText(this.domInputor),a.setEndPoint("EndToEnd",b),a.text.length},b.prototype.getPos=function(){var a,b,c;return(c=this.range())?(a=c.cloneRange(),a.selectNodeContents(this.domInputor),a.setEnd(c.endContainer,c.endOffset),b=a.toString().length,a.detach(),b):h.selection?this.getOldIEPos():void 0},b.prototype.getOldIEOffset=function(){var a,b;return a=h.selection.createRange().duplicate(),a.moveStart("character",-1),b=a.getBoundingClientRect(),{height:b.bottom-b.top,left:b.left,top:b.top}},b.prototype.getOffset=function(){var b,c,d,e,f;return j.getSelection&&(d=this.range())?(d.endOffset-1>0&&d.endContainer===!this.domInputor&&(b=d.cloneRange(),b.setStart(d.endContainer,d.endOffset-1),b.setEnd(d.endContainer,d.endOffset),e=b.getBoundingClientRect(),c={height:e.height,left:e.left+e.width,top:e.top},b.detach()),c&&0!==(null!=c?c.height:void 0)||(b=d.cloneRange(),f=a(h.createTextNode("|")),b.insertNode(f[0]),b.selectNode(f[0]),e=b.getBoundingClientRect(),c={height:e.height,left:e.left,top:e.top},f.remove(),b.detach())):h.selection&&(c=this.getOldIEOffset()),c&&(c.top+=a(j).scrollTop(),c.left+=a(j).scrollLeft()),c},b.prototype.range=function(){var a;if(j.getSelection)return a=j.getSelection(),a.rangeCount>0?a.getRangeAt(0):null},b}(),c=function(){function b(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return b.prototype.getIEPos=function(){var a,b,c,d,e,f,g;return b=this.domInputor,f=h.selection.createRange(),e=0,f&&f.parentElement()===b&&(d=b.value.replace(/\r\n/g,"\n"),c=d.length,g=b.createTextRange(),g.moveToBookmark(f.getBookmark()),a=b.createTextRange(),a.collapse(!1),e=g.compareEndPoints("StartToEnd",a)>-1?c:-g.moveStart("character",-c)),e},b.prototype.getPos=function(){return h.selection?this.getIEPos():this.domInputor.selectionStart},b.prototype.setPos=function(a){var b,c;return b=this.domInputor,h.selection?(c=b.createTextRange(),c.move("character",a),c.select()):b.setSelectionRange&&b.setSelectionRange(a,a),b},b.prototype.getIEOffset=function(a){var b,c,d,e;return c=this.domInputor.createTextRange(),a||(a=this.getPos()),c.move("character",a),d=c.boundingLeft,e=c.boundingTop,b=c.boundingHeight,{left:d,top:e,height:b}},b.prototype.getOffset=function(b){var c,d,e;return c=this.$inputor,h.selection?(d=this.getIEOffset(b),d.top+=a(j).scrollTop()+c.scrollTop(),d.left+=a(j).scrollLeft()+c.scrollLeft(),d):(d=c.offset(),e=this.getPosition(b),d={left:d.left+e.left-c.scrollLeft(),top:d.top+e.top-c.scrollTop(),height:e.height})},b.prototype.getPosition=function(a){var b,c,e,f,g,h,i;return b=this.$inputor,f=function(a){return a=a.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(a=a.replace(/\s/g,"&nbsp;")),a},void 0===a&&(a=this.getPos()),i=b.val().slice(0,a),e=b.val().slice(a),g="<span style='position: relative; display: inline;'>"+f(i)+"</span>",g+="<span id='caret' style='position: relative; display: inline;'>|</span>",g+="<span style='position: relative; display: inline;'>"+f(e)+"</span>",h=new d(b),c=h.create(g).rect()},b.prototype.getIEPosition=function(a){var b,c,d,e,f;return d=this.getIEOffset(a),c=this.$inputor.offset(),e=d.left-c.left,f=d.top-c.top,b=d.height,{left:e,top:f,height:b}},b}(),d=function(){function b(a){this.$inputor=a}return b.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],b.prototype.mirrorCss=function(){var b,c=this;return b={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),a.each(this.css_attr,function(a,d){return b[d]=c.$inputor.css(d)}),b},b.prototype.create=function(b){return this.$mirror=a("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(b),this.$inputor.after(this.$mirror),this},b.prototype.rect=function(){var a,b,c;return a=this.$mirror.find("#caret"),b=a.position(),c={left:b.left,top:b.top,height:a.height()},this.$mirror.remove(),c},b}(),e={contentEditable:function(a){return!(!a[0].contentEditable||"true"!==a[0].contentEditable)}},g={pos:function(a){return a||0===a?this.setPos(a):this.getPos()},position:function(a){return h.selection?this.getIEPosition(a):this.getPosition(a)},offset:function(a){var b;return b=this.getOffset(a)}},h=null,j=null,i=null,l=function(a){var b;return(b=null!=a?a.iframe:void 0)?(i=b,j=b.contentWindow,h=b.contentDocument||j.document):(i=void 0,j=window,h=document)},f=function(a){var b;h=a[0].ownerDocument,j=h.defaultView||h.parentWindow;try{return i=j.frameElement}catch(c){b=c}},a.fn.caret=function(d,f,h){var i;return g[d]?(a.isPlainObject(f)?(l(f),f=void 0):l(h),i=e.contentEditable(this)?new b(this):new c(this),g[d].apply(i,[f])):a.error("Method "+d+" does not exist on jQuery.caret")},a.fn.caret.EditableCaret=b,a.fn.caret.InputCaret=c,a.fn.caret.Utils=e,a.fn.caret.apis=g});
/*
 2015-2017 SimplePortal Team
 @license BSD 3-clause
 @version 1.0.0 RC1
*/
function sp_collapseBlock(a){$("#sp_block_"+a).slideToggle(300).promise().done(function(){var b=!1;$("#sp_block_"+a).is(":visible")&&(b=!0);0===elk_member_id?document.cookie="sp_block_"+a+"="+(b?0:1):elk_setThemeOption("sp_block_"+a,b?0:1,null,null);$("#sp_collapse_"+a).attr("class",b?"collapse":"expand")})}
function sp_collapseSide(a){var b=[,"sp_left",,,"sp_right"];mode=""===document.getElementById(b[a]).style.display?0:1;0===elk_member_id?document.cookie=b[a]+"="+(mode?0:1):elk_setThemeOption(b[a],mode?0:1,null,null);document.getElementById("sp_collapse_side"+a).className=mode?"dot collapse":"dot expand";$("#"+b[a]).toggle(400)}
function sp_collapse_object(a,b){var c=""===document.getElementById("sp_object_"+a).style.display?0:1;$("#sp_object_"+a).toggle(300);if("undefined"===typeof b||!0===b)document.getElementById("sp_collapse_"+a).src=elk_images_url+(c?"/collapse.png":"/expand.png")}
function sp_image_resize(){for(var a=document.getElementsByTagName("img"),b=0;b<a.length;b++)if("bbc_img sp_article"===a[b].className){var c=new Image;c.src=a[b].src;300<c.width?(a[b].height=300*c.height/c.width,a[b].width=300):(a[b].width=c.width,a[b].height=c.height)}"undefined"!==typeof window_oldSPImageOnload&&window_oldSPImageOnload&&(window_oldSPImageOnload(),window_oldSPImageOnload=null)}
function sp_submit_shout(a,b,c){if(window.XMLHttpRequest){shoutbox_indicator(a,!0);var d=document.getElementById("new_shout_"+a).value.replace(/&#/g,"&#38;#").php_urlencode();sendXMLDocument(elk_prepareScriptUrl(sp_script_url)+"action=shoutbox;xml","shoutbox_id="+a+"&shout="+d+"&"+b+"="+c,onShoutReceived);document.getElementById("new_shout_"+a).value="";return!1}}
function sp_delete_shout(a,b,c,d){if(window.XMLHttpRequest)return shoutbox_indicator(a,!0),sendXMLDocument(elk_prepareScriptUrl(sp_script_url)+"action=shoutbox;xml","shoutbox_id="+a+"&delete="+b+"&"+c+"="+d,onShoutReceived),!1}function sp_refresh_shout(a,b){if(window.XMLHttpRequest)return shoutbox_indicator(a,!0),getXMLDocument(elk_prepareScriptUrl(sp_script_url)+"action=shoutbox;shoutbox_id="+a+";time="+b+";xml",onShoutReceived),!1}
function onShoutReceived(a){var b="";var c=a.getElementsByTagName("elk")[0].getElementsByTagName("shoutbox")[0].childNodes[0].nodeValue;if("1"===a.getElementsByTagName("elk")[0].getElementsByTagName("updated")[0].childNodes[0].nodeValue){shouts=a.getElementsByTagName("elk")[0].getElementsByTagName("shout");var d=a.getElementsByTagName("elk")[0].getElementsByTagName("error")[0].childNodes[0].nodeValue;var e=a.getElementsByTagName("elk")[0].getElementsByTagName("warning")[0].childNodes[0].nodeValue;
var f=a.getElementsByTagName("elk")[0].getElementsByTagName("reverse")[0].childNodes[0].nodeValue;"0"!==e&&(b+='<li class="shoutbox_warning smalltext">'+e+"</li>");if("0"!==d)document.getElementById("shouts_"+c).innerHTML=b+'<li class="smalltext">'+d+"</li>";else{for(var g=0;g<shouts.length;g++){var h=a.getElementsByTagName("elk")[0].getElementsByTagName("shout")[g];h.getElementsByTagName("id");d=h.getElementsByTagName("author")[0].childNodes[0].nodeValue;e=h.getElementsByTagName("time")[0].childNodes[0].nodeValue;
h.getElementsByTagName("timeclean");var m=h.getElementsByTagName("delete")[0].childNodes[0].nodeValue;var k=h.getElementsByTagName("content")[0].childNodes[0].nodeValue;h=h.getElementsByTagName("is_me")[0].childNodes[0].nodeValue;b+="<li>"+("0"===h?"<strong>"+d+":</strong> ":"")+k+"<br />"+(0!==m?'<span class="shoutbox_delete">'+m+"</span>":"")+'<span class="smalltext shoutbox_time">'+e+"</span></li>"}document.getElementById("shouts_"+c).innerHTML=b;"0"!==f?document.getElementById("shouts_"+c).scrollTop=
document.getElementById("shouts_"+c).scrollHeight:document.getElementById("shouts_"+c).scrollTop=0}}shoutbox_indicator(c,!1);return!1}function shoutbox_indicator(a,b){document.getElementById("shoutbox_load_"+a).style.display=b?"":"none"}function sp_catch_enter(a){if(window.event)var b=window.event.keyCode;else a&&(b=a.which);if(13===b)return!0}
function sp_show_ignored_shout(a){document.getElementById("ignored_shout_"+a).style.display="";document.getElementById("ignored_shout_link_"+a).style.display="none"}function sp_show_history_ignored_shout(a){document.getElementById("history_ignored_shout_"+a).style.display="";document.getElementById("history_ignored_shout_link_"+a).style.display="none"}
function sp_showMoreSmileys(a,b,c,d,e,f){if("undefined"!==typeof this.oSmileyPopupWindow&&"closed"in this.oSmileyPopupWindow&&!this.oSmileyPopupWindow.closed)this.oSmileyPopupWindow.focus();else{if("undefined"===typeof g){var g="";for(i=0;i<sp_smileys.length;i++)sp_smileys[i][2]=sp_smileys[i][2].replace(/"/g,"&quot;"),sp_smileys[i][0]=sp_smileys[i][0].replace(/"/g,"&quot;"),g+='<a href="javascript:void(0);" onclick="window.opener.replaceText(\' '+sp_smileys[i][0].php_addslashes()+"', window.opener.document.getElementById('new_shout_"+
a+'\')); window.focus(); return false;"><img src="'+f+"/"+sp_smileys[i][1]+'" id="sml_'+sp_smileys[i][1]+'" alt="'+sp_smileys[i][2]+'" title="'+sp_smileys[i][2]+'" style="padding: 4px;" border="0" /></a> '}this.oSmileyPopupWindow=window.open("","add_smileys","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=480,height=220,resizable=yes");this.oSmileyPopupWindow.document.open("text/html","replace");this.oSmileyPopupWindow.document.write(sp_moreSmileysTemplate.easyReplace({smileyRows:g}));
this.oSmileyPopupWindow.document.close()}}
function sp_update_editor(a,b){var c=$("textarea"),d=c.sceditor("instance"),e="";"bbc"===a&&"undefined"===typeof d?(e="html"===b?c.html().php_unhtmlspecialchars():"[code]"+c.val().replace(/\n/g,"<br >")+"[/code]",elk_editor(),d=c.sceditor("instance"),d.sourceMode(!1),d.setWysiwygEditorValue(e),d.sourceMode(!0)):"bbc"!==a&&"undefined"!==typeof d&&""!==b?("html"===a?""!==d.getSourceEditorValue()&&(e=d.getWysiwygEditorValue(!1),e=e.replace(/<span .*>\s?<\/span>/g,"").replace(/<br( \\)?>/g,"\n")):e=d.getSourceEditorValue(!1).replace(/<br( \\)?>/g,
"\n").php_unhtmlspecialchars().replace("[code]","").replace("[/code]",""),d.destroy(),$("textarea").val(e)):"bbc"!==a&&"undefined"!==typeof d&&("html"===a&&d.updateOriginal(),d.destroy())}function sp_editor_change_type(a){var b;$("#"+a).on("focus",function(){b=this.value}).change(function(){sp_update_editor(this.value,b);b=this.value})}function sp_theme_select(a){a=a.options[a.selectedIndex].value;document.getElementById("sp_ts_thumb").src=sp_ts_thumbs[a]}
function sp_collapseCalendar(a){new_day="sp_calendar_"+a;if(new_day===current_day)return!1;document.getElementById(current_day).style.display="none";document.getElementById(new_day).style.display="";current_day=new_day}function sp_collapseObject(a){var b=document.getElementById("sp_object_"+a).style.display;b=""===b|"block"===b?!1:!0;$("#sp_object_"+a).slideToggle(300);document.getElementById("sp_collapse_"+a).src=elk_images_url+(b?"/selected.png":"/selected_open.png")}
function check_style_options(){var a=document.getElementById("no_title").checked,b=document.getElementById("no_body").checked;document.getElementById("title_default_class").disabled=a;document.getElementById("title_custom_class").disabled=a;document.getElementById("title_custom_style").disabled=a;document.getElementById("body_default_class").disabled=b;document.getElementById("body_custom_class").disabled=b;document.getElementById("body_custom_style").disabled=b}
function sp_surroundText(a,b,c){if("caretPos"in c&&"createTextRange"in c){var d=c.caretPos,e=d.text.length;d.text=" "===d.text.charAt(d.text.length-1)?a+d.text+b+" ":a+d.text+b;0===e?(d.moveStart("character",-b.length),d.moveEnd("character",-b.length),d.select()):c.focus(d)}else if("selectionStart"in c){d=c.value.substr(0,c.selectionStart);e=c.value.substr(c.selectionStart,c.selectionEnd-c.selectionStart);var f=c.value.substr(c.selectionEnd),g=c.selectionStart,h=c.scrollTop;c.value=d+a+e+b+f;c.setSelectionRange&&
(0===e.length?c.setSelectionRange(g+a.length,g+a.length):c.setSelectionRange(g,g+a.length+e.length+b.length),c.focus());c.scrollTop=h}else c.value+=a+b,c.focus(c.value.length-1)};/*
 ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 @version 1.1

 This file contains javascript plugins for use with jquery
 hoverIntent v1.9.0 // 2014.08.11 // jQuery v1.9.1+
 http://cherne.net/brian/resources/jquery.hoverIntent.html

 You may use hoverIntent under the terms of the MIT license. Basically that
 means you are free to use hoverIntent as long as this header is left intact.
 Copyright 2007, 2014 Brian Cherne
 Superclick v1.0.0 - jQuery menu widget
 Copyright (c) 2013 Joel Birch

 Dual licensed under the MIT and GPL licenses:
 http://www.opensource.org/licenses/mit-license.php
 http://www.gnu.org/licenses/gpl.html
 @name      ElkArte news fader
 @copyright ElkArte Forum contributors
 @license   MIT http://www.opensource.org/licenses/mit-license.php
*/
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):jQuery&&!jQuery.fn.hoverIntent&&a(jQuery)})(function(a){var b={interval:100,sensitivity:6,timeout:0},c=0,d,e,f=function(a){d=a.pageX;e=a.pageY},g=function(a,b,c,n){if(Math.sqrt((c.pX-d)*(c.pX-d)+(c.pY-e)*(c.pY-e))<n.sensitivity)return b.off("mousemove.hoverIntent"+c.namespace,f),delete c.timeoutId,c.isActive=!0,delete c.pX,delete c.pY,n.over.apply(b[0],[a]);c.pX=d;c.pY=e;c.timeoutId=setTimeout(function(){g(a,b,c,n)},n.interval)};
a.fn.hoverIntent=function(d,e,k){var h=c++,l=a.extend({},b);l=a.isPlainObject(d)?a.extend(l,d):a.isFunction(e)?a.extend(l,{over:d,out:e,selector:k}):a.extend(l,{over:d,out:d,selector:e});d=function(b){var c=a.extend({},b),d=a(this),e=d.data("hoverIntent");e||d.data("hoverIntent",e={});var p=e[h];p||(e[h]=p={id:h});p.timeoutId&&(p.timeoutId=clearTimeout(p.timeoutId));e=p.namespace=".hoverIntent"+h;"mouseenter"===b.type?p.isActive||(p.pX=c.pageX,p.pY=c.pageY,d.on("mousemove.hoverIntent"+e,f),p.timeoutId=
setTimeout(function(){g(c,d,p,l)},l.interval)):p.isActive&&(d.off("mousemove.hoverIntent"+e,f),p.timeoutId=setTimeout(function(){var a=p,b=l.out;delete d.data("hoverIntent")[a.id];b.apply(d[0],[c])},l.timeout))};return this.on({"mouseenter.hoverIntent":d,"mouseleave.hoverIntent":d},l.selector)}});
(function(a,b){var c=function(){(function(){a(window).on("load",function(){a("body").children().on("click.superfish",function(){a(".sf-js-enabled").superfish("hide","true")})})})();var c=function(){var b=/^(?![\w\W]*Windows Phone)[\w\W]*(iPhone|iPad|iPod)/i.test(navigator.userAgent);if(b)a("html").css("cursor","pointer").on("click",a.noop);return b}(),e=function(){var a=document.documentElement.style;return"behavior"in a&&"fill"in a&&/iemobile/i.test(navigator.userAgent)}(),f=!!b.PointerEvent,g=function(a,
b,c){var d="sf-js-enabled";b.cssArrows&&(d+=" sf-arrows");a[c?"addClass":"removeClass"](d)},h=function(b,c){return b.find("li."+c.pathClass).slice(0,c.pathLevels).addClass(c.hoverClass+" sf-breadcrumb").filter(function(){return a(this).children(c.popUpSelector).hide().show().length}).removeClass(c.pathClass)},m=function(a,b){var c=b?"addClass":"removeClass";a.children("a")[c]("sf-with-ul")},k=function(a){var b=a.css("ms-touch-action"),c=a.css("touch-action");c="pan-y"===(c||b)?"auto":"pan-y";a.css({"ms-touch-action":c,
"touch-action":c})},n=function(a){return a.closest(".sf-js-enabled").data("sfOptions")},l=function(){var b=a(this),c=n(b);clearTimeout(c.sfTimer);b.siblings().superfish("hide").end().superfish("show")},q=function(b){b.retainPath=-1<a.inArray(this[0],b.$path);this.superfish("hide");this.parents("."+b.hoverClass).length||(b.onIdle.call(this.closest(".sf-js-enabled")),b.$path.length&&a.proxy(l,b.$path)())},t=function(){var b=a(this),d=n(b);c?a.proxy(q,b,d)():(clearTimeout(d.sfTimer),d.sfTimer=setTimeout(a.proxy(q,
b,d),d.delay))},u=function(b){var c=a(this),d=n(c),e=c.siblings(b.data.popUpSelector);if(!1===d.onHandleTouch.call(e))return this;0<e.length&&e.is(":hidden")&&(c.one("click.superfish",!1),"MSPointerDown"===b.type||"pointerdown"===b.type?c.trigger("focus"):a.proxy(l,c.parent("li"))())};return{hide:function(b){if(this.length){var c=n(this);if(!c)return this;var d=!0===c.retainPath?c.$path:"";d=this.find("li."+c.hoverClass).add(this).not(d).removeClass(c.hoverClass).children(c.popUpSelector);var e=c.speedOut;
b&&(d.show(),e=0);c.retainPath=!1;if(!1===c.onBeforeHide.call(d))return this;d.stop(!0,!0).animate(c.animationOut,e,function(){var b=a(this);c.onHide.call(b)})}return this},show:function(){var a=n(this);if(!a)return this;var b=this.addClass(a.hoverClass).children(a.popUpSelector);if(!1===a.onBeforeShow.call(b))return this;b.stop(!0,!0).animate(a.animation,a.speed,function(){a.onShow.call(b)});return this},destroy:function(){return this.each(function(){var b=a(this),c=b.data("sfOptions");if(!c)return!1;
var d=b.find(c.popUpSelector).parent("li");clearTimeout(c.sfTimer);g(b,c);m(d);k(b);b.off(".superfish").off(".hoverIntent");d.children(c.popUpSelector).attr("style",function(a,b){return b.replace(/display[^;]+;?/g,"")});c.$path.removeClass(c.hoverClass+" sf-breadcrumb").addClass(c.pathClass);b.find("."+c.hoverClass).removeClass(c.hoverClass);c.onDestroy.call(b);b.removeData("sfOptions")})},init:function(b){return this.each(function(){var d=a(this);if(d.data("sfOptions"))return!1;var q=a.extend({},
a.fn.superfish.defaults,b),n=d.find(q.popUpSelector).parent("li");q.$path=h(d,q);d.data("sfOptions",q);g(d,q,!0);m(n,!0);k(d);var r="li:has("+q.popUpSelector+")";if(a.fn.hoverIntent&&!q.disableHI)d.hoverIntent(l,t,r);else d.on("mouseenter.superfish",r,l).on("mouseleave.superfish",r,t);r="MSPointerDown.superfish";f&&(r="pointerdown.superfish");c||(r+=" touchend.superfish");e&&(r+=" mousedown.superfish");d.on("focusin.superfish","li",l).on("focusout.superfish","li",t).on(r,"a",q,u);n.not(".sf-breadcrumb").superfish("hide",
!0);q.onInit.call(this)})}}}();a.fn.superfish=function(b,e){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof b&&b?a.error("Method "+b+" does not exist on jQuery.fn.superfish"):c.init.apply(this,arguments)};a.fn.superfish.defaults={popUpSelector:"ul,.sf-mega",hoverClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:!0,disableHI:!1,onInit:a.noop,onBeforeShow:a.noop,
onShow:a.noop,onBeforeHide:a.noop,onHide:a.noop,onIdle:a.noop,onDestroy:a.noop,onHandleTouch:a.noop}})(jQuery,window);
(function(a,b){var c=function(){(function(){a(b).on("load",function(){a("body").children().on("click.superclick",function(){a(".sf-js-enabled").superclick("reset")})})})();var c=function(a,b){var c="sf-js-enabled";b.cssArrows&&(c+=" sf-arrows");a.toggleClass(c)},e=function(b,c){return b.find("li."+c.pathClass).slice(0,c.pathLevels).addClass(c.activeClass+" sf-breadcrumb").filter(function(){return a(this).children(c.popUpSelector).hide().show().length}).removeClass(c.pathClass)},f=function(a){var b=
a.css("ms-touch-action"),c=a.css("touch-action");c="pan-y"===(c||b)?"auto":"pan-y";a.css({"ms-touch-action":c,"touch-action":c})},g=function(b){var c=a(this),d=c.siblings(b.data.popUpSelector);if(d.length)return b=!d.is(":hidden"),d=d.is(":hidden")?m:k,a.proxy(d,c.parent("li"))(),!!b},h=function(b){var c=a(this),d=c.siblings(b.data.popUpSelector);b=b.currentTarget.href;if(1===d.length&&b)return d.not(":hidden")&&a.proxy(k,c.parent("li"))(),window.location=b,!1},m=function(){var b=a(this);l(b);b.siblings().superclick("hide").end().superclick("show")},
k=function(){var b=a(this),c=l(b);a.proxy(n,b,c)()},n=function(b){b.retainPath=-1<a.inArray(this[0],b.$path);this.superclick("hide");this.parents("."+b.activeClass).length||(b.onIdle.call(this.closest(".sf-js-enabled")),b.$path.length&&a.proxy(m,b.$path)())},l=function(a){return a.closest(".sf-js-enabled").data("sf-options")};return{hide:function(b){if(this.length){var c=l(this);if(!c)return this;var d=!0===c.retainPath?c.$path:"";d=this.find("li."+c.activeClass).add(this).not(d).removeClass(c.activeClass).children(c.popUpSelector);
var e=c.speedOut;b&&(d.show(),e=0);c.retainPath=!1;c.onBeforeHide.call(d);d.stop(!0,!0).animate(c.animationOut,e,function(){var b=a(this);c.onHide.call(b)})}return this},show:function(){var a=l(this);if(!a)return this;var b=this.addClass(a.activeClass).children(a.popUpSelector);a.onBeforeShow.call(b);b.stop(!0,!0).animate(a.animation,a.speed,function(){a.onShow.call(b)});return this},destroy:function(){return this.each(function(){var b=a(this),d=b.data("sf-options");if(!d)return!1;var e=b.find(d.popUpSelector).parent("li");
c(b,d);e.children("a").toggleClass("sf-with-ul");f(b);b.off(".superclick");e.children(d.popUpSelector).attr("style",function(a,b){return b.replace(/display[^;]+;?/g,"")});d.$path.removeClass(d.activeClass+" sf-breadcrumb").addClass(d.pathClass);b.find("."+d.activeClass).removeClass(d.activeClass);d.onDestroy.call(b);b.removeData("sf-options")})},reset:function(){return this.each(function(){var b=a(this),c=l(b);a(b.find("."+c.activeClass).toArray().reverse()).children("a").trigger("click")})},init:function(b){return this.each(function(){var d=
a(this);if(d.data("sf-options"))return!1;var k=a.extend({},a.fn.superclick.defaults,b),l=d.find(k.popUpSelector).parent("li");k.$path=e(d,k);d.data("sf-options",k);c(d,k);l.children("a").toggleClass("sf-with-ul");f(d);d.on("click.superclick","a",k,g);l.on("dblclick.superclick","a",k,h);l.not(".sf-breadcrumb").superclick("hide",!0);k.onInit.call(this)})}}}();a.fn.superclick=function(b,e){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof b&&b?a.error("Method "+b+
" does not exist on jQuery.fn.superclick"):c.init.apply(this,arguments)};a.fn.superclick.defaults={popUpSelector:"ul,.sf-mega",activeClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:!0,onInit:a.noop,onBeforeShow:a.noop,onShow:a.noop,onBeforeHide:a.noop,onHide:a.noop,onIdle:a.noop,onDestroy:a.noop}})(jQuery,window);
(function(a){a.fn.Elk_NewsFader=function(b){var c={iFadeDelay:5E3,iFadeSpeed:1E3},d=0,e=a(this).find("li");1<e.length&&(a.extend(c,b),e.hide(),e.eq(0).fadeIn(c.iFadeSpeed),setInterval(function(){a(e[d]).fadeOut(c.iFadeSpeed,function(){d++;d==e.length&&(d=0);a(e[d]).fadeIn(c.iFadeSpeed)})},c.iFadeSpeed+c.iFadeDelay));return this}})(jQuery);/*
 @name      ElkArte Forum
 @copyright ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 This file contains code covered by:
 copyright:	2011 Simple Machines (http://www.simplemachines.org)
 license:		BSD, See included LICENSE.TXT for terms and conditions.

 @version 1.1
*/
var elk_formSubmitted=!1,lastKeepAliveCheck=(new Date).getTime(),ajax_indicator_ele=null,ua=navigator.userAgent.toLowerCase(),is_opera=!!window.opera,is_ff="undefined"!==typeof InstallTrigger||(-1!==ua.indexOf("iceweasel")||-1!==ua.indexOf("icecat")||-1!==ua.indexOf("shiretoko")||-1!==ua.indexOf("minefield"))&&!is_opera,is_safari=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),is_chrome=!!window.chrome,is_ie=!!document.documentMode,is_webkit=-1!==ua.indexOf("applewebkit");
is_osx=0<=navigator.platform.toUpperCase().indexOf("MAC");is_mobile=-1!==navigator.userAgent.indexOf("Mobi");is_touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;"getElementsByClassName"in document||(document.getElementsByClassName=function(a){return $("."+a)});
function getXMLDocument(a,b){var c=new XMLHttpRequest,d="undefined"!==typeof b,e=this;d&&(c.onreadystatechange=function(){4===c.readyState&&(null!==c.responseXML&&200===c.status?b.call(e,c.responseXML):b.call(e,!1))});c.open("GET",a,d);c.send(null);return c}
function sendXMLDocument(a,b,c){var d=new window.XMLHttpRequest,e=this;"undefined"!==typeof c&&(d.onreadystatechange=function(){4===d.readyState&&(null!==d.responseXML&&200===d.status?c.call(e,d.responseXML):c.call(e,!1))});d.open("POST",a,!0);"setRequestHeader"in d&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(b);return!0}String.prototype.php_strtr=function(a,b){return this.replace(new RegExp("["+a+"]","g"),function(c){return b.charAt(a.indexOf(c))})};
String.prototype.php_strtolower=function(){return"boolean"===typeof elk_iso_case_folding&&!0===elk_iso_case_folding?this.php_strtr("ABCDEFGHIJKLMNOPQRSTUVWXYZ\u008a\u008c\u008e\u009f\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\u00d0\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6\u00d7\u00d8\u00d9\u00da\u00db\u00dc\u00dd\u00de","abcdefghijklmnopqrstuvwxyz\u009a\u009c\u009e\u00ff\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u00e7\u00e8\u00e9\u00ea\u00eb\u00ec\u00ed\u00ee\u00ef\u00f0\u00f1\u00f2\u00f3\u00f4\u00f5\u00f6\u00f7\u00f8\u00f9\u00fa\u00fb\u00fc\u00fd\u00fe"):
this.php_strtr("ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")};String.prototype.php_urlencode=function(){return encodeURIComponent(this).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")};String.prototype.php_htmlspecialchars=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};
String.prototype.php_unhtmlspecialchars=function(){return this.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};String.prototype.php_addslashes=function(){return this.replace(/\\/g,"\\\\").replace(/'/g,"\\'")};String.prototype._replaceEntities=function(a,b,c){return String.fromCharCode(parseInt(c))};String.prototype.removeEntities=function(){return this.replace(/&(amp;)?#(\d+);/g,this._replaceEntities)};
String.prototype.easyReplace=function(a){var b=this;for(c in a){var c=c.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");b=b.replace(new RegExp("%"+c+"%","g"),a[c])}return b};function php_str_repeat(a,b){return 1>b?"":a+php_str_repeat(a,b-1)}
function reqWin(a,b,c,d){b&&.8*self.screen.availWidth<b||c&&.8*self.screen.availHeight<c?(d=!1,b=Math.min(b,.8*self.screen.availWidth),c=Math.min(c,.8*self.screen.availHeight)):d="boolean"===typeof d&&!0===d;window.open(a,"requested_popup","toolbar=no,location=no,status=no,menubar=no,scrollbars="+(d?"no":"yes")+",width="+(b?b:480)+",height="+(c?c:220)+",resizable=no");return!1}
function reqOverlayDiv(a,b,c){b="string"===typeof b?b:help_popup_heading_text;b=new smc_Popup({heading:b,content:'<div class="centertext"><i class="icon icon-spin icon-big i-spinner"></i></div>',icon:"string"===typeof c?c:"i-help"});var d=$("#"+b.popup_id).find(".popup_content");$.ajax({url:a,type:"GET",dataType:"html"}).done(function(a,b,c){a=$('<div id="temp_help">').html(a).find('a[href$="self.close();"]').hide().prev("br").hide().parent().html();d.html(a)}).fail(function(a,b,c){d.html(b)});return!1}
function smc_Popup(a){this.opt=a;this.popup_id=this.opt.custom_id?this.opt.custom_id:"elk_popup";this.show()}
smc_Popup.prototype.show=function(){var a="popup_window "+(this.opt.custom_class?this.opt.custom_class:"content"),b=this.opt.icon?'<i class="icon '+this.opt.icon+' icon-top"></i> ':"";$("body").append('<div id="'+this.popup_id+'" class="popup_container"><div class="'+a+'" style="max-height: none;"><h3 class="popup_heading"><a href="javascript:void(0);" class="hide_popup icon i-close" title="Close"></a>'+b+this.opt.heading+'</h3><div class="popup_content">'+this.opt.content+"</div></div></div>");this.popup_body=
$("#"+this.popup_id).children(".popup_window");this.popup_body.parent().fadeIn(300);this.popup_body.addClass("in");var c=this;$(document).mouseup(function(a){0===$("#"+c.popup_id).has(a.target).length&&c.hide()}).keyup(function(a){27===a.keyCode&&c.hide()});$("#"+this.popup_id).find(".hide_popup").on("click",function(){return c.hide()});return!1};smc_Popup.prototype.hide=function(){$("#"+this.popup_id).fadeOut(300,function(){$(this).remove()});return!1};
function replaceText(a,b){if("selectionStart"in b){var c=b.value.substr(0,b.selectionStart),d=b.value.substr(b.selectionEnd),e=b.scrollTop,f=0;b.value=c+a+d;b.setSelectionRange&&(b.focus(),is_opera&&null!==a.match(/\n/g)&&(f=a.match(/\n/g).length),b.setSelectionRange(c.length+a.length+f,c.length+a.length+f));b.scrollTop=e}else b.value+=a,b.focus(b.value.length-1)}
function isEmptyText(a){for(a="string"===typeof a?a:a.value;0<a.length&&(" "===a.charAt(0)||"\t"===a.charAt(0));)a=a.substring(1,a.length);for(;0<a.length&&(" "===a.charAt(a.length-1)||"\t"===a.charAt(a.length-1));)a=a.substring(0,a.length-1);return""===a}function submitonce(a){elk_formSubmitted=!0}
function submitThisOnce(a,b){var c=("form"in a?a.form:a).getElementsByTagName("textarea");b="undefined"==typeof b?!0:b;for(var d=0,e=c.length;d<e;d++)c[d].readOnly=b;window.setTimeout(function(){submitThisOnce(a,!1)},1E3);return!elk_formSubmitted}function setInnerHTML(a,b){a&&(a.innerHTML=b)}function getInnerHTML(a){if(a)return a.innerHTML}
function setOuterHTML(a,b){if("outerHTML"in a)a.outerHTML=b;else{var c=document.createRange();c.setStartBefore(a);a.parentNode.replaceChild(c.createContextualFragment(b),a)}}function in_array(a,b){for(var c in b)if(b[c]==a)return!0;return!1}function array_search(a,b){for(var c in b)if(b[c]==a)return c;return null}function selectRadioByName(a,b){if(!("length"in a))return a.checked=!0;for(var c=0,d=a.length;c<d;c++)if(a[c].value===b)return a[c].checked=!0;return!1}
function selectAllRadio(a,b,c,d){for(a=0;a<b.length;a++)void 0!==b[a].name&&b[a].name.substr(0,c.length)==c&&b[a].value==d&&(b[a].checked=!0)}function invertAll(a,b,c,d){for(var e=0;e<b.length;e++)"name"in b[e]&&("string"!==typeof c||b[e].name.substr(0,c.length)===c||b[e].id.substr(0,c.length)===c)&&(!b[e].disabled||"boolean"===typeof d&&d)&&(b[e].checked=a.checked)}
function elk_sessionKeepAlive(){var a=(new Date).getTime();elk_scripturl&&9E5<a-lastKeepAliveCheck&&((new Image).src=elk_prepareScriptUrl(elk_scripturl)+"action=keepalive;time="+a,lastKeepAliveCheck=a);window.setTimeout(function(){elk_sessionKeepAlive()},12E5)}window.setTimeout(function(){elk_sessionKeepAlive()},12E5);
function elk_setThemeOption(a,b,c,d){if(null===d||"undefined"===typeof d)d="";(new Image).src=elk_prepareScriptUrl(elk_scripturl)+"action=jsoption;var="+a+";val="+b+";"+elk_session_var+"="+elk_session_id+d+(null===c?"":"&th="+c)+";time="+(new Date).getTime()}
function hashLoginPassword(a,b,c){"undefined"!==typeof hex_sha256&&-1===a.user.value.indexOf("@")&&(a.passwrd.autocomplete="off",a.hash_passwrd.value=hex_sha256(a.user.value.php_strtolower()+a.passwrd.value),"old_hash_passwrd"in a&&"undefined"!==typeof hex_sha1&&(a.old_hash_passwrd.value=hex_sha1(hex_sha1(a.user.value.php_strtolower()+a.passwrd.value)+b+("undefined"===typeof c?"":c))),a.passwrd.value=a.passwrd.value.replace(/./g,"*"))}
function hashAdminPassword(a,b,c,d){"undefined"!==typeof hex_sha256&&(a.admin_hash_pass.value=hex_sha256(b.php_strtolower()+a.admin_pass.value),a.admin_pass.value=a.admin_pass.value.replace(/./g,"*"))}function hashModeratePassword(a,b,c,d){"undefined"!==typeof hex_sha256&&(a.moderate_hash_pass.value=hex_sha256(b.php_strtolower()+a.moderate_pass.value),a.moderate_pass.value=a.moderate_pass.value.replace(/./g,"*"))}
function expandPages(a,b,c,d,e){var f="",g=0;50<(d-c)/e&&(g=d,d=c+50*e);for(;c<d;c+=e)f+='<a class="navPages" href="'+b.replace(/%1\$d/,c).replace(/%%/g,"%")+'">'+(1+c/e)+"</a> ";0<g&&(f+='<span class="expand_pages" role="menuitem" onclick="expandPages(this, \''+b+"', "+d+", "+g+", "+e+');"> ... </span> ');setOuterHTML(a,f)}function smc_preCacheImage(a){"smc_aCachedImages"in window||(window.smc_aCachedImages=[]);in_array(a,window.smc_aCachedImages)||((new Image).src=a)}
function smc_Cookie(a){this.opt=a;this.oCookies={};this.init()}smc_Cookie.prototype.init=function(){if("cookie"in document&&""!==document.cookie)for(var a=document.cookie.split(";"),b=0,c=a.length;b<c;b++){var d=a[b].split("=");this.oCookies[d[0].replace(/^\s+|\s+$/g,"")]=decodeURIComponent(d[1])}};smc_Cookie.prototype.get=function(a){return a in this.oCookies?this.oCookies[a]:null};smc_Cookie.prototype.set=function(a,b){document.cookie=a+"="+encodeURIComponent(b)};
function elk_Toggle(a){this.opt=a;this.bCollapsed=!1;this.oCookie=null;this.init()}
elk_Toggle.prototype.init=function(){var a=0,b=0;if(!("bToggleEnabled"in this.opt)||this.opt.bToggleEnabled){"oCookieOptions"in this.opt&&this.opt.oCookieOptions.bUseCookie&&(this.oCookie=new smc_Cookie({}),a=this.oCookie.get(this.opt.oCookieOptions.sCookieName),null!==a&&(this.opt.bCurrentlyCollapsed="1"===a));this.opt.bCurrentlyCollapsed&&this.changeState(!0,!0);if("aSwapImages"in this.opt)for(a=0,b=this.opt.aSwapImages.length;a<b;a++){var c=document.getElementById(this.opt.aSwapImages[a].sId);
"object"===typeof c&&null!==c&&("none"===getComputedStyle(c).getPropertyValue("display")&&(c.style.display="inline"),c.instanceRef=this,c.onclick=function(){this.instanceRef.toggle();this.blur()},c.style.cursor="pointer",smc_preCacheImage(this.opt.aSwapImages[a].srcCollapsed))}else if("aSwapClasses"in this.opt)for(a=0,b=this.opt.aSwapClasses.length;a<b;a++)c=document.getElementById(this.opt.aSwapClasses[a].sId),"object"===typeof c&&null!==c&&("none"===getComputedStyle(c).getPropertyValue("display")&&
(c.style.display="block"),c.instanceRef=this,c.onclick=function(){this.instanceRef.toggle();this.blur()},c.style.cursor="pointer");if("aSwapLinks"in this.opt)for(a=0,b=this.opt.aSwapLinks.length;a<b;a++)c=document.getElementById(this.opt.aSwapLinks[a].sId),"object"===typeof c&&null!==c&&("none"===getComputedStyle(c).getPropertyValue("display")&&(c.style.display="inline-block"),c.instanceRef=this,c.onclick=function(){this.instanceRef.toggle();this.blur();return!1})}};
elk_Toggle.prototype.changeState=function(a,b){var c;b="undefined"!==typeof b;!b&&a&&"funcOnBeforeCollapse"in this.opt?(this.tmpMethod=this.opt.funcOnBeforeCollapse,this.tmpMethod(),delete this.tmpMethod):!b&&!a&&"funcOnBeforeExpand"in this.opt&&(this.tmpMethod=this.opt.funcOnBeforeExpand,this.tmpMethod(),delete this.tmpMethod);if("aSwapImages"in this.opt){var d=0;for(c=this.opt.aSwapImages.length;d<c;d++){var e=document.getElementById(this.opt.aSwapImages[d].sId);if("object"===typeof e&&null!==e){var f=
a?this.opt.aSwapImages[d].srcCollapsed:this.opt.aSwapImages[d].srcExpanded;e.src!=f&&(e.src=f);e.alt=e.title=a?this.opt.aSwapImages[d].altCollapsed:this.opt.aSwapImages[d].altExpanded}}}else if("aSwapClasses"in this.opt)for(d=0,c=this.opt.aSwapClasses.length;d<c;d++)e=document.getElementById(this.opt.aSwapClasses[d].sId),"object"===typeof e&&null!==e&&(f=a?this.opt.aSwapClasses[d].classCollapsed:this.opt.aSwapClasses[d].classExpanded,e.className!==f&&(e.className=f),e.title=e.title=a?this.opt.aSwapClasses[d].titleCollapsed:
this.opt.aSwapClasses[d].titleExpanded);if("aSwapLinks"in this.opt)for(d=0,c=this.opt.aSwapLinks.length;d<c;d++)e=document.getElementById(this.opt.aSwapLinks[d].sId),"object"===typeof e&&null!==e&&(e.innerHTML=a?this.opt.aSwapLinks[d].msgCollapsed:this.opt.aSwapLinks[d].msgExpanded);d=0;for(c=this.opt.aSwappableContainers.length;d<c;d++)null!==this.opt.aSwappableContainers[d]&&(e=document.getElementById(this.opt.aSwappableContainers[d]),"object"===typeof e&&null!==e&&(a?$(e).slideUp():$(e).slideDown()));
this.bCollapsed=a;"oCookieOptions"in this.opt&&this.opt.oCookieOptions.bUseCookie&&this.oCookie.set(this.opt.oCookieOptions.sCookieName,this.bCollapsed?"1":"0");!b&&"oThemeOptions"in this.opt&&this.opt.oThemeOptions.bUseThemeSettings&&elk_setThemeOption(this.opt.oThemeOptions.sOptionName,this.bCollapsed?"1":"0","sThemeId"in this.opt.oThemeOptions?this.opt.oThemeOptions.sThemeId:null,"sAdditionalVars"in this.opt.oThemeOptions?this.opt.oThemeOptions.sAdditionalVars:null)};
elk_Toggle.prototype.toggle=function(){this.changeState(!this.bCollapsed)};function ajax_indicator(a){null===ajax_indicator_ele&&(ajax_indicator_ele=document.getElementById("ajax_in_progress"),null===ajax_indicator_ele&&create_ajax_indicator_ele());null!==ajax_indicator_ele&&(ajax_indicator_ele.style.display=a?"block":"none")}
function create_ajax_indicator_ele(){ajax_indicator_ele=document.createElement("div");ajax_indicator_ele.id="ajax_in_progress";var a=document.createElement("a");a.href="javascript:ajax_indicator(false)";var b=document.createElement("img");b.src=elk_images_url+"/icons/quick_remove.png";"undefined"!==typeof ajax_notification_cancel_text&&(b.alt=ajax_notification_cancel_text,b.title=ajax_notification_cancel_text);a.appendChild(b);ajax_indicator_ele.appendChild(a);ajax_indicator_ele.innerHTML+=ajax_notification_text;
document.body.appendChild(ajax_indicator_ele)}function createEventListener(a){"addEventListener"in a||(a.attachEvent?(a.addEventListener=function(b,c,d){a.attachEvent("on"+b,c)},a.removeEventListener=function(b,c,d){a.detachEvent("on"+b,c)}):(a.addEventListener=function(b,c,d){a["on"+b]=c},a.removeEventListener=function(b,c,d){a["on"+b]=null}))}function grabJumpToContent(){getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=xmlhttp;sa=jumpto;xml",onJumpReceived);return!1}
function onJumpReceived(a){var b=[],c,d=a.getElementsByTagName("elk")[0].getElementsByTagName("item");a=0;for(c=d.length;a<c;a++)b[b.length]={id:parseInt(d[a].getAttribute("id")),isCategory:"category"===d[a].getAttribute("type"),name:d[a].firstChild.nodeValue.removeEntities(),is_current:!1,childLevel:parseInt(d[a].getAttribute("childlevel"))};a=0;for(c=aJumpTo.length;a<c;a++)aJumpTo[a].fillSelect(b)}var aJumpTo=[];
function JumpTo(a){this.opt=a;this.dropdownList=null;this.showSelect();createEventListener(this.dropdownList);is_mobile&&is_touch?this.dropdownList.addEventListener("touchstart",grabJumpToContent):this.dropdownList.addEventListener("mouseenter",grabJumpToContent)}JumpTo.prototype.removeAll=function(){for(var a=this.dropdownList.options.length;0<a;a--)this.dropdownList.remove(a-1)};
JumpTo.prototype.showSelect=function(){for(var a="",b=this.opt.iCurBoardChildLevel;0<b;b--)a+=this.opt.sBoardChildLevelIndicator;""!==a&&(a+=this.opt.sBoardPrefix);document.getElementById(this.opt.sContainerId).innerHTML=this.opt.sJumpToTemplate.replace(/%select_id%/,this.opt.sContainerId+"_select").replace(/%dropdown_list%/,"<select "+(!0===this.opt.bDisabled?'disabled="disabled" ':"")+(void 0!==this.opt.sClassName?'class="'+this.opt.sClassName+'" ':"")+'name="'+(void 0!==this.opt.sCustomName?this.opt.sCustomName:
this.opt.sContainerId+"_select")+'" id="'+this.opt.sContainerId+'_select"><option value="'+(void 0!==this.opt.bNoRedirect&&!0===this.opt.bNoRedirect?this.opt.iCurBoardId:"?board="+this.opt.iCurBoardId+".0")+'">'+a+this.opt.sCurBoardName.removeEntities()+"</option></select>&nbsp;"+(void 0!==this.opt.sGoButtonLabel?'<input type="button" class="button_submit" value="'+this.opt.sGoButtonLabel+'" onclick="window.location.href = \''+elk_prepareScriptUrl(elk_scripturl)+"board="+this.opt.iCurBoardId+".0';\" />":
""));this.dropdownList=document.getElementById(this.opt.sContainerId+"_select")};
JumpTo.prototype.fillSelect=function(a){this.removeAll();is_mobile&&is_touch?this.dropdownList.removeEventListener("touchstart",grabJumpToContent):this.dropdownList.removeEventListener("mouseenter",grabJumpToContent);for(var b=document.createDocumentFragment(),c=document.createElement("optgroup"),d=0,e=a.length;d<e;d++){var f="";if(a[d].isCategory)c=document.createElement("optgroup"),c.label=a[d].name,b.appendChild(c);else{var g=a[d].childLevel;for(f="";0<g;g--)f+=this.opt.sBoardChildLevelIndicator;
""!==f&&(f+=this.opt.sBoardPrefix);g=document.createElement("option");var h=document.createElement("span");h.innerHTML=f+a[d].name;a[d].id===this.opt.iCurBoardId&&(g.selected="selected");g.appendChild(h);g.value=this.opt.bNoRedirect?a[d].id:"?board="+a[d].id+".0";c.appendChild(g)}}this.dropdownList.appendChild(b);this.opt.bNoRedirect||(this.dropdownList.onchange=function(){0<this.selectedIndex&&this.options[this.selectedIndex].value&&(window.location.href=elk_scripturl+this.options[this.selectedIndex].value.substr(-1===
elk_scripturl.indexOf("?")||"?"!==this.options[this.selectedIndex].value.substr(0,1)?0:1))});"funcOnBeforeCollapse"in this.opt&&(this.tmpMethod=this.opt.funcOnBeforeCollapse,this.tmpMethod(this),delete this.tmpMethod)};var aIconLists=[];
function IconList(a){this.opt=a;this.bListLoaded=!1;this.funcMousedownHandler=this.oContainerDiv=null;this.funcParent=this;this.iCurTimeout=this.iCurMessageId=0;"sAction"in this.opt&&null!==this.opt.sAction||(this.opt.sAction="messageicons;board="+this.opt.iBoardId);this.initIcons()}
IconList.prototype.initIcons=function(){for(var a=document.images.length-1,b=this.opt.sIconIdPrefix.length;0<=a;a--)document.images[a].id.substr(0,b)===this.opt.sIconIdPrefix&&setOuterHTML(document.images[a],'<div title="'+this.opt.sLabelIconList+'" onclick="'+this.opt.sBackReference+".openPopup(this, "+document.images[a].id.substr(b)+')" onmouseover="'+this.opt.sBackReference+'.onBoxHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onBoxHover(this, false)" style="background: '+this.opt.sBoxBackground+
'; cursor: pointer; padding: 2px; margin: 0 auto; vertical-align: top"><img src="'+document.images[a].src+'" alt="'+document.images[a].alt+'" id="'+document.images[a].id+'" style="vertical-align: top; margin: 0 auto; padding: 0 2px;" /></div>')};
IconList.prototype.onBoxHover=function(a,b){a.style.border=b?this.opt.iBoxBorderWidthHover+"px solid "+this.opt.sBoxBorderColorHover:"";a.style.background=b?this.opt.sBoxBackgroundHover:this.opt.sBoxBackground;a.style.padding=b?2-this.opt.iBoxBorderWidthHover+"px":"2px"};
IconList.prototype.openPopup=function(a,b){this.iCurMessageId=b;this.bListLoaded||null!==this.oContainerDiv||(this.oContainerDiv=document.createElement("div"),this.oContainerDiv.id="iconList",this.oContainerDiv.style.display="none",this.oContainerDiv.style.cursor="pointer",this.oContainerDiv.style.position="absolute",this.oContainerDiv.style.background=this.opt.sContainerBackground,this.oContainerDiv.style.border=this.opt.sContainerBorder,this.oContainerDiv.style.padding="6px 0px",document.body.appendChild(this.oContainerDiv),
ajax_indicator(!0),sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+"action=xmlhttp;sa="+this.opt.sAction+";xml","",this.onIconsReceived),createEventListener(document.body));var c=elk_itemPos(a);this.oContainerDiv.style.top=c[1]+a.offsetHeight+"px";this.oContainerDiv.style.left=c[0]-1+"px";this.oClickedIcon=a;this.bListLoaded&&(this.oContainerDiv.style.display="block");document.body.addEventListener("mousedown",this.onWindowMouseDown,!1)};
IconList.prototype.onIconsReceived=function(a){a=a.getElementsByTagName("elk")[0].getElementsByTagName("icon");for(var b="",c=0,d=a.length;c<d;c++)b+='<span onmouseover="'+this.opt.sBackReference+'.onItemHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onItemHover(this, false);" onmousedown="'+this.opt.sBackReference+".onItemMouseDown(this, '"+a[c].getAttribute("value")+'\');" style="padding: 2px 3px; line-height: 20px; border: '+this.opt.sItemBorder+"; background: "+this.opt.sItemBackground+
'"><img src="'+a[c].getAttribute("url")+'" alt="'+a[c].getAttribute("name")+'" title="'+a[c].firstChild.nodeValue+'" style="vertical-align: middle" /></span>';this.oContainerDiv.innerHTML=b;this.oContainerDiv.style.display="block";this.bListLoaded=!0;is_ie&&(this.oContainerDiv.style.width=this.oContainerDiv.clientWidth+"px");ajax_indicator(!1)};
IconList.prototype.onItemHover=function(a,b){a.style.background=b?this.opt.sItemBackgroundHover:this.opt.sItemBackground;a.style.border=b?this.opt.sItemBorderHover:this.opt.sItemBorder;0!==this.iCurTimeout&&window.clearTimeout(this.iCurTimeout);if(b)this.onBoxHover(this.oClickedIcon,!0);else this.iCurTimeout=window.setTimeout(this.opt.sBackReference+".collapseList();",500)};
IconList.prototype.onItemMouseDown=function(a,b){if(0!==this.iCurMessageId){ajax_indicator(!0);this.tmpMethod=getXMLDocument;var c=this.tmpMethod(elk_prepareScriptUrl(elk_scripturl)+"action=jsmodify;topic="+this.opt.iTopicId+";msg="+this.iCurMessageId+";"+elk_session_var+"="+elk_session_id+";icon="+b+";xml");delete this.tmpMethod;ajax_indicator(!1);c=c.responseXML.getElementsByTagName("elk")[0].getElementsByTagName("message")[0];0===c.getElementsByTagName("error").length&&(this.opt.bShowModify&&0!==
c.getElementsByTagName("modified").length&&null!==document.getElementById("modified_"+this.iCurMessageId)&&(document.getElementById("modified_"+this.iCurMessageId).innerHTML=c.getElementsByTagName("modified")[0].childNodes[0].nodeValue),this.oClickedIcon.getElementsByTagName("img")[0].src=a.getElementsByTagName("img")[0].src)}else this.oClickedIcon.getElementsByTagName("img")[0].src=a.getElementsByTagName("img")[0].src,"sLabelIconBox"in this.opt&&(document.getElementById(this.opt.sLabelIconBox).value=
b)};IconList.prototype.onWindowMouseDown=function(){for(var a=aIconLists.length-1;0<=a;a--)aIconLists[a].funcParent.tmpMethod=aIconLists[a].collapseList,aIconLists[a].funcParent.tmpMethod(),delete aIconLists[a].funcParent.tmpMethod};IconList.prototype.collapseList=function(){this.onBoxHover(this.oClickedIcon,!1);this.oContainerDiv.style.display="none";this.iCurMessageId=0;document.body.removeEventListener("mousedown",this.onWindowMouseDown,!1)};
function elk_itemPos(a){var b=0,c=0;if("offsetParent"in a)for(b=a.offsetLeft,c=a.offsetTop;a.offsetParent&&"object"===typeof a.offsetParent;)a=a.offsetParent,b+=a.offsetLeft,c+=a.offsetTop;else"x"in a&&(b=a.x,c=a.y);return[b,c]}function elk_prepareScriptUrl(a){return-1===a.indexOf("?")?a+"?":a+("?"===a.charAt(a.length-1)||"&"===a.charAt(a.length-1)||";"===a.charAt(a.length-1)?"":";")}var aOnloadEvents=[];
function addLoadEvent(a){"function"!==typeof a||"onload"in window&&"function"===typeof window.onload?0===aOnloadEvents.length?(aOnloadEvents[0]=window.onload,aOnloadEvents[1]=a,window.onload=function(){for(var a=0,c=aOnloadEvents.length;a<c;a++)if("function"===typeof aOnloadEvents[a])aOnloadEvents[a]();else"string"===typeof aOnloadEvents[a]&&eval(aOnloadEvents[a])}):aOnloadEvents[aOnloadEvents.length]=a:window.onload=a}
function elkSelectText(a,b){var c="boolean"===typeof b&&b?document.getElementById(a):a.parentNode.nextSibling;if("object"!==typeof c||null===c)return!1;if("createTextRange"in document.body){var d=document.body.createTextRange();d.moveToElementText(c);d.select()}else if(window.getSelection){d=window.getSelection();var e=document.createRange();e.selectNodeContents(c);d.removeAllRanges();d.addRange(e)}return!1}
function smc_saveEntities(a,b,c){var d;if("string"===typeof c){var e=0;for(d=document.forms[a].elements.length;e<d;e++)document.forms[a].elements[e].id.substr(0,c.length)===c&&(b[b.length]=document.forms[a].elements[e].name)}e=0;for(d=b.length;e<d;e++)b[e]in document.forms[a]&&("undefined"!==typeof post_box_name&&b[e]===post_box_name&&void 0!==$editor_data[post_box_name]?(document.forms[a][b[e]].value=$editor_data[post_box_name].val().replace(/&#/g,"&#38;#"),$editor_data[post_box_name].val(document.forms[a][b[e]].value)):
document.forms[a][b[e]].value=document.forms[a][b[e]].value.replace(/&#/g,"&#38;#"))}function pollOptions(){var a=document.getElementById("poll_expire");isEmptyText(a)||0===a.value?(document.forms[form_name].poll_hide[2].disabled=!0,document.forms[form_name].poll_hide[2].checked&&(document.forms[form_name].poll_hide[1].checked=!0)):document.forms[form_name].poll_hide[2].disabled=!1}
function generateDays(a){a="undefined"!==typeof a?a:"";var b=document.getElementById("day"+a);var c=document.getElementById("year"+a);a=document.getElementById("month"+a);var d=[31,28,31,30,31,30,31,31,30,31,30,31];d[1]=28;0===c.options[c.selectedIndex].value%4&&(d[1]=29);for(c=b.selectedIndex;b.options.length;)b.options[0]=null;a=d[a.value-1];for(d=1;d<=a;d++)b.options[b.length]=new Option(d,d);c<a&&(b.selectedIndex=c)}function toggleLinked(a){a.board.disabled=!a.link_to_board.checked}
function initSearch(){-1!==document.forms.searchform.search.value.indexOf("%u")&&(document.forms.searchform.search.value=decodeURI(document.forms.searchform.search.value))}function selectBoards(a,b,c){for(var d=!0,e=0,f=document.forms.length;e<f;e++)if(document.forms[e].name==b){aForm=document.forms[e];break}if("undefined"!=typeof aForm){for(b=0;b<a.length;b++)d=d&&aForm[c+"["+a[b]+"]"].checked;for(b=0;b<a.length;b++)aForm[c+"["+a[b]+"]"].checked=!d}}
function expandCollapse(a,b,c){a=$("#"+a);b=b||!1;c=c||300;b&&$("#"+b).attr("src",elk_images_url+(!0!==a.is(":hidden")?"/selected.png":"/selected_open.png"));a.slideToggle(c)}function initHighlightSelection(a){$("#"+a+' [name="def_language"]').on("click",function(b){$("#"+a+" .standard_row").removeClass("highlight2");$(this).parent().parent().addClass("highlight2")})}
function doAutoSubmit(a,b,c){var d="undefined"!==typeof c?c:"autoSubmit";if(0===a)document.forms[d].submit();else if(-1===a)return;document.forms[d].cont.value=b+" ("+a+")";a--;setTimeout(function(){doAutoSubmit(a,b,d)},1E3)};/*
 @name      ElkArte Forum
 @copyright ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 This file contains code covered by:
 copyright:	2011 Simple Machines (http://www.simplemachines.org)
 license:		BSD, See included LICENSE.TXT for terms and conditions.

 @version 1.1.1
*/
function QuickModifyTopic(a){this.opt=a;this.aHidePrefixes=this.opt.aHidePrefixes;this.iCurTopicId=0;this.sBuffSubject=this.sCurMessageId="";this.oSavetipElem=!1;this.oCurSubjectDiv=null;this.oTopicModHandle=document;this.bMouseOnDiv=this.bInEditMode=!1;this.init()}QuickModifyTopic.prototype.init=function(){this.oTopicModHandle.instanceRef=this;this.oTopicModHandle.onkeydown=function(a){return this.instanceRef.modify_topic_keypress(a)};this.oTopicModHandle.onclick=function(a){return this.instanceRef.modify_topic_click(a)}};
QuickModifyTopic.prototype.modify_topic=function(a,b){if(this.bInEditMode){if(this.iCurTopicId===a)return;this.modify_topic_cancel()}this.bMouseOnDiv=this.bInEditMode=!0;this.iCurTopicId=a;ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+"action=quotefast;quote="+b+";modify;xml","",this.onDocReceived_modify_topic)};
QuickModifyTopic.prototype.onDocReceived_modify_topic=function(a){if(!a||!a.getElementsByTagName("message"))return this.modify_topic_cancel(),!0;this.sCurMessageId=a.getElementsByTagName("message")[0].getAttribute("id");this.oCurSubjectDiv=document.getElementById("msg_"+this.sCurMessageId.substr(4));this.sBuffSubject=this.oCurSubjectDiv.innerHTML;$.isFunction($.fn.SiteTooltip)&&(this.oSavetipElem=this.oCurSubjectDiv.nextSibling,this.sSavetip=this.oSavetipElem.innerHTML,this.oSavetipElem.innerHTML=
"");this.set_hidden_topic_areas("none");ajax_indicator(!1);this.modify_topic_show_edit(a.getElementsByTagName("subject")[0].childNodes[0].nodeValue)};QuickModifyTopic.prototype.modify_topic_cancel=function(){this.oCurSubjectDiv.innerHTML=this.sBuffSubject;this.set_hidden_topic_areas("");this.bInEditMode=!1;!1!==this.oSavetipElem&&(this.oSavetipElem.innerHTML=this.sSavetip);return!1};
QuickModifyTopic.prototype.set_hidden_topic_areas=function(a){for(var b=0;b<this.aHidePrefixes.length;b++)null!==document.getElementById(this.aHidePrefixes[b]+this.sCurMessageId.substr(4))&&(document.getElementById(this.aHidePrefixes[b]+this.sCurMessageId.substr(4)).style.display=a)};
QuickModifyTopic.prototype.modify_topic_show_edit=function(a){this.oCurSubjectDiv.innerHTML='<input type="text" name="subject" value="'+a+'" size="60" style="width: 95%;" maxlength="80" class="input_text" autocomplete="off" /><input type="hidden" name="topic" value="'+this.iCurTopicId+'" /><input type="hidden" name="msg" value="'+this.sCurMessageId.substr(4)+'" />';this.oCurSubjectDiv.instanceRef=this;this.oCurSubjectDiv.onmouseout=function(a){return this.instanceRef.modify_topic_mouseout(a)};this.oCurSubjectDiv.onmouseover=
function(a){return this.instanceRef.modify_topic_mouseover(a)}};
QuickModifyTopic.prototype.modify_topic_save=function(a,b){if(!this.bInEditMode)return!0;var c=[];c[c.length]="subject="+document.forms.quickModForm.subject.value.replace(/&#/g,"&#38;#").php_urlencode();c[c.length]="topic="+parseInt(document.forms.quickModForm.elements.topic.value);c[c.length]="msg="+parseInt(document.forms.quickModForm.elements.msg.value);ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+"action=jsmodify;topic="+parseInt(document.forms.quickModForm.elements.topic.value)+
";"+b+"="+a+";xml",c.join("&"),this.modify_topic_done);return!1};
QuickModifyTopic.prototype.modify_topic_done=function(a){ajax_indicator(!1);if(!a||!a.getElementsByTagName("subject"))return this.modify_topic_cancel(),!0;var b=a.getElementsByTagName("elk")[0].getElementsByTagName("message")[0];a=b.getElementsByTagName("subject")[0];b=b.getElementsByTagName("error")[0];if(!a||b)return!1;this.modify_topic_hide_edit(a.childNodes[0].nodeValue);this.set_hidden_topic_areas("");this.bInEditMode=!1;$.isFunction($.fn.SiteTooltip)&&(this.oSavetipElem.innerHTML=this.sSavetip,
$(".preview").SiteTooltip());return!1};QuickModifyTopic.prototype.modify_topic_hide_edit=function(a){this.oCurSubjectDiv.innerHTML='<a href="'+elk_scripturl+"?topic="+this.iCurTopicId+'.0">'+a+"</a>"};
QuickModifyTopic.prototype.modify_topic_keypress=function(a){"undefined"!==typeof a.keyCode&&this.bInEditMode&&(27===a.keyCode?(this.modify_topic_cancel(),"undefined"===typeof a.preventDefault?a.returnValue=!1:a.preventDefault()):13===a.keyCode&&(this.modify_topic_save(elk_session_id,elk_session_var),"undefined"===typeof a.preventDefault?a.returnValue=!1:a.preventDefault()))};
QuickModifyTopic.prototype.modify_topic_click=function(a){this.bInEditMode&&!this.bMouseOnDiv&&this.modify_topic_save(elk_session_id,elk_session_var)};QuickModifyTopic.prototype.modify_topic_mouseout=function(a){this.bMouseOnDiv=!1};QuickModifyTopic.prototype.modify_topic_mouseover=function(a){this.bMouseOnDiv=!0;a.preventDefault()};function QuickReply(a){this.opt=a;this.bCollapsed=this.opt.bDefaultCollapsed;this.bIsFull=this.opt.bIsFull;this.bCollapsed&&this.swap(!0)}
QuickReply.prototype.quote=function(a,b){ajax_indicator(!0);if(this.bCollapsed)return window.location.href=elk_prepareScriptUrl(this.opt.sScriptUrl)+"action=post;quote="+a+";topic="+this.opt.iTopicId+"."+this.opt.iStart,!1;this.bIsFull?insertQuoteFast(a):getXMLDocument(elk_prepareScriptUrl(this.opt.sScriptUrl)+"action=quotefast;quote="+a+";xml",this.onQuoteReceived);window.location.hash="Microsoft Internet Explorer"===navigator.appName?this.opt.sJumpAnchor:"#"+this.opt.sJumpAnchor;return!1};
QuickReply.prototype.onQuoteReceived=function(a){for(var b="",c=0;c<a.getElementsByTagName("quote")[0].childNodes.length;c++)b+=a.getElementsByTagName("quote")[0].childNodes[c].nodeValue;replaceText(b,document.forms.postmodify.message);ajax_indicator(!1)};
QuickReply.prototype.swap=function(a,b){var c=document.getElementById(this.opt.sClassId),d=this.opt.sContainerId,e=this.opt.bIsFull;a="undefined"!==typeof a;b="undefined"===typeof b;a||(this.bCollapsed=!this.bCollapsed);var f=this.bCollapsed?this.opt.sClassExpanded:this.opt.sClassCollapsed;c.className!==f&&(c.className=f);c.title=this.bCollapsed?this.opt.sTitleCollapsed:this.opt.sTitleExpanded;this.bCollapsed?$("#"+this.opt.sContainerId).slideUp():($("#"+this.opt.sContainerId).slideDown(),e&&$("#"+
d).resize());b&&"oCookieOptions"in this.opt&&this.opt.oCookieOptions.bUseCookie&&this.oCookie.set(this.opt.oCookieOptions.sCookieName,this.bCollapsed?"1":"0");!a&&b&&"oThemeOptions"in this.opt&&this.opt.oThemeOptions.bUseThemeSettings&&elk_setThemeOption(this.opt.oThemeOptions.sOptionName,this.bCollapsed?"1":"0","sThemeId"in this.opt.oThemeOptions?this.opt.oThemeOptions.sThemeId:null,"sAdditionalVars"in this.opt.oThemeOptions?this.opt.oThemeOptions.sAdditionalVars:null)};
function QuickModify(a){this.opt=a;this.bInEditMode=!1;this.sCurMessageId="";this.oMsgIcon=this.oCurSubjectDiv=this.oCurInfoDiv=this.oCurMessageDiv=null;this.sInfoBuffer=this.sSubjectBuffer=this.sMessageBuffer="";this.aAccessKeys=[];a=document.getElementsByClassName(this.opt.sClassName);for(var b=0,c=a.length;b<c;b++)a[b].style.display="inline"}
QuickModify.prototype.modifyMsg=function(a){if("undefined"!==typeof this.opt.sFormRemoveAccessKeys&&typeof document.forms[this.opt.sFormRemoveAccessKeys])for(var b=document.forms[this.opt.sFormRemoveAccessKeys].getElementsByTagName("input"),c=0;c<b.length;c++)""!==b[c].accessKey&&(this.aAccessKeys[b[c].name]=b[c].accessKey,b[c].accessKey="");this.bInEditMode&&this.modifyCancel();this.bInEditMode=!0;ajax_indicator(!0);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+"action=quotefast;quote="+
a+";modify;xml","",this.onMessageReceived)};
QuickModify.prototype.onMessageReceived=function(a){var b="";ajax_indicator(!1);this.sCurMessageId=a.getElementsByTagName("message")[0].getAttribute("id");null!==this.opt.sIconHide&&(this.oMsgIcon=document.getElementById("messageicon_"+this.sCurMessageId.replace("msg_","")),null!==this.oMsgIcon&&"none"===getComputedStyle(this.oMsgIcon).getPropertyValue("display")&&(this.oMsgIcon.style.display="inline"));if(!document.getElementById(this.sCurMessageId))return this.modifyCancel();for(var c=0;c<a.getElementsByTagName("message")[0].childNodes.length;c++)b+=
a.getElementsByTagName("message")[0].childNodes[c].nodeValue;this.oCurMessageDiv=document.getElementById(this.sCurMessageId);this.sMessageBuffer=this.oCurMessageDiv.innerHTML;b=b.replace(/\$/g,"{&dollarfix;$}");this.oCurMessageDiv.innerHTML=this.opt.sTemplateBodyEdit.replace(/%msg_id%/g,this.sCurMessageId.substr(4)).replace(/%body%/,b).replace(/\{&dollarfix;\$\}/g,"$");null!==this.opt.sIDSubject&&(this.oCurSubjectDiv=document.getElementById(this.opt.sIDSubject+this.sCurMessageId.substr(4)),null!==
this.oCurSubjectDiv&&(this.oCurSubjectDiv.style.display="none",this.sSubjectBuffer=this.oCurSubjectDiv.innerHTML));a=a.getElementsByTagName("subject")[0].childNodes[0].nodeValue.replace(/\$/g,"{&dollarfix;$}");null!==this.opt.sIDInfo&&(this.oCurInfoDiv=document.getElementById(this.opt.sIDInfo+this.sCurMessageId.substr(4)),null!==this.oCurInfoDiv&&(this.sInfoBuffer=this.oCurInfoDiv.innerHTML,this.oCurInfoDiv.innerHTML=this.opt.sTemplateSubjectEdit.replace(/%subject%/,a).replace(/\{&dollarfix;\$\}/g,
"$")));location.hash="#info_"+this.sCurMessageId.substr(this.sCurMessageId.lastIndexOf("_")+1);"funcOnAfterCreate"in this.opt&&(this.tmpMethod=this.opt.funcOnAfterCreate,this.tmpMethod(this),delete this.tmpMethod);return!0};
QuickModify.prototype.modifyCancel=function(){this.oCurMessageDiv&&(this.oCurMessageDiv.innerHTML=this.sMessageBuffer,this.oCurInfoDiv.innerHTML=this.sInfoBuffer,this.oCurSubjectDiv.innerHTML=this.sSubjectBuffer,null!==this.oCurSubjectDiv&&(this.oCurSubjectDiv.style.display=""));if(this.opt.sIconHide){var a=document.getElementById("msg_icon_"+this.sCurMessageId.replace("msg_",""));null!==a&&0<a.src.indexOf(this.opt.sIconHide)&&(this.oMsgIcon.style.display="none")}this.bInEditMode=!1;if("undefined"!==
typeof this.opt.sFormRemoveAccessKeys&&typeof document.forms[this.opt.sFormRemoveAccessKeys]){a=document.forms[this.opt.sFormRemoveAccessKeys].getElementsByTagName("input");for(var b=0;b<a.length;b++)"undefined"!==typeof this.aAccessKeys[a[b].name]&&(a[b].accessKey=this.aAccessKeys[a[b].name])}return!1};
QuickModify.prototype.modifySave=function(a,b){var c,d=[],e=[];if(!this.bInEditMode)return!0;this.bInEditMode=!1;if("undefined"!==typeof this.opt.sFormRemoveAccessKeys&&typeof document.forms[this.opt.sFormRemoveAccessKeys]){var f=document.forms[this.opt.sFormRemoveAccessKeys].getElementsByTagName("input");for(c=0;c<f.length;c++)"undefined"!==typeof this.aAccessKeys[f[c].name]&&(f[c].accessKey=this.aAccessKeys[f[c].name])}f=document.forms.quickModForm.getElementsByTagName("input");for(c=0;c<f.length;c++)"uid[]"===
f[c].name&&e.push("uid["+c+"]="+parseInt(f[c].value));d[d.length]="subject="+document.forms.quickModForm.subject.value.replace(/&#/g,"&#38;#").php_urlencode();d[d.length]="message="+document.forms.quickModForm.message.value.replace(/&#/g,"&#38;#").php_urlencode();d[d.length]="topic="+parseInt(document.forms.quickModForm.elements.topic.value);d[d.length]="msg="+parseInt(document.forms.quickModForm.elements.msg.value);0<e.length&&(d[d.length]=e.join("&"));ajax_indicator(!0);sendXMLDocument.call(this,
elk_prepareScriptUrl(this.opt.sScriptUrl)+"action=jsmodify;topic="+this.opt.iTopicId+";"+elk_session_var+"="+elk_session_id+";xml",d.join("&"),this.onModifyDone);return!1};
QuickModify.prototype.onModifyDone=function(a){ajax_indicator(!1);if(a&&a.getElementsByTagName("elk")[0]){var b=a.getElementsByTagName("elk")[0].getElementsByTagName("message")[0];a=b.getElementsByTagName("body")[0];var c=b.getElementsByTagName("error")[0];$(document.forms.quickModForm.message).removeClass("border_error");$(document.forms.quickModForm.subject).removeClass("border_error");if(a){c="";for(var d=0;d<a.childNodes.length;d++)c+=a.childNodes[d].nodeValue;this.sMessageBuffer=this.opt.sTemplateBodyNormal.replace(/%body%/,
c.replace(/\$/g,"{&dollarfix;$}")).replace(/\{&dollarfix;\$\}/g,"$");this.oCurMessageDiv.innerHTML=this.sMessageBuffer;a=b.getElementsByTagName("subject")[0].childNodes[0].nodeValue.replace(/\$/g,"{&dollarfix;$}");this.sSubjectBuffer=this.opt.sTemplateSubjectNormal.replace(/%subject%/,a).replace(/\{&dollarfix;\$\}/g,"$");this.oCurSubjectDiv.innerHTML=this.sSubjectBuffer;this.oCurSubjectDiv.style.display="";this.oCurInfoDiv.innerHTML=this.sInfoBuffer;this.opt.bShowModify&&(a=document.getElementById("modified_"+
this.sCurMessageId.substr(4)),a.innerHTML=b.getElementsByTagName("modified")[0].childNodes[0].nodeValue,a.style.display="block");null!==this.opt.sIconHide&&(b=document.getElementById("msg_icon_"+this.sCurMessageId.replace("msg_","")),null!==b&&0<b.src.indexOf(this.opt.sIconHide)&&(this.oMsgIcon.style.display="none"));$.isFunction($.fn.linkifyvideo)&&$().linkifyvideo(oEmbedtext,this.sCurMessageId);$("#"+this.sCurMessageId+" .spoilerheader").click(function(){$(this).next().children().slideToggle("fast")});
"function"===typeof elk_codefix&&elk_codefix();"function"===typeof prettyPrint&&prettyPrint()}else c&&(b=document.getElementById("error_box"),b.innerHTML=c.childNodes[0].nodeValue,b.style.display="","1"===c.getAttribute("in_body")&&$(document.forms.quickModForm.message).addClass("border_error"),"1"===c.getAttribute("in_subject")&&$(document.forms.quickModForm.subject).addClass("border_error"))}else"undefined"!==typeof a.childNodes&&0<a.childNodes.length&&"parsererror"===a.firstChild.nodeName?(b=document.getElementById("error_box"),
b.innerHTML=a.firstChild.textContent,b.style.display=""):this.modifyCancel()};function InTopicModeration(a){this.opt=a;this.bButtonsShown=!1;this.iNumSelected=0;"undefined"===typeof this.opt.sSessionVar&&(this.opt.sSessionVar="sesc");this.init()}
InTopicModeration.prototype.init=function(){for(var a=0,b=this.opt.aMessageIds.length;a<b;a++){var c=document.createElement("input");c.type="checkbox";c.className="input_check";c.name="msgs[]";c.value=this.opt.aMessageIds[a];c.instanceRef=this;c.onclick=function(){this.instanceRef.handleClick(this)};var d=document.getElementById(this.opt.sCheckboxContainerMask+this.opt.aMessageIds[a]);d.appendChild(c);d.style.display=""}};
InTopicModeration.prototype.handleClick=function(a){if(!this.bButtonsShown&&this.opt.sButtonStripDisplay){var b=document.getElementById(this.opt.sButtonStrip),c=document.getElementById(this.opt.sButtonStripDisplay);if("object"===typeof c&&null!==c)c.style.display="";else{c=document.createElement("div");var d=document.createElement("ul");c.id=this.opt.sButtonStripDisplay;c.className=this.opt.sButtonStripClass?this.opt.sButtonStripClass:"buttonlist floatbottom";c.appendChild(d);b.appendChild(c)}this.opt.bCanRemove&&
elk_addButton(this.opt.sButtonStrip,this.opt.bUseImageButton,{sId:this.opt.sSelf+"_remove_button",sText:this.opt.sRemoveButtonLabel,sImage:this.opt.sRemoveButtonImage,sUrl:"#",sCustom:' onclick="return '+this.opt.sSelf+".handleSubmit('remove')\""});this.opt.bCanRestore&&elk_addButton(this.opt.sButtonStrip,this.opt.bUseImageButton,{sId:this.opt.sSelf+"_restore_button",sText:this.opt.sRestoreButtonLabel,sImage:this.opt.sRestoreButtonImage,sUrl:"#",sCustom:' onclick="return '+this.opt.sSelf+".handleSubmit('restore')\""});
this.opt.bCanSplit&&elk_addButton(this.opt.sButtonStrip,this.opt.bUseImageButton,{sId:this.opt.sSelf+"_split_button",sText:this.opt.sSplitButtonLabel,sImage:this.opt.sSplitButtonImage,sUrl:"#",sCustom:' onclick="return '+this.opt.sSelf+".handleSubmit('split')\""});this.bButtonsShown=!0}this.iNumSelected+=a.checked?1:-1;this.opt.bCanRemove&&!this.opt.bUseImageButton&&(document.getElementById(this.opt.sSelf+"_remove_button_text").innerHTML=this.opt.sRemoveButtonLabel+" ["+this.iNumSelected+"]",document.getElementById(this.opt.sSelf+
"_remove_button").style.display=1>this.iNumSelected?"none":"");this.opt.bCanRestore&&!this.opt.bUseImageButton&&(document.getElementById(this.opt.sSelf+"_restore_button_text").innerHTML=this.opt.sRestoreButtonLabel+" ["+this.iNumSelected+"]",document.getElementById(this.opt.sSelf+"_restore_button").style.display=1>this.iNumSelected?"none":"");this.opt.bCanSplit&&!this.opt.bUseImageButton&&(document.getElementById(this.opt.sSelf+"_split_button_text").innerHTML=this.opt.sSplitButtonLabel+" ["+this.iNumSelected+
"]",document.getElementById(this.opt.sSelf+"_split_button").style.display=1>this.iNumSelected?"none":"");a=document.getElementById(this.opt.sButtonStrip).getElementsByTagName("span");3<a.length&&(1>this.iNumSelected?(a[a.length-3].className=a[a.length-3].className.replace(/\s*position_holder/,"last"),a[a.length-2].className=a[a.length-2].className.replace(/\s*position_holder/,"last")):(a[a.length-2].className=a[a.length-2].className.replace(/\s*last/,"position_holder"),a[a.length-3].className=a[a.length-
3].className.replace(/\s*last/,"position_holder")))};
InTopicModeration.prototype.handleSubmit=function(a){var b=document.getElementById(this.opt.sFormId),c=document.createElement("input");c.type="hidden";c.name=this.opt.sSessionVar;c.value=this.opt.sSessionId;b.appendChild(c);switch(a){case "remove":if(!confirm(this.opt.sRemoveButtonConfirm))return!1;b.action=b.action.replace(/;split_selection=1/,"");b.action=b.action.replace(/;restore_selected=1/,"");break;case "restore":if(!confirm(this.opt.sRestoreButtonConfirm))return!1;b.action=b.action.replace(/;split_selection=1/,
"");b.action+=";restore_selected=1";break;case "split":if(!confirm(this.opt.sRestoreButtonConfirm))return!1;b.action=b.action.replace(/;restore_selected=1/,"");b.action+=";split_selection=1";break;default:return!1}b.submit();return!0};
function expandThumbLB(a,b){var c=document.getElementById("link_"+a),d=$('a[data-lightboxmessage="'+b+'"]'),e=[],f=null,g=null,h=$('<span id="elk_lb_expand"></span>'),m=$("#elk_lightbox"),k=$("#elk_lb_content"),n=function(){$('<div id="lightbox-loading"><i class="icon icon-spin icon-xl i-spinner"></i><div>').appendTo(k);$("html, body").addClass("elk_lb_no_scrolling")},l=function(){$("#lightbox-loading").remove()},q=function(){h.off("click");m.hide();k.html("").removeAttr("style").removeClass("expand");
$("html, body").removeClass("elk_lb_no_scrolling");$(window).off("resize.lb");$(window).off("keydown.lb");$(window).off("touchstart.lb");$(window).off("touchmove.lb")},t=function(){$('<img id="elk_lb_img" src="'+c.href+'">').on("load",function(){var a=(window.innerWidth?window.innerWidth:$(window).width())*(is_mobile?.8:.9),b=.9*(window.innerHeight?window.innerHeight:$(window).height());$(this).css({"max-width":Math.floor(a)+"px","max-height":Math.floor(b)+"px"});k.html($(this)).append(h);l()}).on("error",
function(){setTimeout(function(){l();q()},1500)})},u=function(){a=e[($.inArray(a,e)+1)%e.length]},v=function(){a=e[($.inArray(a,e)-1+e.length)%e.length]},p=function(){k.html("").removeAttr("style").removeClass("expand");n();h.off("click");c=document.getElementById("link_"+a);t();w()},w=function(){h.on("click",function(){$("#elk_lb_content").addClass("expand").css({height:Math.floor(.95*window.innerHeight)+"px",width:Math.floor(.9*window.innerWidth)+"px",left:"0"});$("#elk_lb_img").removeAttr("style");
h.hide();$(window).off("keydown.lb");$(window).off("touchmove.lb")})};0>=m.length&&(m=$('<div id="elk_lightbox"></div>'),k=$('<div id="elk_lb_content"></div>'),$("body").append(m.append(k)));d.each(function(){e[e.length]=$(this).data("lightboximage")});0===e.length&&(e[e.length]=a);n();m.fadeIn(200);t();w();m.on("click",function(a){a.target.id!==h.attr("id")&&(a.preventDefault(),q())});$(window).on("keydown.lb",function(a){a.preventDefault();27===a.keyCode&&q();37===a.keyCode&&(v(),p());39===a.keyCode&&
(u(),p())});$(window).on("resize.lb",function(){var a=$("#elk_lb_content");a.hasClass("expand")?a.css({height:.85*window.innerHeight,width:.9*window.innerWidth}):$("#elk_lb_img").css({"max-height":.9*window.innerHeight,"max-width":.8*window.innerWidth})});$(window).on("touchstart.lb",function(a){f=a.originalEvent.touches[0].clientX;g=a.originalEvent.touches[0].clientY});$(window).on("touchmove.lb",function(a){if(f&&g){var b=f-a.originalEvent.touches[0].clientX;Math.abs(b)>Math.abs(g-a.originalEvent.touches[0].clientY)&&
(0<b?v():u(),p());g=f=null}});return!1}
function expandThumb(a){var b=document.getElementById("thumb_"+a);a=document.getElementById("link_"+a);for(var c=a.nextSibling;c&&1!==c.nodeType;)c=c.nextSibling;for(var d=c.nextSibling;d&&1!==d.nodeType;)d=d.nextSibling;var e=b.src,f=b.style.height,g=b.style.width;b.src=a.href;b.style.width=a.style.width;b.style.height=a.style.height;c.className=c.className.includes("_exp")?"attachment_name":"attachment_name attachment_name_exp";d.className=d.className.includes("_exp")?"attachment_details":"attachment_details attachment_details_exp";
a.href=e;a.style.width=g;a.style.height=f;return!1}function ignore_toggles(a,b){for(var c=0;c<a.length;c++){var d=a[c];new elk_Toggle({bToggleEnabled:!0,bCurrentlyCollapsed:!0,aSwappableContainers:["msg_"+d+"_extra_info","msg_"+d,"msg_"+d+"_footer","msg_"+d+"_quick_mod","modify_button_"+d,"msg_"+d+"_signature"],aSwapLinks:[{sId:"msg_"+d+"_ignored_link",msgExpanded:"",msgCollapsed:b}]})}}
function sendtopicOverlayDiv(a,b,c){var d;c="string"===typeof c?c:"i-envelope";b="string"===typeof b?b:help_popup_heading_text;$.ajax({url:a,type:"GET",dataType:"html"}).done(function(a){a=$('<div id="temp_help">').html(a).find("#send_topic");var e="";a.find("h3").each(function(){e=$(this).text();$(this).remove()});a.find("form");var g=a.find("form").attr("action"),h=new smc_Popup({heading:""!==e?e:b,content:'<div class="centertext"><i class="icon icon-spin i-spinner"></i></div>',icon:c});d=$("#"+
h.popup_id).find(".popup_content");d.html(a.html());$(".popup_window").css({width:"640px"});sendtopicForm(d,g,h)}).fail(function(a,b,c){d.html(b)});return!1}function addRequiredElem(a,b,c){"undefined"===typeof c&&(c=!1);a.find('input[name="'+b+'"]').after($('<span class="requiredfield" />').text(required_field).fadeIn());a.find('input[name="'+b+'"]').keyup(function(){a.find("."+b+" .requiredfield").fadeOut(function(){$(this).remove()})});c||(a.find('input[name="'+b+'"]').focus(),c=!0)}
function sendtopicForm(a,b,c){"undefined"!==typeof this_body&&a.html(this_body);var d=$(a).find("form");"undefined"!==typeof send_comment&&(d.find('input[name="comment"]').val(send_comment),d.find('input[name="y_name"]').val(sender_name),d.find('input[name="y_email"]').val(sender_mail),d.find('input[name="r_name"]').val(recipient_name),d.find('input[name="r_email"]').val(recipient_mail));a.find('input[name="send"]').on("click",function(e){e.preventDefault();var f=d.serialize()+"&send=1";e=d.find('input[name="y_name"]').val();
var g=d.find('input[name="y_email"]').val,h=d.find('input[name="r_name"]').val(),m=d.find('input[name="r_email"]').val(),k=!1;""===e&&(addRequiredElem(d,"y_name",k),k=!0);""===g&&(addRequiredElem(d,"y_email",k),k=!0);""===h&&(addRequiredElem(d,"r_name",k),k=!0);""===m&&(addRequiredElem(d,"r_email",k),k=!0);k||$.ajax({type:"post",url:b+";api",data:f}).done(function(d){d=$(d).find("elk")[0];var e=null;0===d.getElementsByTagName("error").length?(e=d.getElementsByTagName("text")[0].firstChild.nodeValue.removeEntities(),
e+='<br /><br /><input type="submit" name="send" value="'+sendtopic_back+'" class="button_submit"/><input type="submit" name="cancel" value="'+sendtopic_close+'" class="button_submit"/>',a.html(e),a.find('input[name="cancel"]').each(function(){$(this).on("click",function(a){a.preventDefault();c.hide()})})):(0!==d.getElementsByTagName("text").length&&(e=d.getElementsByTagName("text")[0].firstChild.nodeValue.removeEntities(),e+='<br /><br /><input type="submit" name="send" value="'+sendtopic_back+'" class="button_submit"/><input type="submit" name="cancel" value="'+
sendtopic_close+'" class="button_submit"/>',a.html(e),a.find('input[name="send"]').each(function(){$(this).on("click",function(d){d.preventDefault();f=$(a).find("form").serialize()+"&send=1";sendtopicForm(a,b,c)})}),a.find('input[name="cancel"]').each(function(){$(this).on("click",function(a){a.preventDefault();c.hide()})})),0!==d.getElementsByTagName("url").length&&(d=d.getElementsByTagName("url")[0].firstChild.nodeValue,a.html(sendtopic_error.replace("{href}",d))))}).fail(function(){a.html(sendtopic_error.replace("{href}",
b))})})}function topicSplitselect(a,b){getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+"action=splittopics;sa=selectTopics;subname="+topic_subject+";topic="+topic_id+"."+start[0]+";start2="+start[1]+";move="+a+";msg="+b+";xml",onTopicSplitReceived);return!1}
function onTopicSplitReceived(a){var b,c;for(b=0;2>b;b++){var d=a.getElementsByTagName("pageIndex")[b];document.getElementById("pageindex_"+d.getAttribute("section")).innerHTML=d.firstChild.nodeValue;start[b]=d.getAttribute("startFrom")}d=a.getElementsByTagName("change").length;for(b=0;b<d;b++){var e=a.getElementsByTagName("change")[b];var f=e.getAttribute("section");var g=e.getAttribute("curAction");var h=e.getAttribute("id");var m=document.getElementById("messages_"+f);if("remove"===g)m.removeChild(document.getElementById(f+
"_"+h));else{g=null;var k=m.getElementsByTagName("li");for(c=0;c<k.length;c++)parseInt(k[c].id.substr(f.length+1))<h&&(g=k[c].id,c=k.length+1);c=document.createElement("li");c.className="";c.id=f+"_"+h;c.innerHTML='<div class="content"><div class="message_header"><a class="split_icon float'+("selected"===f?"left":"right")+'" href="'+elk_prepareScriptUrl(elk_scripturl)+"action=splittopics;sa=selectTopics;subname="+topic_subject+";topic="+topic_id+"."+not_selected_start+";start2="+selected_start+";move="+
("selected"===f?"up":"down")+";msg="+h+'" onclick="return topicSplitselect(\''+("selected"===f?"up":"down")+"', "+h+');">'+("selected"===f?'<i class="icon icon-lg i-chevron-circle-left"></i>':'<i class="icon icon-lg i-chevron-circle-right"></i>')+"</a><strong>"+e.getElementsByTagName("subject")[0].firstChild.nodeValue+"</strong> "+txt_by+" <strong>"+e.getElementsByTagName("poster")[0].firstChild.nodeValue+"</strong><br /><em>"+e.getElementsByTagName("time")[0].firstChild.nodeValue+'</em></div><div class="post">'+
e.getElementsByTagName("body")[0].firstChild.nodeValue+"</div></div>";"string"===typeof g?m.insertBefore(c,document.getElementById(g)):m.appendChild(c)}}};/*
 @name      ElkArte Forum
 @copyright ElkArte Forum contributors
 @license   BSD http://opensource.org/licenses/BSD-3-Clause

 @version 1.1
*/
function elk_mentions(a){this.last_call=0;this.names=[];this.cached_names=[];this.cached_queries=[];this.$atwho=this.mentions=null;this.opt=a;this.attachAtWho()}
elk_mentions.prototype.attachAtWho=function(){var a=this;a.$atwho=$(this.opt.selector);a.mentions=$('<div style="display:none" />');a.$atwho.after(this.mentions);a.$atwho.atwho({at:"@",limit:7,maxLen:25,displayTpl:"<li data-value='${atwho-at}${name}' data-id='${id}'>${name}</li>",callbacks:{filter:function(b,c,d){c=parseInt((new Date).getTime()/1E3);if(2>b.length)return[];if(0!==a.last_call&&a.last_call+1>c)return a.names;if("undefined"!==typeof a.cached_names[b])return a.cached_names[b];if(elk_formSubmitted)return[];
a.names=[];d={suggest_type:"member",search:b.php_urlencode(),time:c};d[elk_session_var]=elk_session_id;$.ajax({url:elk_scripturl+"?action=suggest;xml",data:d,type:"post",async:!1}).done(function(b){$(b).find("item").each(function(b,c){"undefined"===typeof a.names[a.names.length]&&(a.names[a.names.length]={});a.names[a.names.length-1].id=$(c).attr("id");a.names[a.names.length-1].name=$(c).text()})}).fail(function(a,b,c){"console"in window&&(window.console.info("Error:",b,c.name),window.console.info(a.responseText))});
a.last_call=c;a.cached_names[b]=a.names;a.cached_queries[a.cached_queries.length]=b;return a.names},beforeInsert:function(b,c){a.mentions.append($('<input type="hidden" name="uid[]" />').val(c.data("id")).attr("data-name",c.data("value")));return b},matcher:function(a,c,d){a=a.replace(/[\-\[\]\/\{}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");d&&(a="(?:^|\\s)"+a);return(a=(new RegExp(a+"([^ <>&\"'=\\\\\n]*)$|"+a+"([^\\x00-\\xff]*)$","gi")).exec(c.replace()))?a[2]||a[1]:null},highlighter:function(a,c){if(!c)return a;
c=(c+"").replace(RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&");var b=new RegExp(">\\s*(\\w*)("+c.replace("+","\\+")+")(\\w*)\\s*<","ig");return a.replace(b,function(a,b,c,d){return"> "+b+"<strong>"+c+"</strong>"+d+" <"})}}})};
